window.pdocSearch = (function(){
/** elasticlunr - http://weixsong.github.io * Copyright (C) 2017 Oliver Nightingale * Copyright (C) 2017 Wei Song * MIT Licensed */!function(){function e(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var t=function(e){var n=new t.Index;return n.pipeline.add(t.trimmer,t.stopWordFilter,t.stemmer),e&&e.call(n,n),n};t.version="0.9.5",lunr=t,t.utils={},t.utils.warn=function(e){return function(t){e.console&&console.warn&&console.warn(t)}}(this),t.utils.toString=function(e){return void 0===e||null===e?"":e.toString()},t.EventEmitter=function(){this.events={}},t.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=e;if("function"!=typeof t)throw new TypeError("last argument must be a function");n.forEach(function(e){this.hasHandler(e)||(this.events[e]=[]),this.events[e].push(t)},this)},t.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var n=this.events[e].indexOf(t);-1!==n&&(this.events[e].splice(n,1),0==this.events[e].length&&delete this.events[e])}},t.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)},this)}},t.EventEmitter.prototype.hasHandler=function(e){return e in this.events},t.tokenizer=function(e){if(!arguments.length||null===e||void 0===e)return[];if(Array.isArray(e)){var n=e.filter(function(e){return null===e||void 0===e?!1:!0});n=n.map(function(e){return t.utils.toString(e).toLowerCase()});var i=[];return n.forEach(function(e){var n=e.split(t.tokenizer.seperator);i=i.concat(n)},this),i}return e.toString().trim().toLowerCase().split(t.tokenizer.seperator)},t.tokenizer.defaultSeperator=/[\s\-]+/,t.tokenizer.seperator=t.tokenizer.defaultSeperator,t.tokenizer.setSeperator=function(e){null!==e&&void 0!==e&&"object"==typeof e&&(t.tokenizer.seperator=e)},t.tokenizer.resetSeperator=function(){t.tokenizer.seperator=t.tokenizer.defaultSeperator},t.tokenizer.getSeperator=function(){return t.tokenizer.seperator},t.Pipeline=function(){this._queue=[]},t.Pipeline.registeredFunctions={},t.Pipeline.registerFunction=function(e,n){n in t.Pipeline.registeredFunctions&&t.utils.warn("Overwriting existing registered function: "+n),e.label=n,t.Pipeline.registeredFunctions[n]=e},t.Pipeline.getRegisteredFunction=function(e){return e in t.Pipeline.registeredFunctions!=!0?null:t.Pipeline.registeredFunctions[e]},t.Pipeline.warnIfFunctionNotRegistered=function(e){var n=e.label&&e.label in this.registeredFunctions;n||t.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)},t.Pipeline.load=function(e){var n=new t.Pipeline;return e.forEach(function(e){var i=t.Pipeline.getRegisteredFunction(e);if(!i)throw new Error("Cannot load un-registered function: "+e);n.add(i)}),n},t.Pipeline.prototype.add=function(){var e=Array.prototype.slice.call(arguments);e.forEach(function(e){t.Pipeline.warnIfFunctionNotRegistered(e),this._queue.push(e)},this)},t.Pipeline.prototype.after=function(e,n){t.Pipeline.warnIfFunctionNotRegistered(n);var i=this._queue.indexOf(e);if(-1===i)throw new Error("Cannot find existingFn");this._queue.splice(i+1,0,n)},t.Pipeline.prototype.before=function(e,n){t.Pipeline.warnIfFunctionNotRegistered(n);var i=this._queue.indexOf(e);if(-1===i)throw new Error("Cannot find existingFn");this._queue.splice(i,0,n)},t.Pipeline.prototype.remove=function(e){var t=this._queue.indexOf(e);-1!==t&&this._queue.splice(t,1)},t.Pipeline.prototype.run=function(e){for(var t=[],n=e.length,i=this._queue.length,o=0;n>o;o++){for(var r=e[o],s=0;i>s&&(r=this._queue[s](r,o,e),void 0!==r&&null!==r);s++);void 0!==r&&null!==r&&t.push(r)}return t},t.Pipeline.prototype.reset=function(){this._queue=[]},t.Pipeline.prototype.get=function(){return this._queue},t.Pipeline.prototype.toJSON=function(){return this._queue.map(function(e){return t.Pipeline.warnIfFunctionNotRegistered(e),e.label})},t.Index=function(){this._fields=[],this._ref="id",this.pipeline=new t.Pipeline,this.documentStore=new t.DocumentStore,this.index={},this.eventEmitter=new t.EventEmitter,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},t.Index.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},t.Index.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},t.Index.load=function(e){e.version!==t.version&&t.utils.warn("version mismatch: current "+t.version+" importing "+e.version);var n=new this;n._fields=e.fields,n._ref=e.ref,n.documentStore=t.DocumentStore.load(e.documentStore),n.pipeline=t.Pipeline.load(e.pipeline),n.index={};for(var i in e.index)n.index[i]=t.InvertedIndex.load(e.index[i]);return n},t.Index.prototype.addField=function(e){return this._fields.push(e),this.index[e]=new t.InvertedIndex,this},t.Index.prototype.setRef=function(e){return this._ref=e,this},t.Index.prototype.saveDocument=function(e){return this.documentStore=new t.DocumentStore(e),this},t.Index.prototype.addDoc=function(e,n){if(e){var n=void 0===n?!0:n,i=e[this._ref];this.documentStore.addDoc(i,e),this._fields.forEach(function(n){var o=this.pipeline.run(t.tokenizer(e[n]));this.documentStore.addFieldLength(i,n,o.length);var r={};o.forEach(function(e){e in r?r[e]+=1:r[e]=1},this);for(var s in r){var u=r[s];u=Math.sqrt(u),this.index[n].addToken(s,{ref:i,tf:u})}},this),n&&this.eventEmitter.emit("add",e,this)}},t.Index.prototype.removeDocByRef=function(e){if(e&&this.documentStore.isDocStored()!==!1&&this.documentStore.hasDoc(e)){var t=this.documentStore.getDoc(e);this.removeDoc(t,!1)}},t.Index.prototype.removeDoc=function(e,n){if(e){var n=void 0===n?!0:n,i=e[this._ref];this.documentStore.hasDoc(i)&&(this.documentStore.removeDoc(i),this._fields.forEach(function(n){var o=this.pipeline.run(t.tokenizer(e[n]));o.forEach(function(e){this.index[n].removeToken(e,i)},this)},this),n&&this.eventEmitter.emit("remove",e,this))}},t.Index.prototype.updateDoc=function(e,t){var t=void 0===t?!0:t;this.removeDocByRef(e[this._ref],!1),this.addDoc(e,!1),t&&this.eventEmitter.emit("update",e,this)},t.Index.prototype.idf=function(e,t){var n="@"+t+"/"+e;if(Object.prototype.hasOwnProperty.call(this._idfCache,n))return this._idfCache[n];var i=this.index[t].getDocFreq(e),o=1+Math.log(this.documentStore.length/(i+1));return this._idfCache[n]=o,o},t.Index.prototype.getFields=function(){return this._fields.slice()},t.Index.prototype.search=function(e,n){if(!e)return[];e="string"==typeof e?{any:e}:JSON.parse(JSON.stringify(e));var i=null;null!=n&&(i=JSON.stringify(n));for(var o=new t.Configuration(i,this.getFields()).get(),r={},s=Object.keys(e),u=0;u<s.length;u++){var a=s[u];r[a]=this.pipeline.run(t.tokenizer(e[a]))}var l={};for(var c in o){var d=r[c]||r.any;if(d){var f=this.fieldSearch(d,c,o),h=o[c].boost;for(var p in f)f[p]=f[p]*h;for(var p in f)p in l?l[p]+=f[p]:l[p]=f[p]}}var v,g=[];for(var p in l)v={ref:p,score:l[p]},this.documentStore.hasDoc(p)&&(v.doc=this.documentStore.getDoc(p)),g.push(v);return g.sort(function(e,t){return t.score-e.score}),g},t.Index.prototype.fieldSearch=function(e,t,n){var i=n[t].bool,o=n[t].expand,r=n[t].boost,s=null,u={};return 0!==r?(e.forEach(function(e){var n=[e];1==o&&(n=this.index[t].expandToken(e));var r={};n.forEach(function(n){var o=this.index[t].getDocs(n),a=this.idf(n,t);if(s&&"AND"==i){var l={};for(var c in s)c in o&&(l[c]=o[c]);o=l}n==e&&this.fieldSearchStats(u,n,o);for(var c in o){var d=this.index[t].getTermFrequency(n,c),f=this.documentStore.getFieldLength(c,t),h=1;0!=f&&(h=1/Math.sqrt(f));var p=1;n!=e&&(p=.15*(1-(n.length-e.length)/n.length));var v=d*a*h*p;c in r?r[c]+=v:r[c]=v}},this),s=this.mergeScores(s,r,i)},this),s=this.coordNorm(s,u,e.length)):void 0},t.Index.prototype.mergeScores=function(e,t,n){if(!e)return t;if("AND"==n){var i={};for(var o in t)o in e&&(i[o]=e[o]+t[o]);return i}for(var o in t)o in e?e[o]+=t[o]:e[o]=t[o];return e},t.Index.prototype.fieldSearchStats=function(e,t,n){for(var i in n)i in e?e[i].push(t):e[i]=[t]},t.Index.prototype.coordNorm=function(e,t,n){for(var i in e)if(i in t){var o=t[i].length;e[i]=e[i]*o/n}return e},t.Index.prototype.toJSON=function(){var e={};return this._fields.forEach(function(t){e[t]=this.index[t].toJSON()},this),{version:t.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),index:e,pipeline:this.pipeline.toJSON()}},t.Index.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},t.DocumentStore=function(e){this._save=null===e||void 0===e?!0:e,this.docs={},this.docInfo={},this.length=0},t.DocumentStore.load=function(e){var t=new this;return t.length=e.length,t.docs=e.docs,t.docInfo=e.docInfo,t._save=e.save,t},t.DocumentStore.prototype.isDocStored=function(){return this._save},t.DocumentStore.prototype.addDoc=function(t,n){this.hasDoc(t)||this.length++,this.docs[t]=this._save===!0?e(n):null},t.DocumentStore.prototype.getDoc=function(e){return this.hasDoc(e)===!1?null:this.docs[e]},t.DocumentStore.prototype.hasDoc=function(e){return e in this.docs},t.DocumentStore.prototype.removeDoc=function(e){this.hasDoc(e)&&(delete this.docs[e],delete this.docInfo[e],this.length--)},t.DocumentStore.prototype.addFieldLength=function(e,t,n){null!==e&&void 0!==e&&0!=this.hasDoc(e)&&(this.docInfo[e]||(this.docInfo[e]={}),this.docInfo[e][t]=n)},t.DocumentStore.prototype.updateFieldLength=function(e,t,n){null!==e&&void 0!==e&&0!=this.hasDoc(e)&&this.addFieldLength(e,t,n)},t.DocumentStore.prototype.getFieldLength=function(e,t){return null===e||void 0===e?0:e in this.docs&&t in this.docInfo[e]?this.docInfo[e][t]:0},t.DocumentStore.prototype.toJSON=function(){return{docs:this.docs,docInfo:this.docInfo,length:this.length,save:this._save}},t.stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",i="[aeiouy]",o=n+"[^aeiouy]*",r=i+"[aeiou]*",s="^("+o+")?"+r+o,u="^("+o+")?"+r+o+"("+r+")?$",a="^("+o+")?"+r+o+r+o,l="^("+o+")?"+i,c=new RegExp(s),d=new RegExp(a),f=new RegExp(u),h=new RegExp(l),p=/^(.+?)(ss|i)es$/,v=/^(.+?)([^s])s$/,g=/^(.+?)eed$/,m=/^(.+?)(ed|ing)$/,y=/.$/,S=/(at|bl|iz)$/,x=new RegExp("([^aeiouylsz])\\1$"),w=new RegExp("^"+o+i+"[^aeiouwxy]$"),I=/^(.+?[^aeiou])y$/,b=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,E=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,D=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,F=/^(.+?)(s|t)(ion)$/,_=/^(.+?)e$/,P=/ll$/,k=new RegExp("^"+o+i+"[^aeiouwxy]$"),z=function(n){var i,o,r,s,u,a,l;if(n.length<3)return n;if(r=n.substr(0,1),"y"==r&&(n=r.toUpperCase()+n.substr(1)),s=p,u=v,s.test(n)?n=n.replace(s,"$1$2"):u.test(n)&&(n=n.replace(u,"$1$2")),s=g,u=m,s.test(n)){var z=s.exec(n);s=c,s.test(z[1])&&(s=y,n=n.replace(s,""))}else if(u.test(n)){var z=u.exec(n);i=z[1],u=h,u.test(i)&&(n=i,u=S,a=x,l=w,u.test(n)?n+="e":a.test(n)?(s=y,n=n.replace(s,"")):l.test(n)&&(n+="e"))}if(s=I,s.test(n)){var z=s.exec(n);i=z[1],n=i+"i"}if(s=b,s.test(n)){var z=s.exec(n);i=z[1],o=z[2],s=c,s.test(i)&&(n=i+e[o])}if(s=E,s.test(n)){var z=s.exec(n);i=z[1],o=z[2],s=c,s.test(i)&&(n=i+t[o])}if(s=D,u=F,s.test(n)){var z=s.exec(n);i=z[1],s=d,s.test(i)&&(n=i)}else if(u.test(n)){var z=u.exec(n);i=z[1]+z[2],u=d,u.test(i)&&(n=i)}if(s=_,s.test(n)){var z=s.exec(n);i=z[1],s=d,u=f,a=k,(s.test(i)||u.test(i)&&!a.test(i))&&(n=i)}return s=P,u=d,s.test(n)&&u.test(n)&&(s=y,n=n.replace(s,"")),"y"==r&&(n=r.toLowerCase()+n.substr(1)),n};return z}(),t.Pipeline.registerFunction(t.stemmer,"stemmer"),t.stopWordFilter=function(e){return e&&t.stopWordFilter.stopWords[e]!==!0?e:void 0},t.clearStopWords=function(){t.stopWordFilter.stopWords={}},t.addStopWords=function(e){null!=e&&Array.isArray(e)!==!1&&e.forEach(function(e){t.stopWordFilter.stopWords[e]=!0},this)},t.resetStopWords=function(){t.stopWordFilter.stopWords=t.defaultStopWords},t.defaultStopWords={"":!0,a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,"do":!0,does:!0,either:!0,"else":!0,ever:!0,every:!0,"for":!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,"if":!0,"in":!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,"this":!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,"while":!0,who:!0,whom:!0,why:!0,will:!0,"with":!0,would:!0,yet:!0,you:!0,your:!0},t.stopWordFilter.stopWords=t.defaultStopWords,t.Pipeline.registerFunction(t.stopWordFilter,"stopWordFilter"),t.trimmer=function(e){if(null===e||void 0===e)throw new Error("token should not be undefined");return e.replace(/^\W+/,"").replace(/\W+$/,"")},t.Pipeline.registerFunction(t.trimmer,"trimmer"),t.InvertedIndex=function(){this.root={docs:{},df:0}},t.InvertedIndex.load=function(e){var t=new this;return t.root=e.root,t},t.InvertedIndex.prototype.addToken=function(e,t,n){for(var n=n||this.root,i=0;i<=e.length-1;){var o=e[i];o in n||(n[o]={docs:{},df:0}),i+=1,n=n[o]}var r=t.ref;n.docs[r]?n.docs[r]={tf:t.tf}:(n.docs[r]={tf:t.tf},n.df+=1)},t.InvertedIndex.prototype.hasToken=function(e){if(!e)return!1;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return!1;t=t[e[n]]}return!0},t.InvertedIndex.prototype.getNode=function(e){if(!e)return null;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return null;t=t[e[n]]}return t},t.InvertedIndex.prototype.getDocs=function(e){var t=this.getNode(e);return null==t?{}:t.docs},t.InvertedIndex.prototype.getTermFrequency=function(e,t){var n=this.getNode(e);return null==n?0:t in n.docs?n.docs[t].tf:0},t.InvertedIndex.prototype.getDocFreq=function(e){var t=this.getNode(e);return null==t?0:t.df},t.InvertedIndex.prototype.removeToken=function(e,t){if(e){var n=this.getNode(e);null!=n&&t in n.docs&&(delete n.docs[t],n.df-=1)}},t.InvertedIndex.prototype.expandToken=function(e,t,n){if(null==e||""==e)return[];var t=t||[];if(void 0==n&&(n=this.getNode(e),null==n))return t;n.df>0&&t.push(e);for(var i in n)"docs"!==i&&"df"!==i&&this.expandToken(e+i,t,n[i]);return t},t.InvertedIndex.prototype.toJSON=function(){return{root:this.root}},t.Configuration=function(e,n){var e=e||"";if(void 0==n||null==n)throw new Error("fields should not be null");this.config={};var i;try{i=JSON.parse(e),this.buildUserConfig(i,n)}catch(o){t.utils.warn("user configuration parse failed, will use default configuration"),this.buildDefaultConfig(n)}},t.Configuration.prototype.buildDefaultConfig=function(e){this.reset(),e.forEach(function(e){this.config[e]={boost:1,bool:"OR",expand:!1}},this)},t.Configuration.prototype.buildUserConfig=function(e,n){var i="OR",o=!1;if(this.reset(),"bool"in e&&(i=e.bool||i),"expand"in e&&(o=e.expand||o),"fields"in e)for(var r in e.fields)if(n.indexOf(r)>-1){var s=e.fields[r],u=o;void 0!=s.expand&&(u=s.expand),this.config[r]={boost:s.boost||0===s.boost?s.boost:1,bool:s.bool||i,expand:u}}else t.utils.warn("field name in user configuration not found in index instance fields");else this.addAllFields2UserConfig(i,o,n)},t.Configuration.prototype.addAllFields2UserConfig=function(e,t,n){n.forEach(function(n){this.config[n]={boost:1,bool:e,expand:t}},this)},t.Configuration.prototype.get=function(){return this.config},t.Configuration.prototype.reset=function(){this.config={}},lunr.SortedSet=function(){this.length=0,this.elements=[]},lunr.SortedSet.load=function(e){var t=new this;return t.elements=e,t.length=e.length,t},lunr.SortedSet.prototype.add=function(){var e,t;for(e=0;e<arguments.length;e++)t=arguments[e],~this.indexOf(t)||this.elements.splice(this.locationFor(t),0,t);this.length=this.elements.length},lunr.SortedSet.prototype.toArray=function(){return this.elements.slice()},lunr.SortedSet.prototype.map=function(e,t){return this.elements.map(e,t)},lunr.SortedSet.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},lunr.SortedSet.prototype.indexOf=function(e){for(var t=0,n=this.elements.length,i=n-t,o=t+Math.floor(i/2),r=this.elements[o];i>1;){if(r===e)return o;e>r&&(t=o),r>e&&(n=o),i=n-t,o=t+Math.floor(i/2),r=this.elements[o]}return r===e?o:-1},lunr.SortedSet.prototype.locationFor=function(e){for(var t=0,n=this.elements.length,i=n-t,o=t+Math.floor(i/2),r=this.elements[o];i>1;)e>r&&(t=o),r>e&&(n=o),i=n-t,o=t+Math.floor(i/2),r=this.elements[o];return r>e?o:e>r?o+1:void 0},lunr.SortedSet.prototype.intersect=function(e){for(var t=new lunr.SortedSet,n=0,i=0,o=this.length,r=e.length,s=this.elements,u=e.elements;;){if(n>o-1||i>r-1)break;s[n]!==u[i]?s[n]<u[i]?n++:s[n]>u[i]&&i++:(t.add(s[n]),n++,i++)}return t},lunr.SortedSet.prototype.clone=function(){var e=new lunr.SortedSet;return e.elements=this.toArray(),e.length=e.elements.length,e},lunr.SortedSet.prototype.union=function(e){var t,n,i;this.length>=e.length?(t=this,n=e):(t=e,n=this),i=t.clone();for(var o=0,r=n.toArray();o<r.length;o++)i.add(r[o]);return i},lunr.SortedSet.prototype.toJSON=function(){return this.toArray()},function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.elasticlunr=t()}(this,function(){return t})}();
    /** pdoc search index */const docs = [{"fullname": "store", "modulename": "store", "kind": "module", "doc": "<p>Store Agent Module for Supply Chain Optimization System.</p>\n\n<p>This module implements the Store agent, which represents a retail point in the supply chain.\nThe Store agent is responsible for managing inventory, purchasing products from warehouses,\nand interacting with the transportation system for product delivery.</p>\n\n<p>The module follows the FIPA (Foundation for Intelligent Physical Agents) Contract Net Protocol\nfor warehouse selection and negotiation, implementing the roles of Initiator in procurement\nprocesses.</p>\n\n<h6 id=\"typical-usage-example\">Typical usage example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">world.graph</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Graph</span>\n\n<span class=\"c1\"># Initialize graph and store agent</span>\n<span class=\"n\">map_graph</span> <span class=\"o\">=</span> <span class=\"n\">Graph</span><span class=\"p\">()</span>\n<span class=\"n\">store</span> <span class=\"o\">=</span> <span class=\"n\">Store</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;store_password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">map_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;warehouse2@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"k\">await</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</code></pre>\n  </div>\n</blockquote>\n"}, {"fullname": "store.Store", "modulename": "store", "qualname": "Store", "kind": "class", "doc": "<p>Retail Store Agent for Supply Chain Management System.</p>\n\n<p>The Store agent represents a retail point in the supply chain network. It manages\ninventory, purchases products from warehouses using a negotiation protocol, and\ncoordinates with vehicle agents for product delivery. The agent operates on a\ngraph-based world representation where each store has a specific node location.</p>\n\n<h6 id=\"fipa-contract-net-protocol-implementation\">FIPA Contract Net Protocol Implementation:</h6>\n\n<blockquote>\n  <p>This agent acts as the <strong>Initiator</strong> in the FIPA Contract Net Protocol:</p>\n  \n  <ol>\n  <li><p><strong>Call for Proposals (CFP)</strong>: Store broadcasts purchase requests to all warehouses\n  using the <code>store-buy</code> performative, which corresponds to the FIPA CFP message.</p></li>\n  <li><p><strong>Proposal Reception</strong>: Warehouses respond with either <code>warehouse-accept</code> (propose)\n  or <code>warehouse-reject</code> (refuse) performatives.</p></li>\n  <li><p><strong>Proposal Evaluation</strong>: Store evaluates all proposals using a distance-based\n  scoring function to select the optimal warehouse.</p></li>\n  <li><p><strong>Award/Rejection</strong>: Store sends <code>store-confirm</code> (accept-proposal) to the winner\n  and <code>store-deny</code> (reject-proposal) to non-selected participants.</p></li>\n  </ol>\n</blockquote>\n\n<h6 id=\"id-encoding-system\">ID Encoding System:</h6>\n\n<blockquote>\n  <p>The Store uses a hierarchical ID encoding for unique request identification:</p>\n  \n  <ul>\n  <li>Formula: <code>agent_type * 100_000_000 + instance_id * 1_000_000 + request_counter</code></li>\n  <li>Agent type code for Store: 1</li>\n  <li>Example: store1's first request = 1_001_000_000</li>\n  <li>This ensures globally unique request IDs across the multi-agent system.</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>jid (str):</strong>  Jabber ID of the store agent (e.g., \"store1@localhost\").</li>\n<li><strong>node_id (int):</strong>  Graph node ID representing the store's physical location.</li>\n<li><strong>map (Graph):</strong>  Reference to the world graph for pathfinding and distance calculations.</li>\n<li><strong>contact_list (list[str]):</strong>  List of warehouse JIDs for subscription and communication.</li>\n<li><strong>verbose (bool):</strong>  Flag to control debug output verbosity. When True, detailed logs\nare printed; when False, only essential information is shown.</li>\n<li><strong>id_base (int):</strong>  Base value for generating unique request IDs using encoding formula.\nComputed as <code>(1 * 100_000_000) + (instance_id * 1_000_000)</code>.</li>\n<li><strong>stock (dict[str, int]):</strong>  Current inventory mapping product names to quantities.</li>\n<li><strong>request_counter (int):</strong>  Monotonic counter for generating unique request IDs.\nIncremented with each purchase request.</li>\n<li><strong>current_buy_request (Message):</strong>  Reference to the most recent buy request message.</li>\n<li><strong>failed_requests (queue.Queue):</strong>  FIFO queue holding failed purchase requests for retry.\nRequests are enqueued when no warehouse accepts the order.</li>\n<li><strong>pending_deliveries (dict[int, Order]):</strong>  Orders awaiting vehicle delivery, keyed by order ID.</li>\n<li><strong>order_timings (dict[int, int]):</strong>  Tick timestamps when orders were confirmed, used for\ncalculating time-to-delivery statistics.</li>\n<li><strong>current_tick (int):</strong>  Current simulation time tick, updated by world agent.</li>\n<li><strong>product_list (list[str]):</strong>  Available products for purchase (from config.PRODUCTS).</li>\n<li><strong>buy_prob (float):</strong>  Probability (0-1) of initiating a purchase each period\n(from config.STORE_BUY_PROBABILITY).</li>\n<li><strong>max_buy_quantity (int):</strong>  Maximum quantity that can be purchased in a single order\n(from config.STORE_MAX_BUY_QUANTITY).</li>\n<li><strong>stats_path (str):</strong>  Directory path for statistics CSV files.</li>\n<li><strong>stats_filename (str):</strong>  Filename for order statistics CSV (\"store_stats.csv\").</li>\n</ul>\n\n<h6 id=\"behaviours\">Behaviours:</h6>\n\n<blockquote>\n  <p>BuyProduct: Periodic behaviour that initiates purchase requests based on probability.\n  CollectWarehouseResponses: Coordinator for FIPA Contract Net Protocol implementation.\n  ReceiveAllResponses: Worker behaviour that collects all warehouse responses.\n  SendStoreConfirmation: Sends confirmation to selected warehouse (FIPA accept-proposal).\n  SendStoreDenial: Sends rejection to non-selected warehouses (FIPA reject-proposal).\n  RetryPreviousBuy: Periodic behaviour that retries failed purchase requests.\n  ReceiveTimeDelta: Cyclic behaviour that processes simulation time updates and traffic data.\n  ReceiveVehicleArrival: Cyclic behaviour that handles vehicle delivery notifications.</p>\n</blockquote>\n\n<h6 id=\"message-protocols\">Message Protocols:</h6>\n\n<blockquote>\n  <p>Outgoing Messages:\n      - <code>store-buy</code>: Purchase request to warehouses (FIPA CFP).\n          Body format: \"{quantity} {product}\"\n          Metadata: store_id, node_id, request_id</p>\n\n<pre><code>- `store-confirm`: Confirmation to selected warehouse (FIPA accept-proposal).\n    Body format: \"{quantity} {product}\"\n    Metadata: warehouse_id, store_id, node_id, request_id\n\n- `store-deny`: Rejection to non-selected warehouses (FIPA reject-proposal).\n    Body format: \"{quantity} {product}\"\n    Metadata: warehouse_id, store_id, node_id, request_id\n</code></pre>\n  \n  <p>Incoming Messages:\n      - <code>warehouse-accept</code>: Warehouse accepts order (FIPA propose).\n          Body format: \"{quantity} {product}\"</p>\n\n<pre><code>- `warehouse-reject`: Warehouse rejects order (FIPA refuse).\n    Body format: \"{quantity} {product} {reason}\"\n\n- `vehicle-delivery`: Vehicle delivers products.\n    Body format: JSON with orderid, time (ETA)\n\n- `inform`: Time delta and traffic updates from world agent.\n    Body format: JSON with type, time, data\n</code></pre>\n</blockquote>\n\n<h6 id=\"notes\">Notes:</h6>\n\n<blockquote>\n  <ul>\n  <li>Only ONE purchase request should be active at a time to avoid conflicts.</li>\n  <li>Failed requests are automatically retried by the RetryPreviousBuy behaviour.</li>\n  <li>Stock is updated only upon vehicle delivery, not upon order confirmation.</li>\n  <li>All order statistics are saved to CSV for post-simulation analysis.</li>\n  <li>The agent subscribes to all warehouses in contact_list during setup.</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">store</span> <span class=\"o\">=</span> <span class=\"n\">Store</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">world_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;warehouse2@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"k\">await</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</code></pre>\n  </div>\n</blockquote>\n", "bases": "spade.agent.Agent"}, {"fullname": "store.Store.__init__", "modulename": "store", "qualname": "Store.__init__", "kind": "function", "doc": "<p>Initialize the Store agent with configuration and state.</p>\n\n<p>This constructor sets up the store agent with all necessary parameters for\noperation, including network configuration, graph reference, ID encoding,\nand statistics tracking. It prepares the agent for FIPA Contract Net Protocol\nnegotiations and supply chain operations.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>jid (str):</strong>  Jabber ID for the store agent (e.g., \"store1@localhost\").\nMust be unique within the XMPP server.</li>\n<li><strong>password (str):</strong>  Authentication password for XMPP server connection.</li>\n<li><strong>map (Graph):</strong>  Reference to the world graph for pathfinding and distance\ncalculations. Shared across all agents in the simulation.</li>\n<li><strong>node_id (int):</strong>  Graph node ID representing the store's physical location.\nUsed in pathfinding and warehouse scoring.</li>\n<li><strong>port (int, optional):</strong>  XMPP server port. Defaults to 5222 (standard XMPP).</li>\n<li><strong>verify_security (bool, optional):</strong>  Whether to verify SSL/TLS certificates.\nDefaults to False for local development. Set True for production.</li>\n<li><strong>contact_list (list[str], optional):</strong>  List of warehouse JIDs to subscribe to.\nStore will send purchase requests to these warehouses.\nDefaults to empty list.</li>\n<li><strong>verbose (bool, optional):</strong>  Enable detailed debug logging.\nTrue: Print all debug information\nFalse: Print only essential messages\nDefaults to False.</li>\n</ul>\n\n<h6 id=\"id-encoding-system\">ID Encoding System:</h6>\n\n<blockquote>\n  <p>Generates unique request IDs using hierarchical encoding:</p>\n  \n  <ul>\n  <li>Formula: <code>(agent_type * 100_000_000) + (instance_id * 1_000_000) + counter</code></li>\n  <li>Store type code: 1</li>\n  <li>Instance ID: Extracted from JID (e.g., \"store1\" -> 1, \"store42\" -> 42)</li>\n  <li>Example: store1's first request = 1_001_000_000</li>\n  <li>Example: store1's second request = 1_001_000_001</li>\n  <li>Ensures global uniqueness across all agents and requests</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"configuration-loading\">Configuration Loading:</h6>\n\n<blockquote>\n  <p>Imports from config module:</p>\n  \n  <ul>\n  <li>PRODUCTS: List of available products for purchase</li>\n  <li>STORE_BUY_PROBABILITY: Probability (0-1) of purchase attempt per period</li>\n  <li>STORE_MAX_BUY_QUANTITY: Maximum quantity per purchase order</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"state-initialization\">State Initialization:</h6>\n\n<blockquote>\n  <ul>\n  <li>pending_deliveries: Empty dict for tracking orders awaiting delivery</li>\n  <li>order_timings: Empty dict for recording confirmation timestamps</li>\n  <li>current_tick: 0 (synchronized by world agent during runtime)</li>\n  <li>stock: Initialized in setup() as empty dict</li>\n  <li>failed_requests: Initialized in setup() as empty queue</li>\n  <li>request_counter: Initialized in setup() as 0</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"statistics-configuration\">Statistics Configuration:</h6>\n\n<blockquote>\n  <ul>\n  <li>stats_path: \"stats/\" directory (created automatically if needed)</li>\n  <li>stats_filename: \"store_stats.csv\" (append mode)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">world.graph</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Graph</span>\n\n<span class=\"n\">map_graph</span> <span class=\"o\">=</span> <span class=\"n\">Graph</span><span class=\"p\">()</span>\n<span class=\"c1\"># ... add nodes and edges to graph ...</span>\n\n<span class=\"n\">store</span> <span class=\"o\">=</span> <span class=\"n\">Store</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;secure_password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">map_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span>\n    <span class=\"n\">port</span><span class=\"o\">=</span><span class=\"mi\">5222</span><span class=\"p\">,</span>\n    <span class=\"n\">verify_security</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;warehouse2@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n\n<span class=\"c1\"># store.id_base = 1_001_000_000</span>\n<span class=\"c1\"># Ready to start and begin purchasing</span>\n<span class=\"k\">await</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The agent is not fully operational until setup() is called (automatically\n  by SPADE when start() is invoked). The setup() method initializes\n  behaviours and subscribes to contacts.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">jid</span>,</span><span class=\"param\">\t<span class=\"n\">password</span>,</span><span class=\"param\">\t<span class=\"nb\">map</span><span class=\"p\">:</span> <span class=\"n\">world</span><span class=\"o\">.</span><span class=\"n\">graph</span><span class=\"o\">.</span><span class=\"n\">Graph</span>,</span><span class=\"param\">\t<span class=\"n\">node_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">port</span><span class=\"o\">=</span><span class=\"mi\">5222</span>,</span><span class=\"param\">\t<span class=\"n\">verify_security</span><span class=\"o\">=</span><span class=\"kc\">False</span>,</span><span class=\"param\">\t<span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[]</span>,</span><span class=\"param\">\t<span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">False</span></span>)</span>"}, {"fullname": "store.Store.BuyProduct", "modulename": "store", "qualname": "Store.BuyProduct", "kind": "class", "doc": "<p>Periodic behaviour that initiates product purchase requests to warehouses.</p>\n\n<p>This behaviour implements the initiation phase of the FIPA Contract Net Protocol.\nIt sends a Call for Proposals (CFP) to all available warehouses, requesting quotes\nfor a specific product and quantity. The behaviour executes periodically but only\nproceeds with a purchase based on a configured probability threshold.</p>\n\n<p>FIPA Protocol Phase: <strong>Call for Proposals (CFP)</strong>\n    - Role: Initiator (Store agent)\n    - Participants: All warehouses in contact list\n    - Message type: <code>store-buy</code> (FIPA CFP equivalent)\n    - Protocol: FIPA Contract Net Protocol</p>\n\n<p>The behaviour uses randomization to select products and quantities for each purchase,\nensuring varied and realistic purchasing patterns. It then delegates response collection\nand warehouse selection to the CollectWarehouseResponses coordinator behaviour.</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>quantity (Optional[int]):</strong>  Fixed quantity to purchase. If None, randomizes each run\nbetween 1 and max_buy_quantity.</li>\n<li><strong>product (Optional[str]):</strong>  Fixed product to purchase. If None, randomly selects from\nconfig.PRODUCTS each run.</li>\n<li><strong>period (float):</strong>  Time interval between executions in seconds (from config).</li>\n<li><strong>start_at (datetime):</strong>  Timestamp when the behaviour should first execute.</li>\n</ul>\n\n<p>Message Format (FIPA CFP):\n    Metadata:\n        - performative: \"store-buy\" (FIPA CFP)\n        - store_id: Store's JID\n        - node_id: Store's graph node ID\n        - request_id: Unique request ID using hierarchical encoding\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"50 electronics\"</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li>Roll random number (1-100) to determine if purchase should occur</li>\n  <li>Compare roll against buy_prob threshold; skip if roll fails</li>\n  <li>Randomize or use fixed quantity and product</li>\n  <li>Generate unique request_id using ID encoding: id_base + request_counter</li>\n  <li>Broadcast CFP to all warehouses in contact list</li>\n  <li>Launch CollectWarehouseResponses to handle FIPA negotiation protocol</li>\n  <li>Wait for negotiation to complete</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"notes\">Notes:</h6>\n\n<blockquote>\n  <ul>\n  <li>Uses local variables (not self.quantity/self.product) to ensure proper\n  randomization on each execution cycle.</li>\n  <li>Each execution generates a new request_id to avoid conflicts.</li>\n  <li>Waits for CollectWarehouseResponses to complete before finishing.</li>\n  <li>Probability mechanism prevents constant purchasing, simulating realistic demand.</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"c1\"># Random purchases from config product list</span>\n<span class=\"n\">buy_behav</span> <span class=\"o\">=</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">BuyProduct</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># Fixed product and quantity for testing</span>\n<span class=\"n\">buy_behav</span> <span class=\"o\">=</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">BuyProduct</span><span class=\"p\">(</span><span class=\"n\">quantity</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">product</span><span class=\"o\">=</span><span class=\"s2\">&quot;electronics&quot;</span><span class=\"p\">)</span>\n</code></pre>\n  </div>\n</blockquote>\n", "bases": "spade.behaviour.PeriodicBehaviour"}, {"fullname": "store.Store.BuyProduct.__init__", "modulename": "store", "qualname": "Store.BuyProduct.__init__", "kind": "function", "doc": "<p>Initialize the BuyProduct periodic behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>quantity (Optional[int], optional):</strong>  Fixed quantity to purchase each period.\nIf None, quantity is randomized between 1 and max_buy_quantity each run.\nDefaults to None for varied purchasing patterns.</li>\n<li><strong>product (Optional[str], optional):</strong>  Fixed product name to purchase each period.\nIf None, product is randomly selected from config.PRODUCTS each run.\nDefaults to None for varied product selection.</li>\n<li><strong>period (float, optional):</strong>  Time interval between executions in seconds.\nControls how frequently purchase attempts are made.\nDefaults to config.STORE_BUY_FREQUENCY.</li>\n<li><strong>start_at (datetime, optional):</strong>  Timestamp when behaviour should first execute.\nAllows delayed start for synchronized simulation initialization.\nDefaults to 5 seconds from initialization time.</li>\n</ul>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Using None for quantity and product (default) creates varied purchasing\n  patterns that simulate realistic retail demand, while fixed values create\n  predictable repeated orders useful for testing specific scenarios.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">quantity</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>,</span><span class=\"param\">\t<span class=\"n\">product</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>,</span><span class=\"param\">\t<span class=\"n\">period</span><span class=\"o\">=</span><span class=\"mi\">5</span>,</span><span class=\"param\">\t<span class=\"n\">start_at</span><span class=\"o\">=</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"p\">(</span><span class=\"mi\">2025</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">19</span><span class=\"p\">,</span> <span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">307125</span><span class=\"p\">)</span></span>)</span>"}, {"fullname": "store.Store.BuyProduct.quantity", "modulename": "store", "qualname": "Store.BuyProduct.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.BuyProduct.product", "modulename": "store", "qualname": "Store.BuyProduct.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.BuyProduct.run", "modulename": "store", "qualname": "Store.BuyProduct.run", "kind": "function", "doc": "<p>Execute one cycle of the purchase request behaviour.</p>\n\n<p>This method implements the probabilistic purchase initiation logic and\nbroadcasts FIPA CFP messages to all warehouses. It uses randomization for\nboth the purchase decision (based on buy_prob) and the product/quantity\nselection (unless fixed values were provided in __init__).</p>\n\n<h6 id=\"fipa-protocol-implementation\">FIPA Protocol Implementation:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Phase</strong>: Call for Proposals (CFP) - Initiation</li>\n  <li><strong>Role</strong>: Initiator</li>\n  <li><strong>Performative</strong>: store-buy (FIPA CFP)</li>\n  <li><strong>Content</strong>: \"{quantity} {product}\"</li>\n  <li><strong>Receivers</strong>: All warehouses in contact list (broadcast)</li>\n  <li><strong>Protocol</strong>: FIPA Contract Net Protocol</li>\n  </ul>\n</blockquote>\n\n<p>The method generates a unique request_id using the Store's hierarchical ID\nencoding system before broadcasting to ensure all responses can be properly\nmatched to this specific request.</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Probability Check</strong>: Roll random number (1-100) for purchase decision</li>\n  <li><strong>Threshold Comparison</strong>: Compare roll against buy_prob * 100</li>\n  <li><strong>Early Return</strong>: If roll fails, abort and wait for next period</li>\n  <li><strong>Randomization</strong>: Generate or use fixed quantity and product</li>\n  <li><strong>ID Generation</strong>: Create unique request_id from id_base + request_counter</li>\n  <li><strong>CFP Broadcast</strong>: Send store-buy message to all warehouses</li>\n  <li><strong>Coordinator Launch</strong>: Start CollectWarehouseResponses for negotiation</li>\n  <li><strong>Synchronization</strong>: Wait for coordinator to complete FIPA protocol</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Increments agent.request_counter (ensures unique IDs)</li>\n  <li>Updates agent.current_buy_request with last sent message</li>\n  <li>Adds CollectWarehouseResponses behaviour to agent</li>\n  <li>May print debug information if verbose mode is enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes when CollectWarehouseResponses finishes the negotiation\n  process and a warehouse is selected (or request fails).</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Uses local variables (quantity, product) instead of instance variables\n  to ensure proper randomization on each execution. This prevents the bug\n  where the same product/quantity would be used repeatedly.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.CollectWarehouseResponses", "modulename": "store", "qualname": "Store.CollectWarehouseResponses", "kind": "class", "doc": "<p>Coordinator behaviour for FIPA Contract Net Protocol implementation.</p>\n\n<p>This behaviour orchestrates the proposal collection, evaluation, and award phases\nof the FIPA Contract Net Protocol. It acts as the coordinator (initiator) that\nmanages the negotiation process with multiple warehouses, collects their responses,\nand selects the best proposal based on a distance-based scoring function.</p>\n\n<h6 id=\"fipa-protocol-phases-implemented\">FIPA Protocol Phases Implemented:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Proposal Reception</strong>: Collects warehouse responses (propose/refuse)</li>\n  <li><strong>Proposal Evaluation</strong>: Scores each acceptance using Dijkstra pathfinding</li>\n  <li><strong>Award Decision</strong>: Sends accept-proposal to winner, reject-proposal to losers</li>\n  </ol>\n</blockquote>\n\n<p>The behaviour uses a coordinator/worker pattern:\n    - <strong>Coordinator</strong> (this class): Manages overall protocol flow, evaluates proposals\n    - <strong>Worker</strong> (ReceiveAllResponses): Handles actual message reception</p>\n\n<h6 id=\"scoring-algorithm\">Scoring Algorithm:</h6>\n\n<blockquote>\n  <p>Uses Dijkstra pathfinding to calculate delivery time from each warehouse to store.</p>\n  \n  <ul>\n  <li>Formula: score = delivery_time (from warehouse to store)</li>\n  <li>Lower score = better choice (shorter delivery time)</li>\n  <li>Tie-breaking: First warehouse with minimum score wins</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"fipa-contract-net-protocol-flow\">FIPA Contract Net Protocol Flow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Setup</strong>: Create template matching request_id and store_id</li>\n  <li><strong>Collection</strong>: Launch ReceiveAllResponses worker to gather proposals</li>\n  <li><strong>Wait</strong>: Synchronize on worker completion (timeout: 5 seconds)</li>\n  <li><strong>Evaluation</strong>: Calculate scores for all acceptances</li>\n  <li><strong>Selection</strong>: Choose warehouse with minimum score</li>\n  <li><strong>Award</strong>: Send store-confirm to winner (FIPA accept-proposal)</li>\n  <li><strong>Rejection</strong>: Send store-deny to losers (FIPA reject-proposal)</li>\n  <li><strong>Failure Handling</strong>: Enqueue for retry if no acceptances received</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique identifier for this purchase request from ID encoding.</li>\n<li><strong>buy_msg (str):</strong>  Original purchase message body (\"{quantity} {product}\").</li>\n<li><strong>num_warehouses (int):</strong>  Expected number of warehouse responses for timeout logic.</li>\n<li><strong>quantity (int):</strong>  Quantity of product being purchased.</li>\n<li><strong>product (str):</strong>  Name of product being purchased.</li>\n<li><strong>acceptances (list[tuple[str, Message]]):</strong>  Warehouses that proposed.\nFormat: [(warehouse_jid, acceptance_msg), ...]</li>\n<li><strong>rejections (list[tuple[str, Message, str]]):</strong>  Warehouses that refused.\nFormat: [(warehouse_jid, rejection_msg, reason), ...]</li>\n</ul>\n\n<h6 id=\"failure-handling\">Failure Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li>If no warehouses accept: Request added to failed_requests queue</li>\n  <li>RetryPreviousBuy behaviour will automatically retry with same request_id</li>\n  <li>Failed requests maintain original request_id for tracking</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-workflow\">Example Workflow:</h6>\n\n<blockquote>\n<pre><code>CFP Sent: \"50 electronics\" (request_id=1001000000)\nResponses Received:\n    - warehouse1: propose (distance=100, score=100)\n    - warehouse2: propose (distance=50, score=50) &lt;- WINNER\n    - warehouse3: refuse (reason: out_of_stock)\nActions Taken:\n    - Send accept-proposal to warehouse2\n    - Send reject-proposal to warehouse1\n    - warehouse3 already refused, no action needed\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This coordinator behaviour is essential for implementing the FIPA Contract Net\n  Protocol correctly, separating concerns between message collection (worker) and\n  decision-making (coordinator).</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "store.Store.CollectWarehouseResponses.__init__", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.__init__", "kind": "function", "doc": "<p>Initialize the CollectWarehouseResponses coordinator behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  Original purchase request message sent to warehouses.\nStored as reference for reconstructing failed requests if needed.</li>\n<li><strong>request_id (int):</strong>  Unique request identifier from hierarchical ID encoding system.\nUsed to match incoming responses to this specific CFP.</li>\n<li><strong>num_warehouses (int):</strong>  Expected number of warehouse responses.\nUsed to determine when all proposals have been received (or timeout).</li>\n<li><strong>quantity (int):</strong>  Quantity of product being purchased.\nNeeded for order processing and statistics tracking.</li>\n<li><strong>product (str):</strong>  Name of product being purchased.\nNeeded for order processing and statistics tracking.</li>\n</ul>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Initializes empty acceptances and rejections lists that will be\n  populated by the ReceiveAllResponses worker behaviour through\n  shared reference (list objects are mutable).</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>,</span><span class=\"param\">\t<span class=\"n\">request_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">num_warehouses</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">quantity</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">product</span><span class=\"p\">:</span> <span class=\"nb\">str</span></span>)</span>"}, {"fullname": "store.Store.CollectWarehouseResponses.request_id", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.buy_msg", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.buy_msg", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.num_warehouses", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.num_warehouses", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.quantity", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.product", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.acceptances", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.acceptances", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.rejections", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.rejections", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.CollectWarehouseResponses.run", "modulename": "store", "qualname": "Store.CollectWarehouseResponses.run", "kind": "function", "doc": "<p>Execute the warehouse proposal collection and evaluation process.</p>\n\n<p>This method coordinates the entire FIPA Contract Net Protocol workflow\nfor warehouse selection. It sets up message filtering, launches the worker\nbehaviour for response collection, evaluates all proposals using a scoring\nalgorithm, and sends confirmations/rejections to participants according to\nthe FIPA protocol specification.</p>\n\n<p>FIPA Contract Net Protocol Implementation:</p>\n\n<ol>\n<li><p><strong>Setup Phase</strong> (FIPA: Preparation):</p>\n\n<ul>\n<li>Creates template matching request_id and store_id metadata</li>\n<li>Allows both warehouse-accept (propose) and warehouse-reject (refuse)</li>\n<li>Ensures only responses for THIS specific request are collected</li>\n<li>Prevents cross-contamination between concurrent requests</li>\n</ul></li>\n<li><p><strong>Collection Phase</strong> (FIPA: Proposal Reception):</p>\n\n<ul>\n<li>Delegates to ReceiveAllResponses worker behaviour</li>\n<li>Worker populates acceptances (proposals) and rejections (refusals) lists</li>\n<li>Implements timeout mechanism (5 seconds total)</li>\n<li>Handles partial responses gracefully (some warehouses may not respond)</li>\n</ul></li>\n<li><p><strong>Evaluation Phase</strong> (FIPA: Proposal Evaluation):</p>\n\n<ul>\n<li>Calculates score for each acceptance using calculate_warehouse_score()</li>\n<li>Score based on Dijkstra pathfinding: delivery_time from warehouse to store</li>\n<li>Selects warehouse with lowest score (shortest delivery time)</li>\n<li>Implements best-proposal selection strategy from FIPA specification</li>\n</ul></li>\n<li><p><strong>Award Phase</strong> (FIPA: Result Notification):</p>\n\n<ul>\n<li>Sends store-confirm to winner (FIPA accept-proposal performative)</li>\n<li>Sends store-deny to all other acceptors (FIPA reject-proposal performative)</li>\n<li>Rejected participants (warehouse-reject) are not contacted again</li>\n<li>Winner proceeds to order confirmation and vehicle assignment</li>\n</ul></li>\n<li><p><strong>Failure Handling</strong>:</p>\n\n<ul>\n<li>If no acceptances received: Adds request to failed_requests queue</li>\n<li>Failed requests automatically retried by RetryPreviousBuy behaviour</li>\n<li>Maintains same request_id for tracking across retry attempts</li>\n</ul></li>\n</ol>\n\n<h6 id=\"template-configuration\">Template Configuration:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Matches</strong>: store_id (this store) AND request_id (this specific request)</li>\n  <li><strong>Accepts</strong>: Both warehouse-accept AND warehouse-reject performatives</li>\n  <li><strong>Purpose</strong>: Filters responses to avoid conflicts with concurrent requests</li>\n  <li><strong>Design</strong>: Intentionally doesn't filter by performative to collect all responses</li>\n  </ul>\n</blockquote>\n\n<p>Scoring Process (Distance-Based Selection):\n    For each warehouse that sent propose (warehouse-accept):\n    1. Extract warehouse node_id from message metadata\n    2. Use Dijkstra algorithm: calculate (path, fuel, time) warehouse -> store\n    3. Score = delivery time (lower is better)\n    4. Select warehouse with minimum score\n    5. Tie-breaking: First warehouse with minimum score wins</p>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Adds ReceiveAllResponses worker behaviour to agent (with template)</li>\n  <li>Adds SendStoreConfirmation behaviour for winner</li>\n  <li>Adds SendStoreDenial behaviour for each non-winner</li>\n  <li>May enqueue failed request to failed_requests queue</li>\n  <li>Prints evaluation details if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes when all confirmations/denials are sent, or when\n  failed request is enqueued for retry.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>CFP: \"50 electronics\" to 3 warehouses\nResponses:\n    - warehouse1: accept (node_id=10, distance=150, score=150)\n    - warehouse2: accept (node_id=5, distance=80, score=80) &lt;- WINNER\n    - warehouse3: reject (reason=out_of_stock)\nActions:\n    - SendStoreConfirmation(warehouse2) -&gt; accept-proposal\n    - SendStoreDenial(warehouse1) -&gt; reject-proposal\n    - No action for warehouse3 (already refused)\nResult: Order placed with warehouse2\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method implements the core decision-making logic of the FIPA Contract\n  Net Protocol, transforming raw proposals into a concrete purchase order with\n  the optimal warehouse.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.ReceiveAllResponses", "modulename": "store", "qualname": "Store.ReceiveAllResponses", "kind": "class", "doc": "<p>Worker behaviour for collecting warehouse responses in FIPA Contract Net Protocol.</p>\n\n<p>This behaviour acts as the worker component in a coordinator/worker pattern,\nhandling the actual message reception during the proposal collection phase of\nthe FIPA Contract Net Protocol. It listens for both proposals (warehouse-accept)\nand refusals (warehouse-reject) from warehouses, populating shared lists that\nthe coordinator (CollectWarehouseResponses) will evaluate.</p>\n\n<p>FIPA Protocol Phase: <strong>Proposal Reception</strong>\n    - Role: Participant response collector (worker)\n    - Coordinator: CollectWarehouseResponses\n    - Expected messages: warehouse-accept (propose) and warehouse-reject (refuse)\n    - Timeout: 5 seconds total for all responses</p>\n\n<p>The behaviour implements a timeout mechanism to handle scenarios where some\nwarehouses may be slow to respond or unavailable. It collects responses until\neither all expected warehouses respond or the timeout expires.</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique request identifier for filtering messages.\nEnsures only responses for this specific CFP are processed.</li>\n<li><strong>num_warehouses (int):</strong>  Expected number of warehouse responses.\nUsed to determine when collection is complete.</li>\n<li><strong>acceptances (list[tuple[str, Message]]):</strong>  Shared list with coordinator.\nPopulated with (warehouse_jid, message) for each propose.</li>\n<li><strong>rejections (list[tuple[str, Message, str]]):</strong>  Shared list with coordinator.\nPopulated with (warehouse_jid, message, reason) for each refuse.</li>\n<li><strong>responses_received (int):</strong>  Counter tracking received responses.\nIncremented for both accepts and rejects.</li>\n<li><strong>timeout (int):</strong>  Maximum seconds to wait for all responses (default: 5).</li>\n</ul>\n\n<h6 id=\"message-processing\">Message Processing:</h6>\n\n<blockquote>\n  <ul>\n  <li><p><strong>warehouse-accept</strong> (FIPA propose):\n  Body format: \"{quantity} {product}\"\n  Action: Append (warehouse_jid, msg) to acceptances</p></li>\n  <li><p><strong>warehouse-reject</strong> (FIPA refuse):\n  Body format: \"{quantity} {product} {reason}\"\n  Action: Append (warehouse_jid, msg, reason) to rejections</p></li>\n  </ul>\n</blockquote>\n\n<h6 id=\"timeout-logic\">Timeout Logic:</h6>\n\n<blockquote>\n  <ul>\n  <li>Tracks elapsed time from start</li>\n  <li>Calculates remaining_timeout for each receive() call</li>\n  <li>Breaks early if remaining_timeout &lt;= 0</li>\n  <li>Allows partial responses (fewer than num_warehouses)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Expected: 3 warehouses\nTimeline:\n    t=0.5s: warehouse1 -&gt; accept (1/3 received)\n    t=1.2s: warehouse2 -&gt; reject (2/3 received)\n    t=5.0s: timeout reached (warehouse3 no response)\nResult:\n    acceptances = [(warehouse1, msg1)]\n    rejections = [(warehouse2, msg2, \"out_of_stock\")]\n    responses_received = 2\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This worker behaviour uses shared list references (not copies) to communicate\n  with the coordinator, following the coordinator/worker pattern for efficient\n  data sharing between behaviours.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "store.Store.ReceiveAllResponses.__init__", "modulename": "store", "qualname": "Store.ReceiveAllResponses.__init__", "kind": "function", "doc": "<p>Initialize the ReceiveAllResponses worker behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique request identifier from ID encoding system.\nUsed to filter incoming messages to only this CFP's responses.</li>\n<li><strong>num_warehouses (int):</strong>  Expected number of warehouse responses.\nUsed to determine when all responses received (early termination).</li>\n<li><strong>acceptances (list[tuple[str, Message]]):</strong>  Shared list reference with coordinator.\nWorker appends (warehouse_jid, msg) for each warehouse-accept received.\nModifications visible to coordinator through shared reference.</li>\n<li><strong>rejections (list[tuple[str, Message, str]]):</strong>  Shared list reference with coordinator.\nWorker appends (warehouse_jid, msg, reason) for each warehouse-reject.\nModifications visible to coordinator through shared reference.</li>\n</ul>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Lists are shared by reference (mutable), enabling communication between\n  worker and coordinator without explicit return values. This is a common\n  pattern in concurrent programming with SPADE behaviours.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">request_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">num_warehouses</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">acceptances</span><span class=\"p\">:</span> <span class=\"nb\">list</span>,</span><span class=\"param\">\t<span class=\"n\">rejections</span><span class=\"p\">:</span> <span class=\"nb\">list</span></span>)</span>"}, {"fullname": "store.Store.ReceiveAllResponses.request_id", "modulename": "store", "qualname": "Store.ReceiveAllResponses.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.ReceiveAllResponses.num_warehouses", "modulename": "store", "qualname": "Store.ReceiveAllResponses.num_warehouses", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.ReceiveAllResponses.acceptances", "modulename": "store", "qualname": "Store.ReceiveAllResponses.acceptances", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.ReceiveAllResponses.rejections", "modulename": "store", "qualname": "Store.ReceiveAllResponses.rejections", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.ReceiveAllResponses.responses_received", "modulename": "store", "qualname": "Store.ReceiveAllResponses.responses_received", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.ReceiveAllResponses.timeout", "modulename": "store", "qualname": "Store.ReceiveAllResponses.timeout", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.ReceiveAllResponses.run", "modulename": "store", "qualname": "Store.ReceiveAllResponses.run", "kind": "function", "doc": "<p>Execute the message collection loop for warehouse responses.</p>\n\n<p>This method implements the core collection logic for the FIPA Contract Net\nProtocol proposal reception phase. It continuously receives messages from\nwarehouses until either all expected responses arrive or a timeout occurs,\nproperly categorizing each response as either a proposal or refusal.</p>\n\n<h6 id=\"fipa-protocol-implementation\">FIPA Protocol Implementation:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Phase</strong>: Proposal Reception (collecting propose/refuse messages)</li>\n  <li><strong>Role</strong>: Worker (collects data for coordinator evaluation)</li>\n  <li><strong>Timeout</strong>: 5 seconds total (not per message)</li>\n  <li><strong>Partial Completion</strong>: Accepts fewer responses than expected</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"algorithm\">Algorithm:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Initialization</strong>: Record start time for timeout calculation</li>\n  <li><strong>Collection Loop</strong>: While responses_received &lt; num_warehouses:\n  a. Calculate remaining timeout based on elapsed time\n  b. Check for timeout expiration (remaining_timeout &lt;= 0)\n  c. Receive message with dynamically calculated timeout\n  d. Parse message: extract performative, sender, and body\n  e. Categorize as acceptance or rejection\n  f. Append to appropriate shared list\n  g. Increment responses_received counter</li>\n  <li><strong>Termination</strong>: Break on timeout or no more messages</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"message-processing\">Message Processing:</h6>\n\n<blockquote>\n  <p><strong>warehouse-accept</strong> (FIPA propose):\n      - Body format: \"{quantity} {product}\"\n      - Parsing: Split on space, extract quantity (int) and product (str)\n      - Action: Append (warehouse_jid, msg) to acceptances list\n      - Meaning: Warehouse agrees to fulfill order</p>\n  \n  <p><strong>warehouse-reject</strong> (FIPA refuse):\n      - Body format: \"{quantity} {product} {reason}\"\n      - Parsing: Split on space, extract quantity, product, and optional reason\n      - Action: Append (warehouse_jid, msg, reason) to rejections list\n      - Default reason: \"unknown\" if not provided\n      - Meaning: Warehouse cannot or will not fulfill order</p>\n</blockquote>\n\n<h6 id=\"timeout-mechanism\">Timeout Mechanism:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Total Timeout</strong>: 5 seconds from method start</li>\n  <li><strong>Dynamic Calculation</strong>: remaining_timeout = total_timeout - elapsed_time</li>\n  <li><strong>Per-Message Timeout</strong>: Each receive() uses remaining_timeout</li>\n  <li><strong>Early Termination</strong>: Breaks immediately if remaining_timeout &lt;= 0</li>\n  <li><strong>Graceful Handling</strong>: Allows partial responses without error</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution-timeline\">Example Execution Timeline:</h6>\n\n<blockquote>\n<pre><code>t=0.0s: Start collection (expecting 3 responses)\nt=0.3s: Receive warehouse1 accept -&gt; acceptances.append()\nt=0.8s: Receive warehouse2 reject -&gt; rejections.append()\nt=5.0s: Timeout reached (warehouse3 silent)\nResult: 2/3 responses collected\n</code></pre>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Populates self.acceptances shared list with proposals</li>\n  <li>Populates self.rejections shared list with refusals</li>\n  <li>Increments self.responses_received counter</li>\n  <li>Prints debug information if verbose mode enabled</li>\n  <li>May terminate early due to timeout</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Results communicated through shared list references.</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The timeout is global (not per-message), ensuring the entire collection\n  process completes within 5 seconds regardless of warehouse count. This\n  prevents indefinite waiting when warehouses are unresponsive.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.SendStoreConfirmation", "modulename": "store", "qualname": "Store.SendStoreConfirmation", "kind": "class", "doc": "<p>Behaviour to send confirmation to the selected warehouse (FIPA accept-proposal).</p>\n\n<p>This behaviour implements the award notification phase of the FIPA Contract Net\nProtocol, informing the winning warehouse that its proposal has been accepted.\nIt sends the FIPA accept-proposal message and registers the order as pending\ndelivery, waiting for a vehicle to transport the goods.</p>\n\n<p>FIPA Protocol Phase: <strong>Result Notification - Award</strong>\n    - Performative: store-confirm (FIPA accept-proposal)\n    - Recipient: Selected warehouse (winner of proposal evaluation)\n    - Purpose: Officially award the contract to the best proposal\n    - Protocol: FIPA Contract Net Protocol</p>\n\n<p>This behaviour does NOT update stock immediately. Stock updates occur only when\nthe vehicle delivers the products (upon receiving vehicle-delivery message).\nThis design accurately models real-world supply chains where confirmation precedes\nactual inventory arrival.</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>dest (str):</strong>  Warehouse JID (winner's address).</li>\n<li><strong>request_id (str):</strong>  Unique request identifier from original CFP.</li>\n<li><strong>quantity (int):</strong>  Quantity of product in the confirmed order.</li>\n<li><strong>product (str):</strong>  Name of product in the confirmed order.</li>\n<li><strong>msg (Message):</strong>  Original warehouse-accept message (for Order conversion).</li>\n</ul>\n\n<p>Message Format (FIPA accept-proposal):\n    Metadata:\n        - performative: \"store-confirm\" (FIPA accept-proposal)\n        - warehouse_id: Destination warehouse JID\n        - store_id: This store's JID\n        - node_id: This store's graph location\n        - request_id: Original CFP request identifier\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"50 electronics\"</p>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Converts message to Order object using message_to_order()</li>\n  <li>Adds order to agent.pending_deliveries dict (key: order_id)</li>\n  <li>Records confirmation timestamp in agent.order_timings (for statistics)</li>\n  <li>Sends store-confirm message to warehouse</li>\n  <li>Prints confirmation details (always visible, not verbose-only)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li>Convert warehouse-accept message to Order object</li>\n  <li>Register order in pending_deliveries (awaiting vehicle)</li>\n  <li>Record current tick in order_timings (for time-to-delivery calculation)</li>\n  <li>Construct store-confirm message with proper metadata</li>\n  <li>Send confirmation to warehouse</li>\n  <li>Print success message with order details</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Warehouse: warehouse2@localhost\nRequest: \"50 electronics\" (ID: 1001000000)\nAction: Send store-confirm to warehouse2\nResult: Order 1001000000 pending delivery\nPrint: \"Successfully bought 50 xelectronics from warehouse2...\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The confirmation message triggers the warehouse to assign a vehicle for\n  delivery. The store then waits for vehicle-delivery message to update stock.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "store.Store.SendStoreConfirmation.__init__", "modulename": "store", "qualname": "Store.SendStoreConfirmation.__init__", "kind": "function", "doc": "<p>Initialize the SendStoreConfirmation behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The warehouse-accept message from the winning warehouse.\nContains all necessary information: sender, request_id, quantity, product.\nUsed to construct the confirmation message and create Order object.</li>\n</ul>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Extracts and stores all relevant fields from the message for use in run().\n  The original message is preserved for Order object conversion.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span>)</span>"}, {"fullname": "store.Store.SendStoreConfirmation.dest", "modulename": "store", "qualname": "Store.SendStoreConfirmation.dest", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreConfirmation.request_id", "modulename": "store", "qualname": "Store.SendStoreConfirmation.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreConfirmation.quantity", "modulename": "store", "qualname": "Store.SendStoreConfirmation.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreConfirmation.product", "modulename": "store", "qualname": "Store.SendStoreConfirmation.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreConfirmation.msg", "modulename": "store", "qualname": "Store.SendStoreConfirmation.msg", "kind": "variable", "doc": "<p></p>\n", "annotation": ": spade.message.Message"}, {"fullname": "store.Store.SendStoreConfirmation.run", "modulename": "store", "qualname": "Store.SendStoreConfirmation.run", "kind": "function", "doc": "<p>Execute the confirmation sending process (FIPA accept-proposal).</p>\n\n<p>This method sends the FIPA accept-proposal message to the winning warehouse,\nregisters the order as pending delivery, and records timing information for\nstatistics. It implements the award notification phase of the FIPA Contract\nNet Protocol.</p>\n\n<h6 id=\"fipa-protocol-implementation\">FIPA Protocol Implementation:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Phase</strong>: Result Notification - Award</li>\n  <li><strong>Performative</strong>: store-confirm (FIPA accept-proposal)</li>\n  <li><strong>Meaning</strong>: \"Your proposal is accepted, prepare the order\"</li>\n  <li><strong>Expected Response</strong>: Warehouse assigns vehicle for delivery</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"important-design-decision\">Important Design Decision:</h6>\n\n<blockquote>\n  <p>Stock is NOT updated immediately upon confirmation. Stock updates occur\n  only when the vehicle delivers the products (vehicle-delivery message).\n  This accurately models real-world logistics where confirmation \u2260 possession.</p>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><p><strong>Order Conversion</strong>: Convert warehouse-accept message to Order object</p>\n  \n  <ul>\n  <li>Extracts: product, quantity, orderid, sender, receiver, locations</li>\n  <li>Uses message_to_order() helper method</li>\n  </ul></li>\n  <li><p><strong>Order Registration</strong>: Add to pending_deliveries dict</p>\n  \n  <ul>\n  <li>Key: order.orderid (unique request ID)</li>\n  <li>Value: Order object with full details</li>\n  <li>Purpose: Track orders awaiting vehicle delivery</li>\n  </ul></li>\n  <li><p><strong>Timing Record</strong>: Store current tick in order_timings</p>\n  \n  <ul>\n  <li>Key: order.orderid</li>\n  <li>Value: agent.current_tick (simulation time)</li>\n  <li>Purpose: Calculate time-to-delivery for statistics</li>\n  </ul></li>\n  <li><p><strong>Message Construction</strong>: Build store-confirm message</p>\n  \n  <ul>\n  <li>Performative: store-confirm (FIPA accept-proposal)</li>\n  <li>Metadata: warehouse_id, store_id, node_id, request_id</li>\n  <li>Body: \"{quantity} {product}\"</li>\n  </ul></li>\n  <li><p><strong>Message Transmission</strong>: Send confirmation to warehouse</p>\n  \n  <ul>\n  <li>Triggers warehouse to assign vehicle</li>\n  <li>Initiates delivery logistics process</li>\n  </ul></li>\n  <li><p><strong>Status Logging</strong>: Print confirmation details</p>\n  \n  <ul>\n  <li>Verbose message: Confirmation sent details</li>\n  <li>Essential message: Order success with order ID</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Modifies agent.pending_deliveries (adds order)</li>\n  <li>Modifies agent.order_timings (records timestamp)</li>\n  <li>Sends SPADE message to warehouse</li>\n  <li>Prints status information to console</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes when confirmation message is sent.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Input: warehouse-accept from warehouse2\n    Body: \"50 electronics\"\n    request_id: 1001000000\nProcessing:\n    - Create Order(orderid=1001000000, quantity=50, product=\"electronics\")\n    - pending_deliveries[1001000000] = Order(...)\n    - order_timings[1001000000] = 42 (current tick)\nOutput:\n    - Send store-confirm to warehouse2\n    - Print: \"Successfully bought 50 xelectronics from warehouse2 under order id 1001000000\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The order remains in pending_deliveries until ReceiveVehicleArrival\n  processes the vehicle-delivery message and updates stock. This maintains\n  separation between contract award and physical delivery.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.SendStoreDenial", "modulename": "store", "qualname": "Store.SendStoreDenial", "kind": "class", "doc": "<p>Behaviour to send rejection to non-selected warehouses (FIPA reject-proposal).</p>\n\n<p>This behaviour implements the rejection notification phase of the FIPA Contract\nNet Protocol, informing warehouses that submitted proposals that their bids were\nnot selected. This is an essential part of the protocol, providing feedback to\nall participants about the outcome of the negotiation.</p>\n\n<p>FIPA Protocol Phase: <strong>Result Notification - Rejection</strong>\n    - Performative: store-deny (FIPA reject-proposal)\n    - Recipients: Warehouses that proposed but were not selected\n    - Purpose: Inform participants their proposal was rejected\n    - Protocol: FIPA Contract Net Protocol\n    - Note: Warehouses that refused (warehouse-reject) do NOT receive this</p>\n\n<p>This message allows warehouses to release any resources they may have reserved\nfor this order and update their internal state accordingly.</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>dest (str):</strong>  Warehouse JID (non-selected participant's address).</li>\n<li><strong>request_id (str):</strong>  Unique request identifier from original CFP.</li>\n<li><strong>quantity (int):</strong>  Quantity of product in the rejected order.</li>\n<li><strong>product (str):</strong>  Name of product in the rejected order.</li>\n</ul>\n\n<p>Message Format (FIPA reject-proposal):\n    Metadata:\n        - performative: \"store-deny\" (FIPA reject-proposal)\n        - warehouse_id: Destination warehouse JID\n        - store_id: This store's JID\n        - node_id: This store's graph location\n        - request_id: Original CFP request identifier\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"50 electronics\"</p>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Sends store-deny message to warehouse</li>\n  <li>Prints denial confirmation (verbose mode only)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Scenario: 3 warehouses proposed, warehouse2 won\nRecipients: warehouse1, warehouse3 (both receive store-deny)\nMessage: \"50 electronics\"\nResult: warehouse1 and warehouse3 know they were not selected\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This notification is important for warehouses to maintain accurate internal\n  state and avoid waiting indefinitely for a confirmation that will never come.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "store.Store.SendStoreDenial.__init__", "modulename": "store", "qualname": "Store.SendStoreDenial.__init__", "kind": "function", "doc": "<p>Initialize the SendStoreDenial behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The warehouse-accept message from the non-selected warehouse.\nContains sender information and order details needed for rejection message.</li>\n</ul>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Extracts only the essential fields needed to construct the rejection.\n  Unlike SendStoreConfirmation, this doesn't need to create an Order object.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span>)</span>"}, {"fullname": "store.Store.SendStoreDenial.dest", "modulename": "store", "qualname": "Store.SendStoreDenial.dest", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreDenial.request_id", "modulename": "store", "qualname": "Store.SendStoreDenial.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreDenial.quantity", "modulename": "store", "qualname": "Store.SendStoreDenial.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreDenial.product", "modulename": "store", "qualname": "Store.SendStoreDenial.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.SendStoreDenial.run", "modulename": "store", "qualname": "Store.SendStoreDenial.run", "kind": "function", "doc": "<p>Execute the rejection sending process (FIPA reject-proposal).</p>\n\n<p>This method sends the FIPA reject-proposal message to non-selected warehouses,\ncompleting the result notification phase of the FIPA Contract Net Protocol.</p>\n\n<h6 id=\"fipa-protocol-implementation\">FIPA Protocol Implementation:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Phase</strong>: Result Notification - Rejection</li>\n  <li><strong>Performative</strong>: store-deny (FIPA reject-proposal)</li>\n  <li><strong>Meaning</strong>: \"Your proposal was not selected\"</li>\n  <li><strong>Expected Response</strong>: Warehouse releases resources, updates state</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><p><strong>Message Construction</strong>: Build store-deny message</p>\n  \n  <ul>\n  <li>Performative: store-deny (FIPA reject-proposal)</li>\n  <li>Metadata: warehouse_id, store_id, node_id, request_id</li>\n  <li>Body: \"{quantity} {product}\"</li>\n  </ul></li>\n  <li><p><strong>Message Transmission</strong>: Send rejection to warehouse</p>\n  \n  <ul>\n  <li>Notifies warehouse of negative outcome</li>\n  <li>Allows warehouse to handle rejection gracefully</li>\n  </ul></li>\n  <li><p><strong>Status Logging</strong>: Print denial confirmation (verbose only)</p></li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Sends SPADE message to warehouse</li>\n  <li>Prints status information if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes when rejection message is sent.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Input: warehouse-accept from warehouse1 (not selected)\n    Body: \"50 electronics\"\n    request_id: 1001000000\nProcessing:\n    - Create store-deny message\n    - Set metadata and body\nOutput:\n    - Send store-deny to warehouse1\n    - Print (if verbose): \"Denial sent to warehouse1 for request: 50 electronics\"\n</code></pre>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.RetryPreviousBuy", "modulename": "store", "qualname": "Store.RetryPreviousBuy", "kind": "class", "doc": "<p>Periodic behaviour that retries failed purchase requests.</p>\n\n<p>This behaviour implements automatic retry logic for purchase requests that failed\ndue to all warehouses rejecting or timing out. It periodically checks the\nfailed_requests queue and re-initiates the FIPA Contract Net Protocol for any\npending failed requests.</p>\n\n<h6 id=\"failure-scenarios\">Failure Scenarios:</h6>\n\n<blockquote>\n  <ul>\n  <li>All warehouses sent warehouse-reject (refuse)</li>\n  <li>All warehouses timed out (no response)</li>\n  <li>Mix of rejects and timeouts with zero acceptances</li>\n  </ul>\n</blockquote>\n\n<p>The behaviour maintains the original request_id for tracking and statistics,\nallowing correlation between original attempt and retry attempts in logs.</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>Inherited from PeriodicBehaviour:</strong>  - period (float): Time between retry attempts (default: 5 seconds)\n<ul>\n<li>Executes continuously while agent is running</li>\n</ul></li>\n</ul>\n\n<h6 id=\"retry-logic\">Retry Logic:</h6>\n\n<blockquote>\n  <ul>\n  <li>Checks failed_requests queue (FIFO)</li>\n  <li>Dequeues one request per execution</li>\n  <li>Preserves original request_id (no new ID generated)</li>\n  <li>Re-broadcasts CFP to all warehouses</li>\n  <li>Launches CollectWarehouseResponses coordinator</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"fipa-protocol\">FIPA Protocol:</h6>\n\n<blockquote>\n  <p>Restarts the entire FIPA Contract Net Protocol:</p>\n  \n  <ol>\n  <li>Call for Proposals (CFP) - re-broadcast with same request_id</li>\n  <li>Proposal Reception - collect new responses</li>\n  <li>Proposal Evaluation - score and select best warehouse</li>\n  <li>Result Notification - confirm winner, deny losers</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Queue Check</strong>: Test if failed_requests queue is empty</li>\n  <li><strong>Dequeue</strong>: Get oldest failed request from queue</li>\n  <li><strong>Parse</strong>: Extract request_id, quantity, product from message</li>\n  <li><strong>Re-broadcast</strong>: Send store-buy to all warehouses (same request_id)</li>\n  <li><strong>Coordinate</strong>: Launch CollectWarehouseResponses for this retry</li>\n  <li><strong>Synchronize</strong>: Wait for coordinator to complete</li>\n  <li><strong>Repeat</strong>: Next period, check queue again</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Initial Attempt (t=10s):\n    - Request \"50 electronics\" (ID: 1001000000)\n    - All warehouses reject or timeout\n    - Added to failed_requests queue\n\nRetry Attempt (t=15s):\n    - Dequeue request 1001000000\n    - Re-broadcast to all warehouses (same ID)\n    - New responses: warehouse2 accepts\n    - Success: Order placed with warehouse2\n</code></pre>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Dequeues from agent.failed_requests</li>\n  <li>Sends store-buy messages to all warehouses</li>\n  <li>Adds CollectWarehouseResponses behaviour</li>\n  <li>Prints retry information if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"notes\">Notes:</h6>\n\n<blockquote>\n  <ul>\n  <li>Retries use the SAME request_id as original attempt</li>\n  <li>No limit on retry attempts (will retry until success)</li>\n  <li>Failed retries are re-enqueued by CollectWarehouseResponses</li>\n  <li>Period of 5 seconds prevents overwhelming warehouses</li>\n  </ul>\n</blockquote>\n", "bases": "spade.behaviour.PeriodicBehaviour"}, {"fullname": "store.Store.RetryPreviousBuy.run", "modulename": "store", "qualname": "Store.RetryPreviousBuy.run", "kind": "function", "doc": "<p>Execute one retry cycle for failed purchase requests.</p>\n\n<p>This method checks the failed_requests queue and, if not empty, dequeues\none request and re-initiates the FIPA Contract Net Protocol with the same\nrequest_id. This maintains traceability across retry attempts.</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Queue Check</strong>: If failed_requests is empty, do nothing</li>\n  <li><strong>Dequeue Request</strong>: Get oldest failed request (FIFO order)</li>\n  <li><strong>Extract Data</strong>: Parse request_id, quantity, product from message</li>\n  <li><strong>Count Participants</strong>: Get number of warehouses for response tracking</li>\n  <li><strong>Rebuild Messages</strong>: Create new store-buy messages for each warehouse</li>\n  <li><strong>Broadcast CFP</strong>: Send retry request to all warehouses</li>\n  <li><strong>Launch Coordinator</strong>: Start CollectWarehouseResponses with same request_id</li>\n  <li><strong>Wait</strong>: Synchronize on coordinator completion</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"request-id-preservation\">Request ID Preservation:</h6>\n\n<blockquote>\n  <p>The original request_id is preserved across retries, enabling:</p>\n  \n  <ul>\n  <li>Statistics tracking (correlate original and retries)</li>\n  <li>Debugging (trace request lifecycle)</li>\n  <li>Avoiding duplicate processing (warehouses can detect retries)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Removes one message from agent.failed_requests queue</li>\n  <li>Sends multiple store-buy messages (one per warehouse)</li>\n  <li>Adds CollectWarehouseResponses behaviour to agent</li>\n  <li>Prints retry notifications if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes when coordinator finishes negotiation, or immediately\n  if queue is empty.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Queue State: [Request(ID=1001000000, \"50 electronics\")]\nProcessing:\n    - Dequeue: Request 1001000000\n    - Parse: quantity=50, product=\"electronics\"\n    - Broadcast: Send to warehouse1, warehouse2, warehouse3\n    - Coordinate: Launch CollectWarehouseResponses(1001000000, ...)\n    - Wait: Until new responses collected and evaluated\nResult:\n    - If success: Order placed\n    - If failure: Re-enqueued for next retry cycle\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method processes only ONE request per execution cycle (period=5s).\n  This prevents flooding warehouses with retry requests and allows\n  gradual processing of the failed_requests backlog.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.ReceiveTimeDelta", "modulename": "store", "qualname": "Store.ReceiveTimeDelta", "kind": "class", "doc": "<p>Cyclic behaviour that processes simulation time updates and traffic information.</p>\n\n<p>This behaviour listens for time synchronization messages from the world agent,\nupdating the store's internal clock and applying dynamic traffic changes to the\ngraph. It implements an event-driven architecture where the world agent controls\nsimulation time progression.</p>\n\n<h6 id=\"message-types-processed\">Message Types Processed:</h6>\n\n<blockquote>\n  <ol>\n  <li><p><strong>Time Updates</strong> (all messages):</p>\n  \n  <ul>\n  <li>Updates agent.current_tick with time delta</li>\n  <li>Synchronizes store with global simulation time</li>\n  </ul></li>\n  <li><p><strong>Traffic Updates</strong> (type=\"Transit\"):</p>\n  \n  <ul>\n  <li>Applies dynamic edge weight changes to graph</li>\n  <li>Updates fuel consumption values for routes</li>\n  <li>Reflects real-time traffic conditions</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<h6 id=\"message-format\">Message Format:</h6>\n\n<blockquote>\n  <p>Metadata:\n      - performative: \"inform\"\n  Body (JSON):</p>\n  \n  <p><div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;type&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;Transit&quot;</span><span class=\"p\">,</span><span class=\"w\">  </span><span class=\"c1\">// or other types</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;time&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"w\">          </span><span class=\"c1\">// delta in ticks</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;data&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nt\">&quot;edges&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"w\">            </span><span class=\"p\">{</span>\n<span class=\"w\">                </span><span class=\"nt\">&quot;node1&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"nt\">&quot;node2&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"nt\">&quot;weight&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">150</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"nt\">&quot;fuel_consumption&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mf\">12.5</span>\n<span class=\"w\">            </span><span class=\"p\">},</span>\n<span class=\"w\">            </span><span class=\"err\">...</span>\n<span class=\"w\">        </span><span class=\"p\">]</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div></p>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>Inherits from CyclicBehaviour:</strong>  - Runs continuously in infinite loop\n<ul>\n<li>Processes one message per cycle</li>\n<li>20-second timeout per receive attempt</li>\n</ul></li>\n</ul>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive Message</strong>: Wait up to 20 seconds for inform message</li>\n  <li><strong>Parse JSON</strong>: Extract type, time delta, and data</li>\n  <li><strong>Update Time</strong>: Increment current_tick by delta</li>\n  <li><strong>Check Type</strong>: If type is \"Transit\", process traffic updates</li>\n  <li><strong>Update Graph</strong>: Apply edge weight changes using update_graph()</li>\n  <li><strong>Repeat</strong>: Return to step 1 (cyclic behaviour)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"traffic-update-process\">Traffic Update Process:</h6>\n\n<blockquote>\n  <p>When type=\"Transit\":\n      - Extract edges array from data field\n      - For each edge: update weight and fuel_consumption\n      - Uses update_graph() helper method\n      - Affects pathfinding calculations in warehouse selection</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Message Received:\n    {\n        \"type\": \"Transit\",\n        \"time\": 3,\n        \"data\": {\n            \"edges\": [\n                {\"node1\": 5, \"node2\": 10, \"weight\": 200, \"fuel_consumption\": 15.0}\n            ]\n        }\n    }\nProcessing:\n    - current_tick: 42 -&gt; 45 (increment by 3)\n    - Update edge (5, 10): weight=200, fuel=15.0\n    - Next warehouse selection uses new weights\n</code></pre>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Increments agent.current_tick (time synchronization)</li>\n  <li>Modifies agent.map edge weights (traffic updates)</li>\n  <li>Affects future pathfinding and warehouse scoring</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Never returns (cyclic behaviour runs until agent stops).</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The 20-second timeout prevents indefinite blocking if world agent stops\n  sending updates. This is a safety mechanism for graceful degradation.</p>\n</blockquote>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "store.Store.ReceiveTimeDelta.run", "modulename": "store", "qualname": "Store.ReceiveTimeDelta.run", "kind": "function", "doc": "<p>Execute one cycle of time delta reception and processing.</p>\n\n<p>This method receives one time synchronization message, updates the store's\ninternal clock, and applies any traffic updates to the graph if present.</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive</strong>: Wait up to 20 seconds for inform message</li>\n  <li><strong>Validation</strong>: Check if message received (not None)</li>\n  <li><strong>Parse</strong>: Deserialize JSON body</li>\n  <li><strong>Extract</strong>: Get type, time delta from JSON</li>\n  <li><strong>Sync Time</strong>: Add delta to current_tick</li>\n  <li><strong>Check Type</strong>: Test if type is \"Transit\" (case-insensitive)</li>\n  <li><strong>Update Graph</strong>: If Transit, apply edge changes via update_graph()</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"time-synchronization\">Time Synchronization:</h6>\n\n<blockquote>\n  <p>Every message (regardless of type) causes time advancement:</p>\n  \n  <ul>\n  <li>current_tick += delta</li>\n  <li>Keeps store synchronized with global simulation time</li>\n  <li>Used for order timing statistics</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"traffic-updates\">Traffic Updates:</h6>\n\n<blockquote>\n  <p>Only Transit messages include graph updates:</p>\n  \n  <ul>\n  <li>data.edges contains array of edge changes</li>\n  <li>Each edge: node1, node2, new weight, fuel_consumption</li>\n  <li>Calls update_graph() to apply changes atomically</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Always increments agent.current_tick</li>\n  <li>Conditionally modifies agent.map (if Transit message)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Continues to next cycle after processing one message.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input: {\"type\": \"Transit\", \"time\": 2, \"data\": {\"edges\": [...]}}\nEffect:\n    - current_tick: 100 -&gt; 102\n    - Graph edges updated with new weights\nNext Cycle: Wait for next message\n</code></pre>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.ReceiveVehicleArrival", "modulename": "store", "qualname": "Store.ReceiveVehicleArrival", "kind": "class", "doc": "<p>Cyclic behaviour that handles vehicle delivery notifications.</p>\n\n<p>This behaviour processes delivery completion messages from vehicle agents,\nupdating inventory when products arrive at the store. It represents the final\nstep in the supply chain: physical delivery and stock replenishment.</p>\n\n<h6 id=\"message-types-accepted\">Message Types Accepted:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>vehicle-delivery</strong>: Vehicle completed delivery to store (primary)</li>\n  <li><strong>vehicle-pickup</strong>: Vehicle picked up goods from warehouse (informational)</li>\n  </ul>\n</blockquote>\n\n<p>The behaviour is filtered by template to only receive vehicle-delivery messages,\nbut includes validation as a safety mechanism.</p>\n\n<h6 id=\"message-format\">Message Format:</h6>\n\n<blockquote>\n  <p>Metadata:\n      - performative: \"vehicle-delivery\"\n      - sender: Vehicle JID\n  Body (JSON):</p>\n  \n  <p><div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1001000000</span><span class=\"p\">,</span><span class=\"w\">  </span><span class=\"c1\">// Unique order identifier</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;time&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">150</span><span class=\"w\">             </span><span class=\"c1\">// ETA or delivery time</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div></p>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>Inherits from CyclicBehaviour:</strong>  - Runs continuously in infinite loop\n<ul>\n<li>Processes one message per cycle</li>\n<li>20-second timeout per receive attempt</li>\n</ul></li>\n</ul>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive Message</strong>: Wait up to 20 seconds for vehicle-delivery</li>\n  <li><strong>Validate Performative</strong>: Verify it's vehicle-delivery (should be filtered)</li>\n  <li><strong>Parse JSON</strong>: Extract orderid and time (ETA)</li>\n  <li><strong>Lookup Order</strong>: Find order in pending_deliveries by orderid</li>\n  <li><strong>Update Stock</strong>: Add delivered quantity to inventory</li>\n  <li><strong>Remove Pending</strong>: Delete order from pending_deliveries</li>\n  <li><strong>Record Statistics</strong>: Save delivery data to CSV</li>\n  <li><strong>Log Delivery</strong>: Print confirmation and current stock</li>\n  <li><strong>Repeat</strong>: Return to step 1 (cyclic behaviour)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"stock-update-logic\">Stock Update Logic:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"k\">if</span> <span class=\"n\">product</span> <span class=\"ow\">in</span> <span class=\"n\">stock</span><span class=\"p\">:</span>\n    <span class=\"n\">stock</span><span class=\"p\">[</span><span class=\"n\">product</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"n\">quantity</span>  <span class=\"c1\"># Increment existing</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">stock</span><span class=\"p\">[</span><span class=\"n\">product</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">quantity</span>   <span class=\"c1\"># Create new entry</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"statistics-recorded\">Statistics Recorded:</h6>\n\n<blockquote>\n  <ul>\n  <li>order_id: Unique identifier</li>\n  <li>store_jid: This store's identifier</li>\n  <li>vehicle_jid: Delivering vehicle identifier</li>\n  <li>origin_warehouse: Warehouse that fulfilled order</li>\n  <li>product: Product name</li>\n  <li>quantity: Amount delivered</li>\n  <li>ETA: Estimated time of arrival</li>\n  <li>time_to_delivery: Ticks from confirmation to delivery</li>\n  <li>current_tick: Current simulation time</li>\n  <li>final_state: \"delivered\" (success indicator)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"error-handling\">Error Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Wrong Performative</strong>: Prints ERROR and returns early</li>\n  <li><strong>JSON Parse Failure</strong>: Catches JSONDecodeError, prints ERROR</li>\n  <li><strong>Missing Order ID</strong>: Catches KeyError, prints ERROR</li>\n  <li>Graceful degradation: Does not crash agent on malformed messages</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Message Received:\n    {\n        \"orderid\": 1001000000,\n        \"time\": 120\n    }\nProcessing:\n    - Find Order: product=\"electronics\", quantity=50\n    - Update Stock: electronics: 200 -&gt; 250\n    - Remove: pending_deliveries[1001000000] deleted\n    - Record Stats: CSV entry with all details\n    - Print: \"Vehicle vehicle1@localhost delivered 50 units of electronics\"\n    - Print: Current stock display\n</code></pre>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Modifies agent.stock (inventory increase)</li>\n  <li>Removes order from agent.pending_deliveries</li>\n  <li>Writes statistics to CSV file</li>\n  <li>Prints delivery confirmation and stock status</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Never returns (cyclic behaviour runs until agent stops).</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This is the ONLY place where stock is updated. Confirmations do NOT update\n  stock - only physical delivery does. This accurately models real-world\n  inventory management where confirmation \u2260 possession.</p>\n</blockquote>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "store.Store.ReceiveVehicleArrival.run", "modulename": "store", "qualname": "Store.ReceiveVehicleArrival.run", "kind": "function", "doc": "<p>Execute one cycle of vehicle delivery message processing.</p>\n\n<p>This method receives one delivery notification, updates inventory, records\nstatistics, and prepares for the next delivery message.</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive</strong>: Wait up to 20 seconds for message</li>\n  <li><strong>Validation</strong>: Check performative is vehicle-delivery</li>\n  <li><strong>Parsing</strong>: Deserialize JSON and extract orderid, time</li>\n  <li><strong>Order Lookup</strong>: Find order in pending_deliveries</li>\n  <li><strong>Stock Update</strong>: Add quantity to inventory (create or increment)</li>\n  <li><strong>Cleanup</strong>: Remove order from pending_deliveries</li>\n  <li><strong>Statistics</strong>: Record delivery details to CSV</li>\n  <li><strong>Logging</strong>: Print delivery confirmation and stock display</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"error-handling\">Error Handling:</h6>\n\n<blockquote>\n  <p>Three validation layers:</p>\n  \n  <ol>\n  <li>Template filter (should only receive vehicle-delivery)</li>\n  <li>Performative check (safety validation)</li>\n  <li>Try-except for JSON parsing and order lookup</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"stock-update-details\">Stock Update Details:</h6>\n\n<blockquote>\n  <ul>\n  <li>Retrieves product and quantity from pending order</li>\n  <li>If product exists: stock[product] += quantity</li>\n  <li>If product new: stock[product] = quantity</li>\n  <li>Thread-safe (single-threaded SPADE execution)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"statistics-recording\">Statistics Recording:</h6>\n\n<blockquote>\n  <p>Calls get_stats() with:</p>\n  \n  <ul>\n  <li>order: Order object with all details</li>\n  <li>eta: Estimated time from message</li>\n  <li>state: \"delivered\" (success indicator)</li>\n  <li>vehicle: Vehicle JID from message sender</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Increments stock for delivered product</li>\n  <li>Removes order from pending_deliveries dict</li>\n  <li>Appends row to store_stats.csv</li>\n  <li>Prints to console (always visible, not verbose-only)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Continues to next cycle after processing one delivery.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input: vehicle-delivery from vehicle1\n    Body: {\"orderid\": 1001000000, \"time\": 120}\nPending Order: Order(product=\"electronics\", quantity=50, ...)\nProcessing:\n    - Stock before: {\"electronics\": 200, \"food\": 100}\n    - Update: electronics += 50\n    - Stock after: {\"electronics\": 250, \"food\": 100}\n    - Remove from pending_deliveries\n    - Write CSV row\nOutput:\n    Print: \"Vehicle vehicle1@localhost delivered 50 units of electronics\"\n    Print: \"Current stock: electronics: 250 units, food: 100 units\"\n</code></pre>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "store.Store.calculate_warehouse_score", "modulename": "store", "qualname": "Store.calculate_warehouse_score", "kind": "function", "doc": "<p>Calculate the score for a warehouse proposal based on delivery time.</p>\n\n<p>This method implements the proposal evaluation logic for the FIPA Contract Net\nProtocol, scoring each warehouse that submitted a proposal (warehouse-accept).\nThe score is based on the estimated delivery time using Dijkstra's shortest path\nalgorithm on the world graph.</p>\n\n<h6 id=\"scoring-algorithm\">Scoring Algorithm:</h6>\n\n<blockquote>\n  <ul>\n  <li>Uses Dijkstra pathfinding: warehouse_node -> store_node</li>\n  <li>Returns: (path, fuel_cost, delivery_time)</li>\n  <li>Score = delivery_time (lower is better)</li>\n  <li>Optimization goal: Minimize delivery time</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"fipa-contract-net-protocol-context\">FIPA Contract Net Protocol Context:</h6>\n\n<blockquote>\n  <ul>\n  <li>Phase: Proposal Evaluation</li>\n  <li>Purpose: Compare multiple proposals objectively</li>\n  <li>Decision Criteria: Distance-based (delivery time)</li>\n  <li>Result: Enables selection of optimal warehouse</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>accept_msg (Message):</strong>  The warehouse-accept message from a warehouse.\nContains metadata with node_id of the warehouse's location.</li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>float: Delivery time score. Lower values indicate better proposals\n      (shorter delivery time).</p>\n</blockquote>\n\n<h6 id=\"scoring-details\">Scoring Details:</h6>\n\n<blockquote>\n  <ul>\n  <li>Extracts warehouse node_id from message metadata</li>\n  <li>Calls Dijkstra: map.djikstra(warehouse_id, store_id)</li>\n  <li>Returns time component (ignores path and fuel for scoring)</li>\n  <li>Units: Simulation ticks (time units in the simulation)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"c1\"># Warehouse at node 10, Store at node 5</span>\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"n\">warehouse_accept_message</span>  <span class=\"c1\"># node_id = 10</span>\n<span class=\"n\">score</span> <span class=\"o\">=</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">calculate_warehouse_score</span><span class=\"p\">(</span><span class=\"n\">msg</span><span class=\"p\">)</span>\n<span class=\"c1\"># Dijkstra returns: ([10, 8, 5], 12.5, 120)</span>\n<span class=\"c1\"># score = 120 (delivery time)</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method is called by CollectWarehouseResponses during proposal\n  evaluation. All warehouses that sent warehouse-accept are scored,\n  and the one with the lowest score (minimum time) is selected.</p>\n</blockquote>\n\n<h6 id=\"alternative-scoring-strategies\">Alternative Scoring Strategies:</h6>\n\n<blockquote>\n  <p>The algorithm could be extended to consider:</p>\n  \n  <ul>\n  <li>Weighted combination: time * w1 + fuel * w2</li>\n  <li>Multi-criteria: time, fuel, warehouse reputation</li>\n  <li>Dynamic weights: Based on urgency or fuel costs</li>\n  </ul>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">accept_msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">) -> <span class=\"nb\">float</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.dict_to_order", "modulename": "store", "qualname": "Store.dict_to_order", "kind": "function", "doc": "<p>Convert a dictionary representation to an Order object.</p>\n\n<p>This helper method deserializes order data from dictionary format into\nan Order object instance, setting all required fields and optional location\ninformation if present.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>data (dict):</strong>  Dictionary containing order information with keys:\n<ul>\n<li>product (str): Product name</li>\n<li>quantity (int): Quantity ordered</li>\n<li>orderid (int): Unique order identifier</li>\n<li>sender (str): Sender's JID</li>\n<li>receiver (str): Receiver's JID</li>\n<li>sender_location (int, optional): Sender's graph node ID</li>\n<li>receiver_location (int, optional): Receiver's graph node ID</li>\n</ul></li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Order: Fully populated Order object with all fields from dictionary.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">&quot;product&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;electronics&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;quantity&quot;</span><span class=\"p\">:</span> <span class=\"mi\">50</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;orderid&quot;</span><span class=\"p\">:</span> <span class=\"mi\">1001000000</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;sender&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;receiver&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;sender_location&quot;</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;receiver_location&quot;</span><span class=\"p\">:</span> <span class=\"mi\">5</span>\n<span class=\"p\">}</span>\n<span class=\"n\">order</span> <span class=\"o\">=</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">dict_to_order</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n<span class=\"c1\"># order.product == &quot;electronics&quot;, order.quantity == 50, etc.</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Uses dict.get() for optional location fields to handle cases where\n  location information is not provided (returns None by default).</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">data</span><span class=\"p\">:</span> <span class=\"nb\">dict</span></span><span class=\"return-annotation\">) -> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.message_to_order", "modulename": "store", "qualname": "Store.message_to_order", "kind": "function", "doc": "<p>Convert a warehouse-accept message to an Order object.</p>\n\n<p>This helper method transforms a SPADE message received during the FIPA Contract\nNet Protocol into a structured Order object suitable for tracking and processing.\nIt extracts all relevant information from the message metadata and body.</p>\n\n<p>The method is used after a warehouse is selected (during SendStoreConfirmation)\nto create an Order object for tracking in pending_deliveries.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The warehouse-accept message containing order details.\nMetadata includes: request_id, node_id (warehouse location)\nBody format: \"{quantity} {product}\"</li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Order: Fully populated Order object with:\n      - product: Extracted from message body\n      - quantity: Extracted from message body\n      - orderid: From request_id metadata\n      - sender: Warehouse JID (message sender)\n      - receiver: Store JID (this store)\n      - sender_location: Warehouse node ID (from metadata)\n      - receiver_location: Store node ID (this store's location)</p>\n</blockquote>\n\n<h6 id=\"message-parsing\">Message Parsing:</h6>\n\n<blockquote>\n  <p>Body:\n      - Format: \"{quantity} {product}\"\n      - Split on space: parts[0] = quantity, parts[1] = product\n      - Example: \"50 electronics\" -> quantity=50, product=\"electronics\"</p>\n  \n  <p>Metadata:\n      - request_id: Used as orderid for correlation\n      - node_id: Warehouse's graph location\n      - sender: Warehouse's JID</p>\n</blockquote>\n\n<h6 id=\"location-assignment\">Location Assignment:</h6>\n\n<blockquote>\n  <ul>\n  <li>sender_location: Warehouse node (from message node_id)</li>\n  <li>receiver_location: Store node (this store's node_id)</li>\n  <li>Note: Reversed compared to dict_to_order perspective</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"c1\"># Warehouse-accept message</span>\n<span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;50 electronics&quot;</span>\n<span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">sender</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;warehouse2@localhost&quot;</span>\n<span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">metadata</span><span class=\"p\">[</span><span class=\"s2\">&quot;request_id&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;1001000000&quot;</span>\n<span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">metadata</span><span class=\"p\">[</span><span class=\"s2\">&quot;node_id&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;10&quot;</span>\n\n<span class=\"n\">order</span> <span class=\"o\">=</span> <span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">message_to_order</span><span class=\"p\">(</span><span class=\"n\">msg</span><span class=\"p\">)</span>\n<span class=\"c1\"># order.product = &quot;electronics&quot;</span>\n<span class=\"c1\"># order.quantity = 50</span>\n<span class=\"c1\"># order.orderid = 1001000000</span>\n<span class=\"c1\"># order.sender = &quot;warehouse2@localhost&quot;</span>\n<span class=\"c1\"># order.receiver = &quot;store1@localhost&quot;</span>\n<span class=\"c1\"># order.sender_location = 10 (warehouse)</span>\n<span class=\"c1\"># order.receiver_location = 5 (store)</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The Order object is used for:</p>\n  \n  <ul>\n  <li>Tracking in pending_deliveries dict (awaiting vehicle delivery)</li>\n  <li>Recording timing information for statistics</li>\n  <li>Providing vehicle with delivery instructions</li>\n  </ul>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">) -> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.set_buy_metadata", "modulename": "store", "qualname": "Store.set_buy_metadata", "kind": "function", "doc": "<p>Set standard metadata for purchase request messages (FIPA CFP).</p>\n\n<p>This helper method populates common metadata fields for store-buy messages,\nensuring consistency across all purchase requests. It sets the performative\nand store identifier, with the caller responsible for setting the request_id.</p>\n\n<h6 id=\"fipa-protocol\">FIPA Protocol:</h6>\n\n<blockquote>\n  <p>This prepares the message for the Call for Proposals (CFP) phase of the\n  FIPA Contract Net Protocol.</p>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The message to populate with metadata. Modified in-place.</li>\n</ul>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <p>Modifies msg metadata:\n      - performative: Set to \"store-buy\" (FIPA CFP)\n      - store_id: Set to this store's JID</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The request_id must be set separately by the caller to ensure unique\n  identification for each purchase request. This separation allows for\n  proper ID encoding and avoids duplication.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">to</span><span class=\"o\">=</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">set_buy_metadata</span><span class=\"p\">(</span><span class=\"n\">msg</span><span class=\"p\">)</span>\n<span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">set_metadata</span><span class=\"p\">(</span><span class=\"s2\">&quot;request_id&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;1001000000&quot;</span><span class=\"p\">)</span>  <span class=\"c1\"># Caller sets this</span>\n<span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;50 electronics&quot;</span>\n<span class=\"c1\"># Message ready to send as FIPA CFP</span>\n</code></pre>\n  </div>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">) -> <span class=\"kc\">None</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.update_graph", "modulename": "store", "qualname": "Store.update_graph", "kind": "function", "doc": "<p>Apply dynamic traffic updates to the world graph.</p>\n\n<p>This method processes transit messages from the world agent, updating edge\nweights in the graph to reflect current traffic conditions. These updates\naffect pathfinding calculations used in warehouse selection, making the\nsystem responsive to real-time network conditions.</p>\n\n<h6 id=\"traffic-data-format\">Traffic Data Format:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;edges&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"w\">        </span><span class=\"p\">{</span>\n<span class=\"w\">            </span><span class=\"nt\">&quot;node1&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"p\">,</span>\n<span class=\"w\">            </span><span class=\"nt\">&quot;node2&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"p\">,</span>\n<span class=\"w\">            </span><span class=\"nt\">&quot;weight&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">200</span><span class=\"p\">,</span>\n<span class=\"w\">            </span><span class=\"nt\">&quot;fuel_consumption&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mf\">15.0</span>\n<span class=\"w\">        </span><span class=\"p\">},</span>\n<span class=\"w\">        </span><span class=\"err\">...</span>\n<span class=\"w\">    </span><span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>traffic_data (dict):</strong>  Dictionary containing edge updates with key \"edges\"\nmapping to a list of edge information dictionaries.</li>\n</ul>\n\n<h6 id=\"edge-processing\">Edge Processing:</h6>\n\n<blockquote>\n  <p>For each edge in traffic_data[\"edges\"]:\n      - Extract: node1, node2, new_weight\n      - Lookup: Find edge in graph using get_edge(node1, node2)\n      - Update: Set edge.weight = new_weight if edge exists\n      - Skip: If edge not found (graceful handling)</p>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Modifies edge weights in self.map (world graph)</li>\n  <li>Affects future Dijkstra calculations</li>\n  <li>Changes warehouse scoring results</li>\n  <li>Does NOT modify fuel_consumption (current implementation)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">traffic_data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">&quot;edges&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span><span class=\"s2\">&quot;node1&quot;</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"s2\">&quot;node2&quot;</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"s2\">&quot;weight&quot;</span><span class=\"p\">:</span> <span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"s2\">&quot;fuel_consumption&quot;</span><span class=\"p\">:</span> <span class=\"mf\">15.0</span><span class=\"p\">},</span>\n        <span class=\"p\">{</span><span class=\"s2\">&quot;node1&quot;</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"s2\">&quot;node2&quot;</span><span class=\"p\">:</span> <span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"s2\">&quot;weight&quot;</span><span class=\"p\">:</span> <span class=\"mi\">150</span><span class=\"p\">,</span> <span class=\"s2\">&quot;fuel_consumption&quot;</span><span class=\"p\">:</span> <span class=\"mf\">12.0</span><span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n<span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">update_graph</span><span class=\"p\">(</span><span class=\"n\">traffic_data</span><span class=\"p\">)</span>\n<span class=\"c1\"># Edge (5, 10) weight updated to 200</span>\n<span class=\"c1\"># Edge (10, 15) weight updated to 150</span>\n<span class=\"c1\"># Future pathfinding uses new weights</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Currently only updates weight, not fuel_consumption. Future enhancement\n  could update fuel_consumption as well for more realistic simulation:</p>\n  \n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"k\">if</span> <span class=\"n\">edge</span><span class=\"p\">:</span>\n    <span class=\"n\">edge</span><span class=\"o\">.</span><span class=\"n\">weight</span> <span class=\"o\">=</span> <span class=\"n\">new_weight</span>\n    <span class=\"n\">edge</span><span class=\"o\">.</span><span class=\"n\">fuel_consumption</span> <span class=\"o\">=</span> <span class=\"n\">new_fuel</span>  <span class=\"c1\"># Not currently implemented</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"impact-on-system\">Impact on System:</h6>\n\n<blockquote>\n  <ul>\n  <li>Dynamic responsiveness to traffic conditions</li>\n  <li>Warehouses with congested routes become less attractive</li>\n  <li>Enables simulation of rush hours, accidents, road closures</li>\n  <li>Realistic supply chain behavior under varying conditions</li>\n  </ul>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">traffic_data</span></span><span class=\"return-annotation\">) -> <span class=\"kc\">None</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.get_stats", "modulename": "store", "qualname": "Store.get_stats", "kind": "function", "doc": "<p>Record order statistics to CSV file for post-simulation analysis.</p>\n\n<p>This method captures comprehensive metrics about each order, including timing,\nparticipants, and outcome. Statistics are appended to a CSV file for later\nanalysis of supply chain performance, bottlenecks, and optimization opportunities.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>order (Order):</strong>  The order object containing product, quantity, and IDs.</li>\n<li><strong>eta (int):</strong>  Estimated time of arrival or delivery time in simulation ticks.</li>\n<li><strong>state (str):</strong>  Final state of the order. Possible values:\n<ul>\n<li>\"delivered\": Successfully completed</li>\n<li>\"pending\": Awaiting delivery</li>\n<li>\"failed\": Order failed (not currently used)</li>\n</ul></li>\n<li><strong>vehicle (str):</strong>  JID of the vehicle that handled the delivery.</li>\n</ul>\n\n<h6 id=\"statistics-captured\">Statistics Captured:</h6>\n\n<blockquote>\n  <ul>\n  <li>order_id: Unique request identifier</li>\n  <li>store_jid: This store's identifier (without @domain)</li>\n  <li>vehicle_jid: Delivering vehicle's identifier (without @domain)</li>\n  <li>origin_warehouse: Warehouse that fulfilled order (without @domain)</li>\n  <li>product: Product name</li>\n  <li>quantity: Amount ordered/delivered</li>\n  <li>ETA: Estimated time of arrival from vehicle</li>\n  <li>time_to_delivery: Total ticks from confirmation to delivery</li>\n  <li>current_tick: Simulation time when stats recorded</li>\n  <li>final_state: Outcome indicator (delivered/pending/failed)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"csv-file-format\">CSV File Format:</h6>\n\n<blockquote>\n  <ul>\n  <li>Location: stats/store_stats.csv</li>\n  <li>Encoding: UTF-8</li>\n  <li>Headers: Written automatically on first write</li>\n  <li>Mode: Append (preserves previous records)</li>\n  </ul>\n</blockquote>\n\n<p>Time-to-Delivery Calculation:</p>\n\n<pre><code><div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">time_to_delivery</span> <span class=\"o\">=</span> <span class=\"n\">current_tick</span> <span class=\"o\">-</span> <span class=\"n\">order_timings</span><span class=\"p\">[</span><span class=\"n\">orderid</span><span class=\"p\">]</span>\n<span class=\"c1\"># order_timings[orderid] set during SendStoreConfirmation</span>\n<span class=\"c1\"># Measures: Confirmation -&gt; Delivery complete</span>\n</code></pre>\n</div>\n</code></pre>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Creates stats/ directory if it doesn't exist</li>\n  <li>Creates or appends to store_stats.csv</li>\n  <li>Prints confirmation if verbose mode enabled</li>\n  <li>Prints error if file operation fails</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"error-handling\">Error Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li>Wraps file operations in try-except</li>\n  <li>Catches all exceptions (broad handling for robustness)</li>\n  <li>Prints error message with exception details</li>\n  <li>Does not crash agent on statistics failure</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-csv-output\">Example CSV Output:</h6>\n\n<blockquote>\n<pre><code>order_id,store_jid,vehicle_jid,origin_warehouse,product,quantity,ETA,time_to_delivery,current_tick,final_state\n1001000000,store1,vehicle1,warehouse2,electronics,50,120,125,345,delivered\n1001000001,store1,vehicle2,warehouse1,food,30,80,85,430,delivered\n</code></pre>\n</blockquote>\n\n<h6 id=\"performance-metrics-enabled\">Performance Metrics Enabled:</h6>\n\n<blockquote>\n  <ul>\n  <li>Average delivery time per product</li>\n  <li>Warehouse performance comparison</li>\n  <li>Vehicle efficiency analysis</li>\n  <li>Bottleneck identification</li>\n  <li>Demand pattern analysis</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-usage\">Example Usage:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"c1\"># Called from ReceiveVehicleArrival after delivery</span>\n<span class=\"n\">order</span> <span class=\"o\">=</span> <span class=\"n\">pending_deliveries</span><span class=\"p\">[</span><span class=\"n\">orderid</span><span class=\"p\">]</span>\n<span class=\"n\">eta</span> <span class=\"o\">=</span> <span class=\"mi\">120</span>  <span class=\"c1\"># From vehicle message</span>\n<span class=\"n\">store</span><span class=\"o\">.</span><span class=\"n\">get_stats</span><span class=\"p\">(</span><span class=\"n\">order</span><span class=\"p\">,</span> <span class=\"n\">eta</span><span class=\"p\">,</span> <span class=\"s2\">&quot;delivered&quot;</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">sender</span><span class=\"p\">)</span>\n<span class=\"c1\"># CSV row appended with all order metrics</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Statistics are append-only. For new simulation runs, manually delete or\n  rename the CSV file to avoid mixing data from different experiments.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">order</span><span class=\"p\">:</span> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>, </span><span class=\"param\"><span class=\"n\">eta</span>, </span><span class=\"param\"><span class=\"n\">state</span>, </span><span class=\"param\"><span class=\"n\">vehicle</span></span><span class=\"return-annotation\">) -> <span class=\"kc\">None</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.print_stock", "modulename": "store", "qualname": "Store.print_stock", "kind": "function", "doc": "<p>Print the current stock inventory to console.</p>\n\n<p>This helper method provides a human-readable display of the store's current\ninventory, showing all products and their quantities. Used after deliveries\nto provide visibility into stock levels.</p>\n\n<h6 id=\"output-format\">Output Format:</h6>\n\n<blockquote>\n  <p>If stock is empty:\n      \"{jid}&gt; Stock is empty\"</p>\n  \n  <p>If stock has items:\n      \"{jid}&gt; Current stock:\"\n      \"  - product1: quantity1 units\"\n      \"  - product2: quantity2 units\"\n      ...</p>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Prints to standard output (console)</li>\n  <li>Always visible (not affected by verbose setting)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-output\">Example Output:</h6>\n\n<blockquote>\n<pre><code>store1@localhost&gt; Current stock:\n  - electronics: 250 units\n  - food: 100 units\n  - clothing: 75 units\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method is called after every successful delivery to provide\n  immediate feedback about inventory changes.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">) -> <span class=\"kc\">None</span>:</span></span>", "funcdef": "def"}, {"fullname": "store.Store.node_id", "modulename": "store", "qualname": "Store.node_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.map", "modulename": "store", "qualname": "Store.map", "kind": "variable", "doc": "<p></p>\n", "annotation": ": world.graph.Graph"}, {"fullname": "store.Store.contact_list", "modulename": "store", "qualname": "Store.contact_list", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.verbose", "modulename": "store", "qualname": "Store.verbose", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.id_base", "modulename": "store", "qualname": "Store.id_base", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.pending_deliveries", "modulename": "store", "qualname": "Store.pending_deliveries", "kind": "variable", "doc": "<p></p>\n", "annotation": ": dict[str, veiculos.veiculos.Order]"}, {"fullname": "store.Store.order_timings", "modulename": "store", "qualname": "Store.order_timings", "kind": "variable", "doc": "<p></p>\n", "annotation": ": dict[str, int]"}, {"fullname": "store.Store.current_tick", "modulename": "store", "qualname": "Store.current_tick", "kind": "variable", "doc": "<p></p>\n", "annotation": ": int"}, {"fullname": "store.Store.stats_path", "modulename": "store", "qualname": "Store.stats_path", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.stats_filename", "modulename": "store", "qualname": "Store.stats_filename", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.product_list", "modulename": "store", "qualname": "Store.product_list", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.buy_prob", "modulename": "store", "qualname": "Store.buy_prob", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.max_buy_quantity", "modulename": "store", "qualname": "Store.max_buy_quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "store.Store.setup", "modulename": "store", "qualname": "Store.setup", "kind": "function", "doc": "<p>Setup method called automatically by SPADE when agent starts.</p>\n\n<p>This method initializes the agent's operational state and registers all\nbehaviours with appropriate message templates. It completes the agent\ninitialization process started in __init__, preparing the store for\nactive participation in the supply chain simulation.</p>\n\n<h6 id=\"initialization-steps\">Initialization Steps:</h6>\n\n<blockquote>\n  <ol>\n  <li>Configure presence management (auto-approve subscriptions)</li>\n  <li>Subscribe to all warehouses in contact list</li>\n  <li>Initialize runtime state variables (stock, counters, queues)</li>\n  <li>Register BuyProduct behaviour (periodic purchasing)</li>\n  <li>Register ReceiveTimeDelta behaviour (time synchronization)</li>\n  <li>Register RetryPreviousBuy behaviour (failed request retry)</li>\n  <li>Register ReceiveVehicleArrival behaviour (delivery reception)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"presence-configuration\">Presence Configuration:</h6>\n\n<blockquote>\n  <ul>\n  <li>presence.approve_all = True: Auto-accept all subscription requests</li>\n  <li>Subscribes to each warehouse in contact_list</li>\n  <li>Enables bidirectional communication with warehouses</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"state-initialization\">State Initialization:</h6>\n\n<blockquote>\n  <ul>\n  <li>stock: Empty dict (populated by deliveries)</li>\n  <li>current_buy_request: None (set during purchase attempts)</li>\n  <li>failed_requests: Empty FIFO queue (populated by failed negotiations)</li>\n  <li>request_counter: 0 (incremented for each purchase request)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"behaviour-registration\">Behaviour Registration:</h6>\n\n<blockquote>\n  <ol>\n  <li><p><strong>BuyProduct</strong> (PeriodicBehaviour):</p>\n  \n  <ul>\n  <li>No template filter (self-triggered by period)</li>\n  <li>Period: config.STORE_BUY_FREQUENCY seconds</li>\n  <li>Purpose: Initiate FIPA Contract Net Protocol for purchases</li>\n  </ul></li>\n  <li><p><strong>ReceiveTimeDelta</strong> (CyclicBehaviour):</p>\n  \n  <ul>\n  <li>Template: performative=\"inform\"</li>\n  <li>Purpose: Receive time updates and traffic data from world agent</li>\n  <li>Continuous operation</li>\n  </ul></li>\n  <li><p><strong>RetryPreviousBuy</strong> (PeriodicBehaviour):</p>\n  \n  <ul>\n  <li>No template filter (self-triggered)</li>\n  <li>Period: 5 seconds</li>\n  <li>Purpose: Retry failed purchase requests</li>\n  </ul></li>\n  <li><p><strong>ReceiveVehicleArrival</strong> (CyclicBehaviour):</p>\n  \n  <ul>\n  <li>Template: performative=\"vehicle-delivery\"</li>\n  <li>Purpose: Receive delivery notifications and update stock</li>\n  <li>Continuous operation</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<h6 id=\"template-filtering\">Template Filtering:</h6>\n\n<blockquote>\n  <p>Templates ensure behaviours only receive relevant messages:</p>\n  \n  <ul>\n  <li>ReceiveTimeDelta: Only \"inform\" messages (from world agent)</li>\n  <li>ReceiveVehicleArrival: Only \"vehicle-delivery\" messages (from vehicles)</li>\n  <li>BuyProduct/RetryPreviousBuy: No template (time-triggered, not message-triggered)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Sends presence subscription requests to all warehouses</li>\n  <li>Adds four behaviours to agent's behaviour queue</li>\n  <li>Prints subscription confirmations if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes when all behaviours are registered and agent is operational.</p>\n</blockquote>\n\n<h6 id=\"example-flow\">Example Flow:</h6>\n\n<blockquote>\n<pre><code>Agent Start:\n    1. SPADE calls setup()\n    2. Subscribe to warehouse1, warehouse2\n    3. Initialize stock = {}\n    4. Register BuyProduct (will start after 5s)\n    5. Register ReceiveTimeDelta (active immediately)\n    6. Register RetryPreviousBuy (checks every 5s)\n    7. Register ReceiveVehicleArrival (active immediately)\n    8. Agent ready for operation\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method is asynchronous and is automatically called by SPADE's\n  agent lifecycle management. Do not call this method manually.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse", "modulename": "warehouse", "kind": "module", "doc": "<p>Warehouse Agent Module for Supply Chain Optimization System.</p>\n\n<p>This module implements the Warehouse agent, which serves as an intermediary in the supply\nchain between stores and suppliers. The Warehouse manages inventory, accepts orders from\nstores, purchases materials from suppliers, and coordinates vehicle delivery logistics.</p>\n\n<p>The module implements dual FIPA Contract Net Protocol roles:</p>\n\n<ol>\n<li><strong>Participant</strong> (with Stores): Responds to store purchase requests</li>\n<li><strong>Initiator</strong> (with Suppliers): Initiates purchase requests for restocking</li>\n</ol>\n\n<h6 id=\"typical-usage-example\">Typical usage example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">world.graph</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Graph</span>\n\n<span class=\"c1\"># Initialize graph and warehouse agent</span>\n<span class=\"n\">map_graph</span> <span class=\"o\">=</span> <span class=\"n\">Graph</span><span class=\"p\">()</span>\n<span class=\"n\">warehouse</span> <span class=\"o\">=</span> <span class=\"n\">Warehouse</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;warehouse_password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">map_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;supplier1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;vehicle1@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"k\">await</span> <span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</code></pre>\n  </div>\n</blockquote>\n"}, {"fullname": "warehouse.Warehouse", "modulename": "warehouse", "qualname": "Warehouse", "kind": "class", "doc": "<p>Warehouse Agent for Supply Chain Management System.</p>\n\n<p>The Warehouse agent acts as a critical intermediary in the supply chain, managing\ninventory, fulfilling store orders, and coordinating with suppliers and vehicles.\nIt implements dual FIPA Contract Net Protocol roles, acting as both participant\nand initiator depending on the interaction context.</p>\n\n<p>FIPA Contract Net Protocol - Dual Role Implementation:</p>\n\n<ol>\n<li><p><strong>As Participant (with Stores)</strong>:</p>\n\n<ul>\n<li><strong>Proposal Phase</strong>: Receives store-buy CFP from stores</li>\n<li><strong>Proposal Submission</strong>: Sends warehouse-accept (propose) or warehouse-reject (refuse)</li>\n<li><strong>Result Reception</strong>: Receives store-confirm (accept-proposal) or store-deny (reject-proposal)</li>\n<li><strong>Execution</strong>: Assigns vehicles for confirmed orders</li>\n</ul></li>\n<li><p><strong>As Initiator (with Suppliers)</strong>:</p>\n\n<ul>\n<li><strong>CFP Phase</strong>: Sends warehouse-buy CFP to suppliers for restocking</li>\n<li><strong>Proposal Collection</strong>: Receives supplier-accept (propose) or supplier-reject (refuse)</li>\n<li><strong>Evaluation</strong>: Scores suppliers based on delivery time</li>\n<li><strong>Award</strong>: Sends warehouse-confirm (accept-proposal) or warehouse-deny (reject-proposal)</li>\n</ul></li>\n</ol>\n\n<h6 id=\"stock-management-strategy\">Stock Management Strategy:</h6>\n\n<blockquote>\n  <p>The warehouse uses a three-tier stock system:</p>\n  \n  <ol>\n  <li><strong>Available Stock</strong> (self.stock): Products available for new orders</li>\n  <li><strong>Locked Stock</strong> (self.locked_stock): Reserved for pending negotiations</li>\n  <li><strong>Pending Deliveries</strong> (self.pending_deliveries): Confirmed orders awaiting pickup</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"id-encoding-system\">ID Encoding System:</h6>\n\n<blockquote>\n  <p>Similar to Store agent, uses hierarchical encoding:</p>\n  \n  <ul>\n  <li>Formula: <code>agent_type * 100_000_000 + instance_id * 1_000_000 + request_counter</code></li>\n  <li>Agent type code for Warehouse: 2</li>\n  <li>Example: warehouse1's first request = 2_001_000_000</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>jid (str):</strong>  Jabber ID of the warehouse agent (e.g., \"warehouse1@localhost\").</li>\n<li><strong>node_id (int):</strong>  Graph node ID representing the warehouse's physical location.</li>\n<li><strong>map (Graph):</strong>  Reference to the world graph for pathfinding calculations.</li>\n<li><strong>contact_list (list[str]):</strong>  JIDs for stores, suppliers, and vehicles.</li>\n<li><strong>verbose (bool):</strong>  Flag to control debug output verbosity.</li>\n<li><strong>id_base (int):</strong>  Base value for generating unique request IDs.</li>\n<li><strong>stock (dict[str, int]):</strong>  Available inventory (not locked or pending).</li>\n<li><strong>locked_stock (dict[str, int]):</strong>  Stock reserved during store negotiations.</li>\n<li><strong>current_capacity (dict[str, int]):</strong>  Remaining capacity per product.</li>\n<li><strong>pending_deliveries (dict[int, Order]):</strong>  Confirmed orders awaiting vehicle pickup.</li>\n<li><strong>vehicle_proposals (dict[int, dict[str, tuple[bool, int]]]):</strong>  Vehicle delivery proposals.\nFormat: {order_id: {vehicle_jid: (can_fit, delivery_time)}}</li>\n<li><strong>vehicles (list[str]):</strong>  List of vehicle JIDs discovered from contacts.</li>\n<li><strong>suppliers (list[str]):</strong>  List of supplier JIDs discovered from contacts.</li>\n<li><strong>request_counter (int):</strong>  Monotonic counter for unique request IDs.</li>\n<li><strong>current_buy_request (Message):</strong>  Most recent supplier purchase request.</li>\n<li><strong>failed_requests (queue.Queue):</strong>  Queue of failed supplier requests for retry.</li>\n<li><strong>presence_infos (dict[str, str]):</strong>  Vehicle presence status cache.</li>\n<li><strong>current_tick (int):</strong>  Current simulation time, synchronized by world agent.</li>\n</ul>\n\n<h6 id=\"behaviours\">Behaviours:</h6>\n\n<blockquote>\n  <p>Store Interaction:\n      - ReceiveBuyRequest: Processes store purchase requests (FIPA participant)\n      - AcceptBuyRequest: Sends proposal to store (FIPA propose)\n      - RejectBuyRequest: Sends refusal to store (FIPA refuse)\n      - ReceiveConfirmationOrDenial: Handles store's award/rejection\n      - AssignVehicle: Coordinates vehicle assignment for deliveries\n      - ReceivePresenceInfo: Checks vehicle availability\n      - ReceiveVehicleProposals: Collects vehicle delivery proposals\n      - ChooseBestVehicle: Selects optimal vehicle using scoring algorithm</p>\n  \n  <p>Supplier Interaction:\n      - BuyMaterial: Initiates purchase requests to suppliers (FIPA initiator)\n      - CollectSupplierResponses: Coordinator for supplier negotiation\n      - ReceiveAllSupplierResponses: Worker collecting supplier responses\n      - SendWarehouseConfirmation: Awards contract to supplier (FIPA accept-proposal)\n      - SendWarehouseDenial: Rejects supplier proposals (FIPA reject-proposal)\n      - RetryPreviousBuy: Retries failed supplier requests\n      - HandleResupply: Monitors stock and triggers restocking</p>\n  \n  <p>Vehicle &amp; Time Management:\n      - ReceiveVehicleArrival: Handles vehicle pickup and delivery notifications\n      - ReceiveTimeDelta: Synchronizes time and applies traffic updates</p>\n</blockquote>\n\n<h6 id=\"message-protocols\">Message Protocols:</h6>\n\n<blockquote>\n  <p>Incoming from Stores:\n      - store-buy: Purchase request (FIPA CFP)\n      - store-confirm: Order confirmation (FIPA accept-proposal)\n      - store-deny: Order rejection (FIPA reject-proposal)</p>\n  \n  <p>Outgoing to Stores:\n      - warehouse-accept: Order proposal (FIPA propose)\n      - warehouse-reject: Order refusal (FIPA refuse)</p>\n  \n  <p>Outgoing to Suppliers:\n      - warehouse-buy: Purchase request (FIPA CFP)\n      - warehouse-confirm: Supplier confirmation (FIPA accept-proposal)\n      - warehouse-deny: Supplier rejection (FIPA reject-proposal)</p>\n  \n  <p>Incoming from Suppliers:\n      - supplier-accept: Material proposal (FIPA propose)\n      - supplier-reject: Material refusal (FIPA refuse)</p>\n  \n  <p>Vehicle Communication:\n      - order-proposal: Request vehicle delivery quote\n      - vehicle-proposal: Vehicle delivery proposal\n      - order-confirmation: Confirm vehicle assignment\n      - vehicle-pickup: Vehicle picks up order\n      - vehicle-delivery: Vehicle delivers supplies\n      - presence-info: Request vehicle availability\n      - presence-response: Vehicle availability status</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">warehouse</span> <span class=\"o\">=</span> <span class=\"n\">Warehouse</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">world_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;supplier1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;vehicle1@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"k\">await</span> <span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The warehouse automatically restocks when inventory falls below\n  config.WAREHOUSE_RESUPPLY_THRESHOLD, maintaining operational capacity.</p>\n</blockquote>\n", "bases": "spade.agent.Agent"}, {"fullname": "warehouse.Warehouse.__init__", "modulename": "warehouse", "qualname": "Warehouse.__init__", "kind": "function", "doc": "<p>Initialize the Warehouse agent with connection parameters and world state.</p>\n\n<p>The constructor configures the warehouse's identity, location, and initial\nstate. It implements the ID encoding system for generating unique request\nidentifiers compatible with the FIPA Contract Net Protocol.</p>\n\n<h6 id=\"id-encoding-system\">ID Encoding System:</h6>\n\n<blockquote>\n  <p>Formula: <code>agent_type * 100_000_000 + instance_id * 1_000_000 + counter</code></p>\n  \n  <ul>\n  <li>Agent Type Code: 2 (for Warehouse agents)</li>\n  <li>Instance ID: Extracted from JID (e.g., \"warehouse3\" -> 3)</li>\n  <li>Base ID Calculation: <code>2 * 100_000_000 + instance_id * 1_000_000</code></li>\n  </ul>\n  \n  <p>Examples:\n      - warehouse1: base = 201_000_000 (first request: 201_000_000)\n      - warehouse2: base = 202_000_000 (first request: 202_000_000)\n      - warehouse5: base = 205_000_000 (first request: 205_000_000)</p>\n  \n  <p>This encoding allows agents to identify:\n      1. What type of agent created the request (200M range = warehouse)\n      2. Which specific warehouse instance (next 1M range)\n      3. Which request in sequence (counter increments)</p>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>jid (str):</strong>  Jabber ID for XMPP communication (e.g., \"warehouse1@localhost\").</li>\n<li><strong>password (str):</strong>  Authentication password for XMPP server.</li>\n<li><strong>map (Graph):</strong>  Reference to the world graph for pathfinding and locations.</li>\n<li><strong>node_id (int):</strong>  Graph node representing the warehouse's physical location.</li>\n<li><strong>port (int, optional):</strong>  XMPP server port. Defaults to 5222.</li>\n<li><strong>verify_security (bool, optional):</strong>  Enable SSL/TLS verification. Defaults to False.</li>\n<li><strong>contact_list (list[str], optional):</strong>  JIDs of stores, suppliers, vehicles for presence\nsubscription. Defaults to empty list.</li>\n<li><strong>verbose (bool, optional):</strong>  Enable detailed debug logging. Defaults to False.</li>\n</ul>\n\n<h6 id=\"attributes-initialized\">Attributes Initialized:</h6>\n\n<blockquote>\n  <p>Core Identity:\n      - node_id: Warehouse location on graph\n      - map: World graph reference\n      - contact_list: Agents for presence subscription\n      - verbose: Debug output flag</p>\n  \n  <p>ID Encoding:\n      - id_base: Base value for generating unique request IDs\n      - request_counter: Monotonic counter for requests</p>\n  \n  <p>Order Management:\n      - pending_deliveries: Dict mapping order_id -> Order objects\n      - vehicle_proposals: Dict mapping order_id -> vehicle proposals</p>\n  \n  <p>Contact Discovery:\n      - vehicles: List of vehicle JIDs (populated during setup)\n      - suppliers: List of supplier JIDs (populated during setup)</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">warehouse</span> <span class=\"o\">=</span> <span class=\"n\">Warehouse</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;password123&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">world_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span>\n        <span class=\"s2\">&quot;store1@localhost&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;store2@localhost&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;supplier1@localhost&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;vehicle1@localhost&quot;</span>\n    <span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"c1\"># ID base calculated: 2 * 100_000_000 + 1 * 1_000_000 = 201_000_000</span>\n<span class=\"c1\"># First request ID will be: 201_000_000</span>\n<span class=\"c1\"># Second request ID will be: 201_000_001</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The constructor only initializes essential attributes. Most warehouse\n  state (stock, locked_stock, behaviours) is configured in the setup()\n  method which runs after the agent connects to the XMPP server.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">jid</span>,</span><span class=\"param\">\t<span class=\"n\">password</span>,</span><span class=\"param\">\t<span class=\"nb\">map</span><span class=\"p\">:</span> <span class=\"n\">world</span><span class=\"o\">.</span><span class=\"n\">graph</span><span class=\"o\">.</span><span class=\"n\">Graph</span>,</span><span class=\"param\">\t<span class=\"n\">node_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">port</span><span class=\"o\">=</span><span class=\"mi\">5222</span>,</span><span class=\"param\">\t<span class=\"n\">verify_security</span><span class=\"o\">=</span><span class=\"kc\">False</span>,</span><span class=\"param\">\t<span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[]</span>,</span><span class=\"param\">\t<span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">False</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.ReceiveBuyRequest", "modulename": "warehouse", "qualname": "Warehouse.ReceiveBuyRequest", "kind": "class", "doc": "<p>Cyclic behaviour that processes incoming purchase requests from stores.</p>\n\n<p>This behaviour implements the proposal phase of the FIPA Contract Net Protocol\nwhere the warehouse acts as a <strong>Participant</strong>. It receives CFP messages from\nstores, evaluates inventory availability, and responds with either a proposal\n(warehouse-accept) or refusal (warehouse-reject).</p>\n\n<p>FIPA Protocol Phase: <strong>Proposal Phase - Participant Role</strong>\n    - Role: Participant (Warehouse responding to Store's CFP)\n    - Receives: store-buy messages (FIPA CFP)\n    - Evaluates: Stock availability vs requested quantity\n    - Responds: warehouse-accept (propose) or warehouse-reject (refuse)</p>\n\n<h6 id=\"stock-locking-mechanism\">Stock Locking Mechanism:</h6>\n\n<blockquote>\n  <p>When accepting a request, stock is immediately moved from available to locked:</p>\n  \n  <ul>\n  <li>Prevents overselling (race condition protection)</li>\n  <li>Reserved during negotiation (awaiting confirmation)</li>\n  <li>Released if store sends denial or timeout occurs</li>\n  <li>Transferred to pending_deliveries if store confirms</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"decision-logic\">Decision Logic:</h6>\n\n<blockquote>\n  <p>Accept if: (product in stock) AND (stock[product] &gt;= quantity)\n  Reject if: Product unavailable OR insufficient quantity</p>\n</blockquote>\n\n<p>Message Format (store-buy):\n    Metadata:\n        - performative: \"store-buy\"\n        - request_id: Unique request identifier\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"50 electronics\"</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive</strong>: Wait up to 20 seconds for store-buy message</li>\n  <li><strong>Parse</strong>: Extract request_id, quantity, product from message</li>\n  <li><strong>Evaluate</strong>: Check if product exists and quantity available</li>\n  <li><strong>Accept Path</strong>:\n  a. Lock stock: stock[product] -= quantity\n  b. Update locked_stock: locked_stock[product] += quantity\n  c. Launch AcceptBuyRequest behaviour (send warehouse-accept)</li>\n  <li><strong>Reject Path</strong>:\n  a. Launch RejectBuyRequest behaviour with reason\n  b. No stock changes</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"concurrency-handling\">Concurrency Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li>Processes multiple requests concurrently (cyclic behaviour)</li>\n  <li>Stock locking prevents double-allocation</li>\n  <li>Each request launches independent OneShot behaviours</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Request Received: \"50 electronics\" (request_id=1001000000)\nStock Check: electronics: 100 available\nDecision: ACCEPT\nActions:\n    - stock[electronics]: 100 -&gt; 50\n    - locked_stock[electronics]: 0 -&gt; 50\n    - Launch AcceptBuyRequest\n    - Wait for store-confirm or store-deny\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This behaviour never terminates (cyclic), continuously listening for\n  store requests throughout the warehouse's lifecycle.</p>\n</blockquote>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "warehouse.Warehouse.ReceiveBuyRequest.run", "modulename": "warehouse", "qualname": "Warehouse.ReceiveBuyRequest.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest", "kind": "class", "doc": "<p>Behaviour that sends proposal acceptance to store (FIPA propose).</p>\n\n<p>This behaviour implements the proposal submission in the FIPA Contract Net\nProtocol where the warehouse, acting as a participant, sends its proposal\nto fulfill the store's request. It then sets up to receive the store's\ndecision (accept-proposal or reject-proposal).</p>\n\n<p>FIPA Protocol Phase: <strong>Proposal Submission - Participant Role</strong>\n    - Role: Participant (Warehouse proposing to Store)\n    - Sends: warehouse-accept (FIPA propose)\n    - Purpose: \"I can fulfill your request\"\n    - Next Phase: Await store's award or rejection decision</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique identifier for this request.</li>\n<li><strong>quant (int):</strong>  Quantity of product being proposed.</li>\n<li><strong>product (str):</strong>  Name of product being proposed.</li>\n<li><strong>sender (str):</strong>  Store JID that initiated the request.</li>\n</ul>\n\n<p>Message Format (warehouse-accept):\n    Metadata:\n        - performative: \"warehouse-accept\" (FIPA propose)\n        - warehouse_id: This warehouse's JID\n        - store_id: Requesting store's JID\n        - node_id: Warehouse's graph location\n        - request_id: Original request identifier\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"50 electronics\"</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Send Proposal</strong>: Construct and send warehouse-accept message</li>\n  <li><strong>Setup Listener</strong>: Create ReceiveConfirmationOrDenial behaviour</li>\n  <li><strong>Configure Template</strong>: Filter for this specific store and request</li>\n  <li><strong>Register Behaviour</strong>: Add listener with template to agent</li>\n  <li><strong>Non-blocking</strong>: Return immediately (don't wait for response)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"template-configuration\">Template Configuration:</h6>\n\n<blockquote>\n  <p>Filters messages to match:</p>\n  \n  <ul>\n  <li>warehouse_id: This warehouse</li>\n  <li>store_id: Specific store that made request</li>\n  <li>request_id: This specific request</li>\n  </ul>\n  \n  <p>Accepts both performatives:</p>\n  \n  <ul>\n  <li>store-confirm (FIPA accept-proposal)</li>\n  <li>store-deny (FIPA reject-proposal)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input: Store request for \"50 electronics\"\nProposal Sent: warehouse-accept with body \"50 electronics\"\nListener Setup: ReceiveConfirmationOrDenial waiting for:\n    - store-confirm (unlock -&gt; pending delivery) OR\n    - store-deny (unlock -&gt; available stock)\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Stock remains locked until ReceiveConfirmationOrDenial processes\n  the store's decision or times out.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest.__init__", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest.__init__", "kind": "function", "doc": "<p>Initialize the AcceptBuyRequest behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The store-buy request message to accept.\nContains request_id in metadata and \"{quantity} {product}\" in body.</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest.request_id", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest.quant", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest.quant", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest.product", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest.sender", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest.sender", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.AcceptBuyRequest.run", "modulename": "warehouse", "qualname": "Warehouse.AcceptBuyRequest.run", "kind": "function", "doc": "<p>Execute the proposal sending and confirmation listener setup.</p>\n\n<p>This method sends the warehouse-accept (FIPA propose) message to the store\nand immediately sets up a listener behaviour to await the store's decision.\nThe method returns quickly without blocking, allowing the warehouse to\ncontinue processing other requests concurrently.</p>\n\n<h6 id=\"fipa-protocol-implementation\">FIPA Protocol Implementation:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Phase</strong>: Proposal Submission</li>\n  <li><strong>Performative</strong>: warehouse-accept (FIPA propose)</li>\n  <li><strong>Content</strong>: \"{quantity} {product}\"</li>\n  <li><strong>Receiver</strong>: Store that sent the CFP</li>\n  <li><strong>Next Step</strong>: Await store's accept-proposal or reject-proposal</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Log Acceptance</strong> (verbose): Print proposal details</li>\n  <li><strong>Construct Message</strong>: Create warehouse-accept with all metadata</li>\n  <li><strong>Send Proposal</strong>: Transmit to requesting store</li>\n  <li><strong>Create Listener</strong>: Initialize ReceiveConfirmationOrDenial behaviour</li>\n  <li><strong>Setup Template</strong>: Configure filter for this specific negotiation</li>\n  <li><strong>Register Listener</strong>: Add behaviour with template to agent</li>\n  <li><strong>Return</strong>: Don't block (listener runs independently)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"template-filtering\">Template Filtering:</h6>\n\n<blockquote>\n  <p>The template ensures the listener only receives messages for THIS\n  specific negotiation by matching:</p>\n  \n  <ul>\n  <li>warehouse_id: This warehouse's JID</li>\n  <li>store_id: The specific store's JID</li>\n  <li>request_id: This specific request's ID</li>\n  </ul>\n</blockquote>\n\n<p>Non-Blocking Design:\n    The commented-out <code>await confirm_deny_behav.join()</code> demonstrates\n    that we intentionally DON'T wait for confirmation here. This allows\n    the warehouse to accept multiple store requests concurrently.</p>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Sends SPADE message to store</li>\n  <li>Adds ReceiveConfirmationOrDenial behaviour to agent</li>\n  <li>Prints debug information if verbose enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes immediately after setting up the listener.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input: Request for \"50 electronics\" from store1\nActions:\n    1. Send warehouse-accept to store1\n    2. Setup listener with template matching:\n       - warehouse_id=warehouse1@localhost\n       - store_id=store1@localhost\n       - request_id=1001000000\n    3. Return (warehouse ready for next request)\nListener waits independently for store's decision\n</code></pre>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest", "kind": "class", "doc": "<p>Behaviour that sends proposal refusal to store (FIPA refuse).</p>\n\n<p>This behaviour implements the refusal response in the FIPA Contract Net Protocol\nwhere the warehouse, acting as a participant, declines to fulfill the store's\nrequest due to insufficient inventory or other constraints.</p>\n\n<p>FIPA Protocol Phase: <strong>Proposal Phase - Refusal</strong>\n    - Role: Participant (Warehouse declining Store's CFP)\n    - Sends: warehouse-reject (FIPA refuse)\n    - Purpose: \"I cannot fulfill your request\"\n    - Reason: Typically \"insufficient_stock\"\n    - Result: Store will try other warehouses</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique identifier for this request.</li>\n<li><strong>quant (int):</strong>  Requested quantity that cannot be fulfilled.</li>\n<li><strong>product (str):</strong>  Requested product that is unavailable/insufficient.</li>\n<li><strong>sender (str):</strong>  Store JID that initiated the request.</li>\n<li><strong>reason (str):</strong>  Rejection reason (default: \"insufficient_stock\").</li>\n</ul>\n\n<p>Message Format (warehouse-reject):\n    Metadata:\n        - performative: \"warehouse-reject\" (FIPA refuse)\n        - warehouse_id: This warehouse's JID\n        - store_id: Requesting store's JID\n        - node_id: Warehouse's graph location\n        - request_id: Original request identifier\n    Body:\n        - Format: \"{quantity} {product} {reason}\"\n        - Example: \"50 electronics insufficient_stock\"</p>\n\n<h6 id=\"common-rejection-reasons\">Common Rejection Reasons:</h6>\n\n<blockquote>\n  <ul>\n  <li>\"insufficient_stock\": Not enough product available</li>\n  <li>\"product_unavailable\": Product not carried by this warehouse</li>\n  <li>\"capacity_exceeded\": Order too large for capacity constraints</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Request: \"100 electronics\" (only 50 available)\nDecision: REJECT\nMessage Sent: warehouse-reject\n    Body: \"100 electronics insufficient_stock\"\nResult: Stock unchanged, store tries other warehouses\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Unlike AcceptBuyRequest, this behaviour does NOT set up any listeners\n  because no further interaction is expected after refusal.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.__init__", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.__init__", "kind": "function", "doc": "<p>Initialize the RejectBuyRequest behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The store-buy request message to reject.</li>\n<li><strong>reason (str, optional):</strong>  Reason for rejection. Defaults to \"insufficient_stock\".</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>, </span><span class=\"param\"><span class=\"n\">reason</span><span class=\"p\">:</span> <span class=\"nb\">str</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;insufficient_stock&#39;</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.request_id", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.quant", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.quant", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.product", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.sender", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.sender", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.reason", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.reason", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.RejectBuyRequest.run", "modulename": "warehouse", "qualname": "Warehouse.RejectBuyRequest.run", "kind": "function", "doc": "<p>Send warehouse-reject message to requesting store.</p>\n\n<h6 id=\"fipa-protocol-implementation\">FIPA Protocol Implementation:</h6>\n\n<blockquote>\n  <ul>\n  <li>Phase: Proposal Refusal</li>\n  <li>Performative: warehouse-reject (FIPA refuse)</li>\n  <li>Direction: Warehouse \u2192 Store</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Log Rejection</strong> (verbose): Print rejection details</li>\n  <li><strong>Construct Message</strong>: Create warehouse-reject with metadata</li>\n  <li><strong>Include Reason</strong>: Add rejection reason to message body</li>\n  <li><strong>Send Refusal</strong>: Transmit to requesting store</li>\n  <li><strong>Complete</strong>: No further interaction (one-shot behaviour)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>No stock changes (was never locked for insufficient stock)</li>\n  <li>No listeners created (conversation ends with refusal)</li>\n  <li>Store receives refusal and tries other warehouses</li>\n  <li>Prints debug information if verbose enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes immediately after sending message.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial", "kind": "class", "doc": "<p>Behaviour that processes store's award or rejection decision (FIPA result notification).</p>\n\n<p>This behaviour implements the result notification reception in the FIPA Contract Net\nProtocol where the warehouse, acting as a participant, receives the store's final\ndecision about whether its proposal was accepted or rejected.</p>\n\n<p>FIPA Protocol Phase: <strong>Result Notification Reception - Participant Role</strong>\n    - Role: Participant (Warehouse receiving Store's decision)\n    - Receives: store-confirm (FIPA accept-proposal) or store-deny (FIPA reject-proposal)\n    - Actions:\n        - If confirm: Transfer locked stock to pending deliveries, assign vehicle\n        - If deny: Release locked stock back to available inventory\n        - If timeout: Release locked stock (store chose another warehouse)</p>\n\n<h6 id=\"stock-state-transitions\">Stock State Transitions:</h6>\n\n<blockquote>\n  <p><strong>On store-confirm (Award)</strong>:\n      1. locked_stock[product] -= quantity (release lock)\n      2. current_capacity[product] += quantity (update capacity tracking)\n      3. Create Order object from message\n      4. pending_deliveries[order_id] = order (await vehicle pickup)\n      5. Launch AssignVehicle behaviour</p>\n  \n  <p><strong>On store-deny or timeout (Rejection/Timeout)</strong>:\n      1. locked_stock[product] -= quantity (release lock)\n      2. stock[product] += quantity (return to available)\n      3. No further action needed</p>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>accepted_id (int):</strong>  Request ID for which we sent proposal.</li>\n<li><strong>accepted_quantity (int):</strong>  Quantity that was proposed.</li>\n<li><strong>accepted_product (str):</strong>  Product that was proposed.</li>\n<li><strong>sender_jid (str):</strong>  Store JID that will send decision.</li>\n</ul>\n\n<h6 id=\"timeout-mechanism\">Timeout Mechanism:</h6>\n\n<blockquote>\n  <ul>\n  <li>Wait time: 10 seconds</li>\n  <li>Interpretation: Store chose another warehouse (implicit rejection)</li>\n  <li>Action: Unlock stock automatically</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n  <p><strong>Scenario 1: Store Confirms</strong></p>\n\n<pre><code>Proposed: 50 electronics\nMessage Received: store-confirm \"50 electronics\"\nActions:\n    - locked_stock[electronics]: 50 -&gt; 0\n    - pending_deliveries[1001000000] = Order(...)\n    - Launch AssignVehicle(1001000000)\n    - Print: \"Order 1001000000 confirmed...\"\n</code></pre>\n  \n  <p><strong>Scenario 2: Store Denies</strong></p>\n\n<pre><code>Proposed: 50 electronics\nMessage Received: store-deny \"50 electronics\"\nActions:\n    - locked_stock[electronics]: 50 -&gt; 0\n    - stock[electronics]: 50 -&gt; 100\n    - Print: \"Store chose another warehouse\"\n</code></pre>\n  \n  <p><strong>Scenario 3: Timeout</strong></p>\n\n<pre><code>Proposed: 50 electronics\nMessage Received: None (10 second timeout)\nActions:\n    - locked_stock[electronics]: 50 -&gt; 0\n    - stock[electronics]: 50 -&gt; 100\n    - Print: \"No confirmation received, unlocking stock\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This behaviour is automatically filtered by template to only receive\n  messages for the specific warehouse, store, and request_id combination.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial.__init__", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial.__init__", "kind": "function", "doc": "<p>Initialize the ReceiveConfirmationOrDenial behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>accept_msg (Message):</strong>  The warehouse-accept message we sent.\nUsed to extract proposal details for stock unlocking if needed.</li>\n<li><strong>sender_jid (str):</strong>  JID of the store that will send the decision.</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">accept_msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>, </span><span class=\"param\"><span class=\"n\">sender_jid</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial.accepted_id", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial.accepted_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial.accepted_quantity", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial.accepted_quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial.accepted_product", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial.accepted_product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial.sender_jid", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial.sender_jid", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveConfirmationOrDenial.run", "modulename": "warehouse", "qualname": "Warehouse.ReceiveConfirmationOrDenial.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.AssignVehicle", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle", "kind": "class", "doc": "<p>This behaviour is only executed once</p>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.AssignVehicle.__init__", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">request_id</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.AssignVehicle.request_id", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.AssignVehicle.populate_vehicles_from_contacts", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle.populate_vehicles_from_contacts", "kind": "function", "doc": "<p>Populate vehicles list from presence contacts if empty</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.AssignVehicle.create_presence_info_message", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle.create_presence_info_message", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">to</span></span><span class=\"return-annotation\">) -> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.AssignVehicle.create_call_for_proposal_message", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle.create_call_for_proposal_message", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">to</span></span><span class=\"return-annotation\">) -> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.AssignVehicle.run", "modulename": "warehouse", "qualname": "Warehouse.AssignVehicle.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ReceivePresenceInfo", "modulename": "warehouse", "qualname": "Warehouse.ReceivePresenceInfo", "kind": "class", "doc": "<p>Behaviour to receive presence information from vehicle agents.</p>\n\n<p>This behaviour requests and collects availability status from vehicle agents,\nwhich is used to determine which vehicles are available for delivery tasks.\nThe presence information indicates whether a vehicle is busy, available, or\nin another state.</p>\n\n<p>The behaviour waits for a single response from a vehicle agent containing\nits current presence status. This information is stored in the warehouse's\npresence_infos dictionary for later use in vehicle selection.</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive Message</strong>: Wait up to 10 seconds for presence response</li>\n  <li><strong>Parse JSON</strong>: Extract presence_show status from message body</li>\n  <li><strong>Store Information</strong>: Save presence info indexed by vehicle_id</li>\n  <li><strong>Handle Timeout</strong>: Print warning if no response received</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Updates agent.presence_infos dictionary with vehicle status</li>\n  <li>Prints presence information if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes after receiving one presence message or timing out.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Message Received:\n    Metadata: vehicle_id = \"vehicle1@localhost\"\n    Body: {\"presence_show\": \"available\"}\nProcessing:\n    - presence_infos[\"vehicle1@localhost\"] = \"available\"\nOutput:\n    - Print: \"Received presence info response from vehicle1: available\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The 10-second timeout prevents indefinite blocking if a vehicle agent\n  is offline or unresponsive.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.ReceivePresenceInfo.run", "modulename": "warehouse", "qualname": "Warehouse.ReceivePresenceInfo.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ReceiveVehicleProposals", "modulename": "warehouse", "qualname": "Warehouse.ReceiveVehicleProposals", "kind": "class", "doc": "<p>Cyclic behaviour that collects vehicle delivery proposals for orders.</p>\n\n<p>This behaviour implements the proposal collection phase of vehicle selection.\nAfter the warehouse sends delivery requests to vehicles, this behaviour\ncontinuously receives and stores vehicle proposals containing delivery capacity\nand estimated delivery time information.</p>\n\n<p>The behaviour runs in an infinite loop within each execution, collecting all\navailable proposals until a timeout occurs (no more proposals arriving). Each\nproposal is indexed by order_id and vehicle_jid for later evaluation.</p>\n\n<h6 id=\"proposal-data-structure\">Proposal Data Structure:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">vehicle_proposals</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">order_id</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;vehicle1@localhost&quot;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">can_fit</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"n\">delivery_time</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">),</span>\n        <span class=\"s2\">&quot;vehicle2@localhost&quot;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">can_fit</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"n\">delivery_time</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">),</span>\n        <span class=\"o\">...</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"message-format\">Message Format:</h6>\n\n<blockquote>\n  <p>Body (JSON):</p>\n  \n  <p><div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2001000000</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;can_fit&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;delivery_time&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">150</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div></p>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive Message</strong>: Wait up to 5 seconds for vehicle proposal</li>\n  <li><strong>Parse Proposal</strong>: Extract orderid, can_fit, delivery_time</li>\n  <li><strong>Initialize Storage</strong>: Create order_id entry if doesn't exist</li>\n  <li><strong>Store Proposal</strong>: Add vehicle proposal to vehicle_proposals dict</li>\n  <li><strong>Continue Loop</strong>: Repeat until timeout (no more proposals)</li>\n  <li><strong>Exit</strong>: Break loop when timeout indicates all proposals received</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Updates agent.vehicle_proposals dictionary with new proposals</li>\n  <li>Prints proposal details if verbose mode enabled</li>\n  <li>Breaks loop after 5-second timeout</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Exits after collecting all available proposals.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Loop Iteration 1:\n    - Receive from vehicle1: can_fit=True, time=120\n    - Store: vehicle_proposals[2001000000][\"vehicle1\"] = (True, 120)\nLoop Iteration 2:\n    - Receive from vehicle2: can_fit=False, time=180\n    - Store: vehicle_proposals[2001000000][\"vehicle2\"] = (False, 180)\nLoop Iteration 3:\n    - Timeout after 5 seconds\n    - Break loop, all proposals collected\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The 5-second timeout is optimized to collect multiple proposals quickly\n  while not waiting too long for vehicles that won't respond.</p>\n</blockquote>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "warehouse.Warehouse.ReceiveVehicleProposals.run", "modulename": "warehouse", "qualname": "Warehouse.ReceiveVehicleProposals.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ChooseBestVehicle", "modulename": "warehouse", "qualname": "Warehouse.ChooseBestVehicle", "kind": "class", "doc": "<p>Behaviour that evaluates vehicle proposals and selects the optimal vehicle for delivery.</p>\n\n<p>This behaviour implements the proposal evaluation and winner selection phase of\nvehicle assignment. After collecting all vehicle proposals via ReceiveVehicleProposals,\nthis behaviour compares them based on capacity and delivery time, then notifies\nthe selected vehicle and rejects all others.</p>\n\n<h6 id=\"selection-algorithm\">Selection Algorithm:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Priority 1</strong>: Filter vehicles that can fit the order (can_fit=True)</li>\n  <li><strong>Priority 2</strong>: Among fitting vehicles, select one with minimum delivery_time</li>\n  <li><strong>Fallback</strong>: If no vehicles can fit, select vehicle with minimum delivery_time anyway</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique order identifier to find proposals.</li>\n<li><strong>n_sent_messages (int):</strong>  Expected number of vehicle responses to wait for.</li>\n</ul>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Wait for Proposals</strong>: Loop until n_sent_messages proposals received</li>\n  <li><strong>Evaluate Proposals</strong>: Call get_best_vehicle() to select winner</li>\n  <li><strong>Send Confirmation</strong>: Notify selected vehicle with order-confirmation</li>\n  <li><strong>Send Rejections</strong>: Notify all other vehicles they were not selected</li>\n  </ol>\n</blockquote>\n\n<p>Message Format (Confirmation):\n    Metadata:\n        - performative: \"order-confirmation\"\n    Body (JSON):</p>\n\n<pre><code>    <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2001000000</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;confirmed&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div>\n</code></pre>\n\n<p>Message Format (Rejection):\n    Metadata:\n        - performative: \"order-confirmation\"\n    Body (JSON):</p>\n\n<pre><code>    <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2001000000</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;confirmed&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div>\n</code></pre>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Reads from agent.vehicle_proposals dictionary</li>\n  <li>Reads from agent.pending_deliveries for Order object</li>\n  <li>Sends confirmation message to selected vehicle</li>\n  <li>Sends rejection messages to non-selected vehicles</li>\n  <li>Prints selection decision if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes after sending all confirmation/rejection messages.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Proposals Received:\n    - vehicle1: (can_fit=True, time=120)\n    - vehicle2: (can_fit=True, time=150)\n    - vehicle3: (can_fit=False, time=100)\n\nEvaluation:\n    - Filter: vehicle1, vehicle2 (can fit)\n    - Compare times: 120 &lt; 150\n    - Winner: vehicle1\n\nActions:\n    - Send confirmation to vehicle1 (confirmed=true)\n    - Send rejection to vehicle2 (confirmed=false)\n    - Send rejection to vehicle3 (confirmed=false)\n\nOutput:\n    - Print: \"Best vehicle selected: vehicle1@localhost\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The behaviour waits actively (1-second sleep intervals) until all expected\n  proposals arrive before making a decision. This ensures fair comparison\n  of all available vehicles.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.ChooseBestVehicle.__init__", "modulename": "warehouse", "qualname": "Warehouse.ChooseBestVehicle.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">request_id</span>, </span><span class=\"param\"><span class=\"n\">n_sent_messages</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.ChooseBestVehicle.request_id", "modulename": "warehouse", "qualname": "Warehouse.ChooseBestVehicle.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ChooseBestVehicle.n_sent_messages", "modulename": "warehouse", "qualname": "Warehouse.ChooseBestVehicle.n_sent_messages", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ChooseBestVehicle.get_best_vehicle", "modulename": "warehouse", "qualname": "Warehouse.ChooseBestVehicle.get_best_vehicle", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">proposals</span><span class=\"p\">:</span> <span class=\"nb\">dict</span></span><span class=\"return-annotation\">) -> <span class=\"nb\">str</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.ChooseBestVehicle.run", "modulename": "warehouse", "qualname": "Warehouse.ChooseBestVehicle.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.BuyMaterial", "modulename": "warehouse", "qualname": "Warehouse.BuyMaterial", "kind": "class", "doc": "<p>Behaviour that initiates material purchase from suppliers (FIPA CFP - Initiator Role).</p>\n\n<p>This behaviour implements the FIPA Contract Net Protocol with the warehouse acting\nas the INITIATOR role. The warehouse broadcasts a Call For Proposals (CFP) to\nsuppliers to replenish inventory. This is the dual role mentioned in the class\ndocstring - the warehouse is a participant when dealing with stores but becomes\nan initiator when dealing with suppliers.</p>\n\n<p>FIPA Protocol: <strong>Contract Net - Initiator Role</strong>\n    - Role: Initiator (Warehouse requesting materials from Suppliers)\n    - Sends: warehouse-buy (FIPA CFP) with quantity and product\n    - Receives: supplier-accept (FIPA propose) or supplier-reject (FIPA refuse)\n    - Selection: Choose best supplier based on price and availability\n    - Award: Send warehouse-confirm (FIPA accept-proposal) to winner</p>\n\n<h6 id=\"dual-fipa-role-context\">Dual FIPA Role Context:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>As Participant</strong> (Store \u2194 Warehouse): Warehouse responds to store CFPs</li>\n  <li><strong>As Initiator</strong> (Warehouse \u2194 Supplier): Warehouse sends CFPs to suppliers</li>\n  </ul>\n  \n  <p>This dual role makes the warehouse a critical intermediary in the supply chain,\n  translating downstream demand into upstream procurement.</p>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>quantity (int):</strong>  Amount of material to purchase from suppliers.</li>\n<li><strong>product (str):</strong>  Type of material/product needed for restocking.</li>\n</ul>\n\n<p>Message Format (warehouse-buy):\n    Metadata:\n        - performative: \"warehouse-buy\" (FIPA CFP)\n        - warehouse_id: This warehouse's JID\n        - request_id: Unique request identifier (ID encoding)\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"100 raw_materials\"</p>\n\n<h6 id=\"id-encoding-for-request\">ID Encoding for Request:</h6>\n\n<blockquote>\n  <p>Uses the warehouse's ID encoding scheme:</p>\n  \n  <ul>\n  <li>request_id = warehouse.id_base + warehouse.request_counter</li>\n  <li>Format: 1 (warehouse type) * 100_000_000 + instance * 1_000_000 + counter</li>\n  <li>Example: 101000000 (warehouse 1, request 0)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Populate Suppliers</strong>: Auto-discover suppliers from presence contacts</li>\n  <li><strong>Generate Request ID</strong>: Create unique ID for this procurement</li>\n  <li><strong>Broadcast CFP</strong>: Send warehouse-buy to all available suppliers</li>\n  <li><strong>Set Metadata</strong>: Store request for retry mechanism (current_buy_request)</li>\n  <li><strong>Launch Coordinator</strong>: Start CollectSupplierResponses to gather proposals</li>\n  <li><strong>Non-blocking</strong>: Return immediately (coordinator handles responses)</li>\n  </ol>\n</blockquote>\n\n<p>Coordinator/Worker Pattern:\n    - <strong>Initiator (this)</strong>: Sends CFP and launches coordinator\n    - <strong>Coordinator</strong>: CollectSupplierResponses (manages collection process)\n    - <strong>Worker</strong>: ReceiveAllSupplierResponses (collects individual proposals)\n    - <strong>Decision</strong>: SendWarehouseConfirmation (award) or SendWarehouseDenial (reject)</p>\n\n<h6 id=\"supplier-discovery\">Supplier Discovery:</h6>\n\n<blockquote>\n  <p>Automatically populates supplier list from presence contacts:</p>\n  \n  <ul>\n  <li>Filters contacts for JIDs containing \"supplier\"</li>\n  <li>Updates agent.suppliers list if empty</li>\n  <li>Requires presence subscription to be active</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n  <p><strong>Scenario 1: Normal Procurement</strong></p>\n\n<pre><code>Trigger: stock[electronics] &lt; restock_threshold\nRequest: BuyMaterial(100, \"electronics\")\n\nStep 1: Populate suppliers\n    Discovered: [supplier1@localhost, supplier2@localhost]\n\nStep 2: Generate ID\n    request_id: 101000000\n\nStep 3: Broadcast CFP\n    To: supplier1, supplier2\n    Message: warehouse-buy \"100 electronics\"\n\nStep 4: Launch coordinator\n    CollectSupplierResponses(101000000, 100, \"electronics\")\n    Coordinator launches ReceiveAllSupplierResponses worker\n\nStep 5: Wait for proposals (handled by coordinator)\n</code></pre>\n  \n  <p><strong>Scenario 2: No Suppliers Available</strong></p>\n\n<pre><code>Request: BuyMaterial(100, \"electronics\")\nSuppliers: [] (empty list, none in presence)\n\nResult: ERROR logged, no messages sent\nAction: Retry later when suppliers available\n</code></pre>\n</blockquote>\n\n<h6 id=\"retry-mechanism\">Retry Mechanism:</h6>\n\n<blockquote>\n  <p>Sets agent.current_buy_request with:</p>\n  \n  <ul>\n  <li>quantity: Amount requested</li>\n  <li>product: Product type</li>\n  <li>request_id: Request identifier</li>\n  </ul>\n  \n  <p>Used by RetryPreviousBuy if procurement fails.</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This behaviour implements the same FIPA protocol that stores use when\n  buying from warehouses, but with reversed roles. The message format and\n  workflow mirror the store-warehouse interaction.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.BuyMaterial.__init__", "modulename": "warehouse", "qualname": "Warehouse.BuyMaterial.__init__", "kind": "function", "doc": "<p>Initialize the BuyMaterial behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>quantity (int):</strong>  Amount of material to purchase.</li>\n<li><strong>product (str):</strong>  Type of material/product to procure.</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">quantity</span>, </span><span class=\"param\"><span class=\"n\">product</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.BuyMaterial.quantity", "modulename": "warehouse", "qualname": "Warehouse.BuyMaterial.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.BuyMaterial.product", "modulename": "warehouse", "qualname": "Warehouse.BuyMaterial.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.BuyMaterial.populate_suppliers_from_contacts", "modulename": "warehouse", "qualname": "Warehouse.BuyMaterial.populate_suppliers_from_contacts", "kind": "function", "doc": "<p>Populate suppliers list from presence contacts if empty</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.BuyMaterial.run", "modulename": "warehouse", "qualname": "Warehouse.BuyMaterial.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses", "kind": "class", "doc": "<p>Coordinator behaviour that manages supplier proposal collection and evaluation.</p>\n\n<p>Launches ReceiveAllSupplierResponses worker to collect proposals from all suppliers,\nthen evaluates responses and selects the best supplier based on delivery time.\nSends confirmation to winner and denials to others. Implements FIPA initiator role.</p>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.__init__", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>,</span><span class=\"param\">\t<span class=\"n\">request_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">num_suppliers</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">quantity</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">product</span><span class=\"p\">:</span> <span class=\"nb\">str</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.request_id", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.buy_msg", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.buy_msg", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.num_suppliers", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.num_suppliers", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.quantity", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.product", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.acceptances", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.acceptances", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.rejections", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.rejections", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.CollectSupplierResponses.run", "modulename": "warehouse", "qualname": "Warehouse.CollectSupplierResponses.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses", "kind": "class", "doc": "<p>Worker behaviour that collects supplier-accept and supplier-reject responses.</p>\n\n<p>Waits for responses from all suppliers (with timeout), categorizing them into\nacceptances and rejections lists shared with CollectSupplierResponses coordinator.</p>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.__init__", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">request_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">num_suppliers</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">acceptances</span><span class=\"p\">:</span> <span class=\"nb\">list</span>,</span><span class=\"param\">\t<span class=\"n\">rejections</span><span class=\"p\">:</span> <span class=\"nb\">list</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.request_id", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.num_suppliers", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.num_suppliers", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.acceptances", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.acceptances", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.rejections", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.rejections", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.responses_received", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.responses_received", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.timeout", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.timeout", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.ReceiveAllSupplierResponses.run", "modulename": "warehouse", "qualname": "Warehouse.ReceiveAllSupplierResponses.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation", "kind": "class", "doc": "<p>Sends warehouse-confirm (FIPA accept-proposal) to selected supplier.</p>\n\n<p>Awards the contract to the best supplier, updates stock immediately,\nand notifies the supplier that their proposal was accepted.</p>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation.__init__", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation.dest", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation.dest", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation.request_id", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation.quantity", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation.product", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseConfirmation.run", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseConfirmation.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial", "kind": "class", "doc": "<p>Sends warehouse-deny (FIPA reject-proposal) to non-selected suppliers.</p>\n\n<p>Notifies suppliers that their proposal was not accepted, allowing them\nto release any resources they may have reserved.</p>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial.__init__", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span>)</span>"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial.dest", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial.dest", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial.request_id", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial.quantity", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial.quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial.product", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.SendWarehouseDenial.run", "modulename": "warehouse", "qualname": "Warehouse.SendWarehouseDenial.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.RetryPreviousBuy", "modulename": "warehouse", "qualname": "Warehouse.RetryPreviousBuy", "kind": "class", "doc": "<p>Retries failed supplier purchase requests from the failed_requests queue.</p>\n\n<p>Dequeues one failed request and re-initiates the FIPA Contract Net Protocol\nwith suppliers, reusing the same request_id for traceability.</p>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "warehouse.Warehouse.RetryPreviousBuy.run", "modulename": "warehouse", "qualname": "Warehouse.RetryPreviousBuy.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.HandleResupply", "modulename": "warehouse", "qualname": "Warehouse.HandleResupply", "kind": "class", "doc": "<p>Periodic behaviour that monitors stock levels and triggers restocking.</p>\n\n<p>Checks each product's stock against WAREHOUSE_RESUPPLY_THRESHOLD and\nlaunches BuyMaterial behaviour when inventory falls below threshold.</p>\n", "bases": "spade.behaviour.PeriodicBehaviour"}, {"fullname": "warehouse.Warehouse.HandleResupply.run", "modulename": "warehouse", "qualname": "Warehouse.HandleResupply.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ReceiveVehicleArrival", "modulename": "warehouse", "qualname": "Warehouse.ReceiveVehicleArrival", "kind": "class", "doc": "<p>Cyclic behaviour that processes vehicle pickup and delivery notifications.</p>\n\n<p>Handles vehicle-pickup messages (vehicle collects order from warehouse) and\nvehicle-delivery messages (vehicle delivers supplies from supplier), updating\npending_deliveries and stock accordingly.</p>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "warehouse.Warehouse.ReceiveVehicleArrival.run", "modulename": "warehouse", "qualname": "Warehouse.ReceiveVehicleArrival.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.ReceiveTimeDelta", "modulename": "warehouse", "qualname": "Warehouse.ReceiveTimeDelta", "kind": "class", "doc": "<p>Cyclic behaviour that synchronizes simulation time and applies traffic updates.</p>\n\n<p>Receives time delta messages from world agent, updates current_tick, and\napplies dynamic graph edge weight changes for traffic simulation.</p>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "warehouse.Warehouse.ReceiveTimeDelta.run", "modulename": "warehouse", "qualname": "Warehouse.ReceiveTimeDelta.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "warehouse.Warehouse.calculate_supplier_score", "modulename": "warehouse", "qualname": "Warehouse.calculate_supplier_score", "kind": "function", "doc": "<p>Calculate supplier score based on delivery time (used in FIPA supplier selection).</p>\n\n<p>This function evaluates supplier proposals in the FIPA Contract Net Protocol\nby computing the estimated delivery time from supplier to warehouse using\nDijkstra's algorithm on the world graph. Lower scores indicate faster delivery.</p>\n\n<h6 id=\"fipa-protocol-context\">FIPA Protocol Context:</h6>\n\n<blockquote>\n  <ul>\n  <li>Phase: Proposal Evaluation (Initiator evaluating participants)</li>\n  <li>Used by: CollectSupplierResponses and ReceiveAllSupplierResponses</li>\n  <li>Purpose: Select best supplier from multiple proposals</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"scoring-algorithm\">Scoring Algorithm:</h6>\n\n<blockquote>\n  <ol>\n  <li>Extract supplier's node_id from message metadata</li>\n  <li>Run Dijkstra's algorithm: supplier_node \u2192 warehouse_node</li>\n  <li>Return estimated travel time as score</li>\n  <li>Lower score = shorter delivery time = better supplier</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>accept_msg (Message):</strong>  supplier-accept message containing:\n<ul>\n<li>Metadata: \"node_id\" (supplier's graph location)</li>\n<li>Body: \"{quantity} {product}\"</li>\n</ul></li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>float: Estimated delivery time (seconds). Lower is better.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Warehouse at node 10\nSupplier1 at node 5: delivery_time = 120s\nSupplier2 at node 8: delivery_time = 85s\n\ncalculate_supplier_score(supplier1_msg) \u2192 120.0\ncalculate_supplier_score(supplier2_msg) \u2192 85.0\n\nWinner: Supplier2 (lower score)\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Currently uses time as the scoring metric. Could be extended to use\n  fuel cost or a weighted combination of multiple factors.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">accept_msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">) -> <span class=\"nb\">float</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.message_to_order", "modulename": "warehouse", "qualname": "Warehouse.message_to_order", "kind": "function", "doc": "<p>Convert store-confirm message to Order object for delivery tracking.</p>\n\n<p>This helper function transforms a FIPA accept-proposal message from a store\ninto a structured Order object that can be stored in pending_deliveries\nand assigned to vehicles for transportation.</p>\n\n<h6 id=\"fipa-protocol-context\">FIPA Protocol Context:</h6>\n\n<blockquote>\n  <ul>\n  <li>Triggered by: store-confirm message (FIPA accept-proposal)</li>\n  <li>Used by: ReceiveConfirmationOrDenial behaviour</li>\n  <li>Purpose: Create deliverable order from confirmed proposal</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"message-parsing\">Message Parsing:</h6>\n\n<blockquote>\n  <p>Body Format: \"{quantity} {product}\"\n  Example: \"50 electronics\"</p>\n  \n  <p>Metadata Extracted:\n      - request_id: Unique order identifier\n      - node_id: Store's graph location (delivery destination)</p>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  store-confirm message with:\n<ul>\n<li>Body: \"{quantity} {product}\"</li>\n<li>Metadata: request_id, node_id</li>\n<li>Sender: Store JID</li>\n</ul></li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Order: Structured order object with:\n      - product: Product type\n      - quantity: Amount to deliver\n      - orderid: Unique identifier\n      - sender: Store JID (delivery destination)\n      - receiver: Warehouse JID (pickup location)\n      - sender_location: Store's graph node\n      - receiver_location: Warehouse's graph node</p>\n</blockquote>\n\n<h6 id=\"order-object-structure\">Order Object Structure:</h6>\n\n<blockquote>\n  <p>The Order uses inverted semantics for delivery context:</p>\n  \n  <ul>\n  <li>sender = Store (WHERE to deliver)</li>\n  <li>receiver = Warehouse (WHERE to pickup)</li>\n  <li>sender_location = Store node (delivery destination)</li>\n  <li>receiver_location = Warehouse node (pickup origin)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input Message (store-confirm):\n    Body: \"50 electronics\"\n    Metadata:\n        - request_id: \"201000000\"\n        - node_id: \"15\"\n    Sender: \"store1@localhost\"\n\nWarehouse: \"warehouse1@localhost\" at node 10\n\nOutput Order:\n    product: \"electronics\"\n    quantity: 50\n    orderid: 201000000\n    sender: \"store1@localhost\"\n    receiver: \"warehouse1@localhost\"\n    sender_location: 15 (store node)\n    receiver_location: 10 (warehouse node)\n</code></pre>\n</blockquote>\n\n<h6 id=\"integration\">Integration:</h6>\n\n<blockquote>\n  <p>Created Order is added to self.pending_deliveries[order_id]\n  and passed to AssignVehicle behaviour for transportation.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">) -> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.set_buy_metadata", "modulename": "warehouse", "qualname": "Warehouse.set_buy_metadata", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.update_graph", "modulename": "warehouse", "qualname": "Warehouse.update_graph", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">traffic_data</span></span><span class=\"return-annotation\">) -> <span class=\"kc\">None</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.print_stock", "modulename": "warehouse", "qualname": "Warehouse.print_stock", "kind": "function", "doc": "<p>Print comprehensive warehouse inventory status (debugging utility).</p>\n\n<p>Displays the three-tier stock management system:</p>\n\n<ol>\n<li><strong>Unlocked Stock</strong>: Available for new orders</li>\n<li><strong>Locked Stock</strong>: Reserved during FIPA negotiations</li>\n<li><strong>Pending Orders</strong>: Confirmed deliveries awaiting vehicle pickup</li>\n</ol>\n\n<h6 id=\"output-format\">Output Format:</h6>\n\n<blockquote>\n  <p>==============================\n  Current warehouse1@localhost UNLOCKED stock:\n  electronics: 75/150\n  textiles: 120/150</p>\n  \n  <h2 id=\"food-40150\">food: 40/150</h2>\n  \n  <p>Current warehouse1@localhost LOCKED stock:\n  electronics: 25/100</p>\n  \n  <h2 id=\"textiles-0120\">textiles: 0/120</h2>\n  \n  <p>Current warehouse1@localhost PENDING ORDERS:\n  Order 201000000: 25xelectronics from store1@localhost to warehouse1@localhost</p>\n  \n  <h1 id=\"order-201000001-50xtextiles-from-store2localhost-to-warehouse1localhost\">Order 201000001: 50xtextiles from store2@localhost to warehouse1@localhost</h1>\n</blockquote>\n\n<h6 id=\"stock-interpretation\">Stock Interpretation:</h6>\n\n<blockquote>\n  <ul>\n  <li>Unlocked: X/MAX_CAPACITY</li>\n  <li>Locked: X/Total_Available (stock + locked)</li>\n  <li>Pending: Formatted as \"{order_id}: {quantity}x{product} from {sender} to {receiver}\"</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"use-cases\">Use Cases:</h6>\n\n<blockquote>\n  <ul>\n  <li>Debugging stock state transitions</li>\n  <li>Verifying FIPA protocol effects on inventory</li>\n  <li>Monitoring pending delivery queue</li>\n  <li>Tracking resource availability</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-usage\">Example Usage:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"c1\"># After accepting store request</span>\n<span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">locked_stock</span><span class=\"p\">[</span><span class=\"n\">product</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">50</span>\n<span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">print_stock</span><span class=\"p\">()</span>  <span class=\"c1\"># Shows locked stock increased</span>\n\n<span class=\"c1\"># After store confirmation</span>\n<span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">pending_deliveries</span><span class=\"p\">[</span><span class=\"n\">order_id</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">order</span>\n<span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">print_stock</span><span class=\"p\">()</span>  <span class=\"c1\"># Shows new pending order</span>\n\n<span class=\"c1\"># After vehicle pickup</span>\n<span class=\"k\">del</span> <span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">pending_deliveries</span><span class=\"p\">[</span><span class=\"n\">order_id</span><span class=\"p\">]</span>\n<span class=\"n\">warehouse</span><span class=\"o\">.</span><span class=\"n\">print_stock</span><span class=\"p\">()</span>  <span class=\"c1\"># Shows order removed</span>\n</code></pre>\n  </div>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.dict_to_order", "modulename": "warehouse", "qualname": "Warehouse.dict_to_order", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">data</span><span class=\"p\">:</span> <span class=\"nb\">dict</span></span><span class=\"return-annotation\">) -> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>:</span></span>", "funcdef": "def"}, {"fullname": "warehouse.Warehouse.node_id", "modulename": "warehouse", "qualname": "Warehouse.node_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.map", "modulename": "warehouse", "qualname": "Warehouse.map", "kind": "variable", "doc": "<p></p>\n", "annotation": ": world.graph.Graph"}, {"fullname": "warehouse.Warehouse.contact_list", "modulename": "warehouse", "qualname": "Warehouse.contact_list", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.verbose", "modulename": "warehouse", "qualname": "Warehouse.verbose", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.id_base", "modulename": "warehouse", "qualname": "Warehouse.id_base", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.pending_deliveries", "modulename": "warehouse", "qualname": "Warehouse.pending_deliveries", "kind": "variable", "doc": "<p></p>\n", "annotation": ": dict[int, veiculos.veiculos.Order]"}, {"fullname": "warehouse.Warehouse.vehicle_proposals", "modulename": "warehouse", "qualname": "Warehouse.vehicle_proposals", "kind": "variable", "doc": "<p></p>\n", "annotation": ": dict[int, dict[str, tuple[bool]]]"}, {"fullname": "warehouse.Warehouse.vehicles", "modulename": "warehouse", "qualname": "Warehouse.vehicles", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.suppliers", "modulename": "warehouse", "qualname": "Warehouse.suppliers", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "warehouse.Warehouse.request_counter", "modulename": "warehouse", "qualname": "Warehouse.request_counter", "kind": "variable", "doc": "<p></p>\n", "annotation": ": int"}, {"fullname": "warehouse.Warehouse.setup", "modulename": "warehouse", "qualname": "Warehouse.setup", "kind": "function", "doc": "<p>Configure warehouse state and register all FIPA protocol behaviours.</p>\n\n<p>This method is automatically called by SPADE after the agent successfully\nconnects to the XMPP server. It initializes the warehouse's operational\nstate and registers all cyclic and periodic behaviours needed for the\ndual FIPA Contract Net Protocol implementation.</p>\n\n<h6 id=\"setup-process\">Setup Process:</h6>\n\n<blockquote>\n  <p><strong>Phase 1: Presence Management</strong>\n      - Enable auto-approval of presence subscriptions\n      - Subscribe to all contacts (stores, suppliers, vehicles)\n      - Enables presence-based availability checking</p>\n  \n  <p><strong>Phase 2: Stock Initialization</strong>\n      - Randomize initial stock for each product\n      - Range: [WAREHOUSE_RESUPPLY_THRESHOLD+1, WAREHOUSE_MAX_PRODUCT_CAPACITY]\n      - Calculate current_capacity per product\n      - Initialize locked_stock dictionary (empty)</p>\n  \n  <p><strong>Phase 3: State Initialization</strong>\n      - current_tick: Simulation time (starts at 0)\n      - presence_infos: Vehicle availability cache\n      - current_buy_request: Last supplier purchase request\n      - failed_requests: Queue for retry mechanism</p>\n  \n  <p><strong>Phase 4: Contact Discovery</strong>\n      - Parse presence.contacts to identify vehicles and suppliers\n      - Filter by JID string matching (\"vehicle\", \"supplier\")\n      - Populate vehicles and suppliers lists</p>\n  \n  <p><strong>Phase 5: Behaviour Registration</strong>\n      1. ReceiveBuyRequest (Store Interaction - FIPA Participant)\n      2. HandleResupply (Inventory Management - Triggers FIPA Initiator)\n      3. ReceiveVehicleArrival (Logistics Coordination)\n      4. ReceiveTimeDelta (Time Synchronization)</p>\n</blockquote>\n\n<h6 id=\"behaviour-registration-details\">Behaviour Registration Details:</h6>\n\n<blockquote>\n  <p><strong>ReceiveBuyRequest</strong> (CyclicBehaviour):\n      - Template: performative = \"store-buy\"\n      - Purpose: Listen for store purchase requests (FIPA CFP)\n      - Role: FIPA Participant (responds to stores)</p>\n  \n  <p><strong>HandleResupply</strong> (PeriodicBehaviour):\n      - Period: 5 seconds\n      - Purpose: Monitor stock levels and trigger restocking\n      - Role: Launches BuyMaterial (FIPA Initiator with suppliers)</p>\n  \n  <p><strong>ReceiveVehicleArrival</strong> (CyclicBehaviour):\n      - Template: performative = \"vehicle-pickup\" OR \"vehicle-delivery\"\n      - Purpose: Handle vehicle logistics notifications\n      - Actions:\n          - vehicle-pickup: Remove order from pending_deliveries\n          - vehicle-delivery: Add delivered materials to stock</p>\n  \n  <p><strong>ReceiveTimeDelta</strong> (CyclicBehaviour):\n      - Template: performative = \"time-delta\"\n      - Purpose: Synchronize simulation time with world agent\n      - Actions: Update current_tick, apply traffic conditions</p>\n</blockquote>\n\n<h6 id=\"stock-initialization-example\">Stock Initialization Example:</h6>\n\n<blockquote>\n<pre><code>Products: [electronics, textiles, food]\nWAREHOUSE_MAX_PRODUCT_CAPACITY: 150\nWAREHOUSE_RESUPPLY_THRESHOLD: 30\n\nInitial Stock (randomized):\n    electronics: 87  (available)\n    textiles:    45  (available)\n    food:        120 (available)\n\nCurrent Capacity (calculated):\n    electronics: 150 - 87 = 63\n    textiles:    150 - 45 = 105\n    food:        150 - 120 = 30\n\nLocked Stock (initialized empty):\n    electronics: 0\n    textiles:    0\n    food:        0\n</code></pre>\n</blockquote>\n\n<h6 id=\"presence-subscription-example\">Presence Subscription Example:</h6>\n\n<blockquote>\n<pre><code>contact_list: [\n    \"store1@localhost\",\n    \"store2@localhost\",\n    \"supplier1@localhost\",\n    \"vehicle1@localhost\",\n    \"vehicle2@localhost\"\n]\n\nActions:\n    1. Subscribe to all 5 contacts\n    2. Parse contacts for types:\n       - vehicles: [\"vehicle1@localhost\", \"vehicle2@localhost\"]\n       - suppliers: [\"supplier1@localhost\"]\n    3. Stores automatically discovered via presence system\n</code></pre>\n</blockquote>\n\n<h6 id=\"template-configuration\">Template Configuration:</h6>\n\n<blockquote>\n  <p>Templates use metadata filtering to route messages to correct behaviours:</p>\n  \n  <ul>\n  <li>ReceiveBuyRequest: performative=\"store-buy\"</li>\n  <li>ReceiveVehicleArrival: performative in [\"vehicle-pickup\", \"vehicle-delivery\"]</li>\n  <li>ReceiveTimeDelta: performative=\"time-delta\"</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Prints initial stock levels if verbose=True</li>\n  <li>Begins listening for store requests immediately</li>\n  <li>Starts periodic inventory monitoring</li>\n  <li>Enables vehicle coordination capability</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method must complete before the warehouse can participate in any\n  FIPA protocol interactions. All behaviours are registered but don't\n  execute until the main agent event loop processes them.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier", "modulename": "supplier", "kind": "module", "doc": "<p>Supplier Agent Module for Supply Chain Optimization System.</p>\n\n<p>This module implements the Supplier agent, which provides infinite inventory to warehouses\nin the supply chain. The Supplier serves as the ultimate source of materials, responding\nto warehouse purchase requests and coordinating vehicle delivery logistics.</p>\n\n<p>The module implements the FIPA Contract Net Protocol as a <strong>Participant</strong> role:</p>\n\n<ul>\n<li><strong>Responds</strong> to warehouse purchase requests (warehouse-buy CFP)</li>\n<li><strong>Proposes</strong> materials (supplier-accept)</li>\n<li><strong>Receives awards</strong> (warehouse-confirm) or rejections (warehouse-deny)</li>\n<li><strong>Coordinates vehicles</strong> for delivery to warehouses</li>\n</ul>\n\n<h6 id=\"key-features\">Key Features:</h6>\n\n<blockquote>\n  <ul>\n  <li>Infinite stock of all products (never runs out)</li>\n  <li>Concurrent request handling from multiple warehouses</li>\n  <li>Vehicle coordination for material delivery</li>\n  <li>Order tracking through pending_deliveries system</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"typical-usage-example\">Typical usage example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">world.graph</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Graph</span>\n\n<span class=\"c1\"># Initialize graph and supplier agent</span>\n<span class=\"n\">map_graph</span> <span class=\"o\">=</span> <span class=\"n\">Graph</span><span class=\"p\">()</span>\n<span class=\"n\">supplier</span> <span class=\"o\">=</span> <span class=\"n\">Supplier</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;supplier1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;supplier_password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">map_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;vehicle1@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"k\">await</span> <span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</code></pre>\n  </div>\n</blockquote>\n"}, {"fullname": "supplier.Supplier", "modulename": "supplier", "qualname": "Supplier", "kind": "class", "doc": "<p>Supplier Agent for Supply Chain Management System.</p>\n\n<p>The Supplier agent acts as the ultimate source of materials in the supply chain,\nproviding infinite inventory to warehouses. It implements the FIPA Contract Net\nProtocol as a <strong>Participant</strong>, responding to warehouse requests and coordinating\nvehicle deliveries.</p>\n\n<p>FIPA Contract Net Protocol - Participant Role Implementation:</p>\n\n<p><strong>As Participant (with Warehouses)</strong>:\n    - <strong>Proposal Phase</strong>: Receives warehouse-buy CFP from warehouses\n    - <strong>Proposal Submission</strong>: Always sends supplier-accept (has infinite stock)\n    - <strong>Result Reception</strong>: Receives warehouse-confirm (accept-proposal) or warehouse-deny (reject-proposal)\n    - <strong>Execution</strong>: Coordinates vehicle delivery for confirmed orders</p>\n\n<h6 id=\"infinite-stock-model\">Infinite Stock Model:</h6>\n\n<blockquote>\n  <p>Unlike Store and Warehouse agents, the Supplier has unlimited inventory:</p>\n  \n  <ul>\n  <li>Never rejects requests due to insufficient stock</li>\n  <li>Always responds with supplier-accept (FIPA propose)</li>\n  <li>Tracks total supplied quantities for statistics only</li>\n  <li>No stock locking or capacity constraints</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"order-lifecycle\">Order Lifecycle:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Request Reception</strong>: Warehouse sends warehouse-buy (FIPA CFP)</li>\n  <li><strong>Automatic Acceptance</strong>: Supplier sends supplier-accept (FIPA propose)</li>\n  <li><strong>Awaiting Award</strong>: Wait for warehouse decision (10 second timeout)</li>\n  <li><strong>Confirmation</strong>: Warehouse sends warehouse-confirm (FIPA accept-proposal)</li>\n  <li><strong>Vehicle Assignment</strong>: Launch AssignVehicle to coordinate delivery</li>\n  <li><strong>Delivery Tracking</strong>: Order added to pending_deliveries</li>\n  <li><strong>Pickup</strong>: Vehicle picks up materials from supplier</li>\n  <li><strong>Completion</strong>: Order removed from pending_deliveries</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"id-encoding-system\">ID Encoding System:</h6>\n\n<blockquote>\n  <p>Uses hierarchical encoding for generating unique request identifiers:</p>\n  \n  <ul>\n  <li>Formula: <code>agent_type * 100_000_000 + instance_id * 1_000_000 + request_counter</code></li>\n  <li>Agent type code for Supplier: 3</li>\n  <li>Example: supplier1's base ID = 3_001_000_000</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>jid (str):</strong>  Jabber ID of the supplier agent (e.g., \"supplier1@localhost\").</li>\n<li><strong>node_id (int):</strong>  Graph node ID representing the supplier's physical location.</li>\n<li><strong>map (Graph):</strong>  Reference to the world graph for pathfinding calculations.</li>\n<li><strong>contact_list (list[str]):</strong>  JIDs for warehouses and vehicles.</li>\n<li><strong>verbose (bool):</strong>  Flag to control debug output verbosity.</li>\n<li><strong>id_base (int):</strong>  Base value for generating unique request IDs.</li>\n<li><strong>total_supplied (dict[str, int]):</strong>  Cumulative quantities supplied per product.\nFormat: {product: total_quantity_supplied}</li>\n<li><strong>pending_deliveries (dict[int, Order]):</strong>  Confirmed orders awaiting vehicle pickup.\nFormat: {order_id: Order object}</li>\n<li><strong>vehicle_proposals (dict[int, dict[str, tuple[bool, int]]]):</strong>  Vehicle delivery proposals.\nFormat: {order_id: {vehicle_jid: (can_fit, delivery_time)}}</li>\n<li><strong>vehicles (list[str]):</strong>  List of vehicle JIDs discovered from contacts.</li>\n<li><strong>presence_infos (dict[str, str]):</strong>  Vehicle presence status cache.</li>\n<li><strong>current_tick (int):</strong>  Current simulation time, synchronized by world agent.</li>\n</ul>\n\n<h6 id=\"behaviours\">Behaviours:</h6>\n\n<blockquote>\n  <p>Warehouse Interaction (FIPA Participant):\n      - ReceiveBuyRequest: Processes warehouse purchase requests (FIPA CFP)\n      - AcceptBuyRequest: Sends proposal to warehouse (FIPA propose)\n      - ReceiveConfirmationOrDenial: Handles warehouse award/rejection</p>\n  \n  <p>Vehicle Coordination:\n      - AssignVehicle: Initiates vehicle assignment for deliveries\n      - ReceivePresenceInfo: Checks vehicle availability\n      - ReceiveVehicleProposals: Collects vehicle delivery proposals\n      - ChooseBestVehicle: Selects optimal vehicle using scoring algorithm\n      - ReceiveVehicleArrival: Handles vehicle pickup notifications</p>\n  \n  <p>Time Management:\n      - ReceiveTimeDelta: Synchronizes simulation time and traffic updates</p>\n</blockquote>\n\n<h6 id=\"message-protocols\">Message Protocols:</h6>\n\n<blockquote>\n  <p>Incoming from Warehouses:\n      - warehouse-buy: Purchase request (FIPA CFP)\n      - warehouse-confirm: Order confirmation (FIPA accept-proposal)\n      - warehouse-deny: Order rejection (FIPA reject-proposal)</p>\n  \n  <p>Outgoing to Warehouses:\n      - supplier-accept: Material proposal (FIPA propose)</p>\n  \n  <p>Vehicle Communication:\n      - order-proposal: Request vehicle delivery quote\n      - vehicle-proposal: Vehicle delivery proposal\n      - order-confirmation: Confirm vehicle assignment\n      - vehicle-pickup: Vehicle picks up order from supplier\n      - presence-info: Request vehicle availability\n      - presence-response: Vehicle availability status</p>\n</blockquote>\n\n<h6 id=\"usage-instructions\">Usage Instructions:</h6>\n\n<blockquote>\n  <p><strong>For Vehicle Integration</strong>:\n      - All vehicles must subscribe to all suppliers (mutual presence subscription)\n      - Vehicles access pending orders via <code>supplier_agent.pending_deliveries.values()</code>\n      - Vehicle pickup removes order from pending_deliveries</p>\n  \n  <p><strong>For Warehouse Integration</strong>:\n      - Warehouses send warehouse-buy requests to supplier\n      - Supplier always accepts (infinite stock)\n      - Warehouse selects winning supplier based on delivery time</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">supplier</span> <span class=\"o\">=</span> <span class=\"n\">Supplier</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;supplier1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;password&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">world_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;vehicle1@localhost&quot;</span><span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"k\">await</span> <span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># Access statistics</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">total_supplied</span><span class=\"p\">)</span>  <span class=\"c1\"># {&#39;electronics&#39;: 500, &#39;textiles&#39;: 300}</span>\n\n<span class=\"c1\"># Access pending orders (for vehicles)</span>\n<span class=\"k\">for</span> <span class=\"n\">order</span> <span class=\"ow\">in</span> <span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">pending_deliveries</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">():</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Order </span><span class=\"si\">{</span><span class=\"n\">order</span><span class=\"o\">.</span><span class=\"n\">orderid</span><span class=\"si\">}</span><span class=\"s2\">: </span><span class=\"si\">{</span><span class=\"n\">order</span><span class=\"o\">.</span><span class=\"n\">quantity</span><span class=\"si\">}</span><span class=\"s2\">x</span><span class=\"si\">{</span><span class=\"n\">order</span><span class=\"o\">.</span><span class=\"n\">product</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The infinite stock model simplifies the supply chain by eliminating upstream\n  constraints, allowing focus on warehouse inventory management and vehicle logistics.</p>\n</blockquote>\n", "bases": "spade.agent.Agent"}, {"fullname": "supplier.Supplier.__init__", "modulename": "supplier", "qualname": "Supplier.__init__", "kind": "function", "doc": "<p>Initialize the Supplier agent with connection parameters and world state.</p>\n\n<p>The constructor configures the supplier's identity, location, and initial\nstate. It implements the ID encoding system for generating unique request\nidentifiers compatible with the FIPA Contract Net Protocol.</p>\n\n<h6 id=\"id-encoding-system\">ID Encoding System:</h6>\n\n<blockquote>\n  <p>Formula: <code>agent_type * 100_000_000 + instance_id * 1_000_000 + counter</code></p>\n  \n  <ul>\n  <li>Agent Type Code: 3 (for Supplier agents)</li>\n  <li>Instance ID: Extracted from JID (e.g., \"supplier2\" -> 2)</li>\n  <li>Base ID Calculation: <code>3 * 100_000_000 + instance_id * 1_000_000</code></li>\n  </ul>\n  \n  <p>Examples:\n      - supplier1: base = 301_000_000 (first request: 301_000_000)\n      - supplier2: base = 302_000_000 (first request: 302_000_000)\n      - supplier5: base = 305_000_000 (first request: 305_000_000)</p>\n  \n  <p>This encoding allows agents to identify:\n      1. What type of agent created the request (300M range = supplier)\n      2. Which specific supplier instance (next 1M range)\n      3. Which request in sequence (counter increments)</p>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>jid (str):</strong>  Jabber ID for XMPP communication (e.g., \"supplier1@localhost\").</li>\n<li><strong>password (str):</strong>  Authentication password for XMPP server.</li>\n<li><strong>map (Graph):</strong>  Reference to the world graph for pathfinding and locations.</li>\n<li><strong>node_id (int):</strong>  Graph node representing the supplier's physical location.</li>\n<li><strong>port (int, optional):</strong>  XMPP server port. Defaults to 5222.</li>\n<li><strong>verify_security (bool, optional):</strong>  Enable SSL/TLS verification. Defaults to False.</li>\n<li><strong>contact_list (list[str], optional):</strong>  JIDs of warehouses and vehicles for presence\nsubscription. Defaults to empty list.</li>\n<li><strong>verbose (bool, optional):</strong>  Enable detailed debug logging. Defaults to False.</li>\n</ul>\n\n<h6 id=\"attributes-initialized\">Attributes Initialized:</h6>\n\n<blockquote>\n  <p>Core Identity:\n      - node_id: Supplier location on graph\n      - map: World graph reference\n      - contact_list: Agents for presence subscription\n      - verbose: Debug output flag</p>\n  \n  <p>Position (Legacy):\n      - pos_x: X coordinate from node (TODO: marked for removal)\n      - pos_y: Y coordinate from node (TODO: marked for removal)</p>\n  \n  <p>ID Encoding:\n      - id_base: Base value for generating unique request IDs</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">supplier</span> <span class=\"o\">=</span> <span class=\"n\">Supplier</span><span class=\"p\">(</span>\n    <span class=\"n\">jid</span><span class=\"o\">=</span><span class=\"s2\">&quot;supplier1@localhost&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">password</span><span class=\"o\">=</span><span class=\"s2\">&quot;password123&quot;</span><span class=\"p\">,</span>\n    <span class=\"nb\">map</span><span class=\"o\">=</span><span class=\"n\">world_graph</span><span class=\"p\">,</span>\n    <span class=\"n\">node_id</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span>\n    <span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[</span>\n        <span class=\"s2\">&quot;warehouse1@localhost&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;warehouse2@localhost&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;vehicle1@localhost&quot;</span>\n    <span class=\"p\">],</span>\n    <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n<span class=\"p\">)</span>\n<span class=\"c1\"># ID base calculated: 3 * 100_000_000 + 1 * 1_000_000 = 301_000_000</span>\n<span class=\"c1\"># First request ID will be: 301_000_000</span>\n<span class=\"c1\"># Second request ID will be: 301_000_001</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The constructor only initializes essential attributes. Most supplier\n  state (total_supplied, pending_deliveries, behaviours) is configured\n  in the setup() method which runs after the agent connects to the XMPP server.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"n\">jid</span>,</span><span class=\"param\">\t<span class=\"n\">password</span>,</span><span class=\"param\">\t<span class=\"nb\">map</span><span class=\"p\">:</span> <span class=\"n\">world</span><span class=\"o\">.</span><span class=\"n\">graph</span><span class=\"o\">.</span><span class=\"n\">Graph</span>,</span><span class=\"param\">\t<span class=\"n\">node_id</span><span class=\"p\">:</span> <span class=\"nb\">int</span>,</span><span class=\"param\">\t<span class=\"n\">port</span><span class=\"o\">=</span><span class=\"mi\">5222</span>,</span><span class=\"param\">\t<span class=\"n\">verify_security</span><span class=\"o\">=</span><span class=\"kc\">False</span>,</span><span class=\"param\">\t<span class=\"n\">contact_list</span><span class=\"o\">=</span><span class=\"p\">[]</span>,</span><span class=\"param\">\t<span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"kc\">False</span></span>)</span>"}, {"fullname": "supplier.Supplier.ReceiveBuyRequest", "modulename": "supplier", "qualname": "Supplier.ReceiveBuyRequest", "kind": "class", "doc": "<p>Cyclic behaviour that processes incoming purchase requests from warehouses.</p>\n\n<p>This behaviour implements the proposal phase of the FIPA Contract Net Protocol\nwhere the supplier acts as a <strong>Participant</strong>. It receives CFP messages from\nwarehouses and automatically accepts all requests since the supplier has\ninfinite stock.</p>\n\n<p>FIPA Protocol Phase: <strong>Proposal Phase - Participant Role</strong>\n    - Role: Participant (Supplier responding to Warehouse's CFP)\n    - Receives: warehouse-buy messages (FIPA CFP)\n    - Evaluates: Always accepts (infinite stock model)\n    - Responds: supplier-accept (FIPA propose) for every request</p>\n\n<h6 id=\"infinite-stock-advantage\">Infinite Stock Advantage:</h6>\n\n<blockquote>\n  <p>Unlike warehouses that must check inventory:</p>\n  \n  <ul>\n  <li>No stock validation needed</li>\n  <li>No rejection logic (always accepts)</li>\n  <li>No stock locking mechanism required</li>\n  <li>Simplifies participant role implementation</li>\n  </ul>\n</blockquote>\n\n<p>Message Format (warehouse-buy):\n    Metadata:\n        - performative: \"warehouse-buy\"\n        - request_id: Unique request identifier\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"100 raw_materials\"</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive</strong>: Wait up to 20 seconds for warehouse-buy message</li>\n  <li><strong>Parse</strong>: Extract request_id, quantity, product from message</li>\n  <li><strong>Accept</strong>: Launch AcceptBuyRequest behaviour (always accept)</li>\n  <li><strong>Track</strong>: Update total_supplied statistics</li>\n  <li><strong>Continue</strong>: Return to listening (cyclic behaviour)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"statistics-tracking\">Statistics Tracking:</h6>\n\n<blockquote>\n  <p>Maintains cumulative supply counts per product:</p>\n  \n  <ul>\n  <li>Increment total_supplied[product] by quantity</li>\n  <li>Create entry if product not yet supplied</li>\n  <li>Used for monitoring and reporting only</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"concurrency-handling\">Concurrency Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li>Processes multiple warehouse requests concurrently</li>\n  <li>Each request launches independent AcceptBuyRequest behaviour</li>\n  <li>No race conditions (infinite stock eliminates conflicts)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Request Received: \"100 electronics\" (request_id=201000000)\nFrom: warehouse1@localhost\nDecision: ACCEPT (always)\nActions:\n    - total_supplied[electronics]: 500 -&gt; 600\n    - Launch AcceptBuyRequest\n    - Print: \"Request 201000000: 100 xelectronics from warehouse1 received.\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"timeout-behavior\">Timeout Behavior:</h6>\n\n<blockquote>\n  <p>If no message received in 20 seconds:</p>\n  \n  <ul>\n  <li>Log timeout (if verbose enabled)</li>\n  <li>Continue listening (cyclic behaviour doesn't terminate)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This behaviour never terminates (cyclic), continuously listening for\n  warehouse requests throughout the supplier's lifecycle.</p>\n</blockquote>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "supplier.Supplier.ReceiveBuyRequest.run", "modulename": "supplier", "qualname": "Supplier.ReceiveBuyRequest.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.AcceptBuyRequest", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest", "kind": "class", "doc": "<p>Behaviour that sends proposal acceptance to warehouse (FIPA propose).</p>\n\n<p>This behaviour implements the proposal submission in the FIPA Contract Net\nProtocol where the supplier, acting as a participant, sends its proposal\nto fulfill the warehouse's request. Since the supplier has infinite stock,\nthis is always an acceptance. It then sets up to receive the warehouse's\ndecision (accept-proposal or reject-proposal).</p>\n\n<p>FIPA Protocol Phase: <strong>Proposal Submission - Participant Role</strong>\n    - Role: Participant (Supplier proposing to Warehouse)\n    - Sends: supplier-accept (FIPA propose)\n    - Purpose: \"I can fulfill your request\" (always true for supplier)\n    - Next Phase: Await warehouse's award or rejection decision</p>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique identifier for this request.</li>\n<li><strong>quant (int):</strong>  Quantity of product being proposed.</li>\n<li><strong>product (str):</strong>  Name of product being proposed.</li>\n<li><strong>sender (str):</strong>  Warehouse JID that initiated the request.</li>\n</ul>\n\n<p>Message Format (supplier-accept):\n    Metadata:\n        - performative: \"supplier-accept\" (FIPA propose)\n        - supplier_id: This supplier's JID\n        - warehouse_id: Requesting warehouse's JID\n        - node_id: Supplier's graph location\n        - request_id: Original request identifier\n    Body:\n        - Format: \"{quantity} {product}\"\n        - Example: \"100 electronics\"</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Log Acceptance</strong> (verbose): Print proposal details</li>\n  <li><strong>Construct Message</strong>: Create supplier-accept with all metadata</li>\n  <li><strong>Send Proposal</strong>: Transmit to requesting warehouse</li>\n  <li><strong>Create Listener</strong>: Initialize ReceiveConfirmationOrDenial behaviour</li>\n  <li><strong>Setup Template</strong>: Configure filter for this specific negotiation</li>\n  <li><strong>Register Listener</strong>: Add behaviour with template to agent</li>\n  <li><strong>Return</strong>: Don't block (listener runs independently)</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"template-configuration\">Template Configuration:</h6>\n\n<blockquote>\n  <p>Filters messages to match:</p>\n  \n  <ul>\n  <li>supplier_id: This supplier</li>\n  <li>warehouse_id: Specific warehouse that made request</li>\n  <li>request_id: This specific request</li>\n  </ul>\n  \n  <p>Accepts both performatives:</p>\n  \n  <ul>\n  <li>warehouse-confirm (FIPA accept-proposal)</li>\n  <li>warehouse-deny (FIPA reject-proposal)</li>\n  </ul>\n</blockquote>\n\n<p>Non-Blocking Design:\n    The commented-out <code>await confirm_deny_behav.join()</code> demonstrates\n    that we intentionally DON'T wait for confirmation here. This allows\n    the supplier to accept multiple warehouse requests concurrently.</p>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input: Warehouse request for \"100 electronics\"\nProposal Sent: supplier-accept with body \"100 electronics\"\nListener Setup: ReceiveConfirmationOrDenial waiting for:\n    - warehouse-confirm (award) OR\n    - warehouse-deny (rejection)\nResult: Supplier ready to process next request\n</code></pre>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Sends SPADE message to warehouse</li>\n  <li>Adds ReceiveConfirmationOrDenial behaviour to agent</li>\n  <li>Prints debug information if verbose enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Unlike warehouse AcceptBuyRequest, this never needs to lock stock\n  since the supplier has infinite inventory.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "supplier.Supplier.AcceptBuyRequest.__init__", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest.__init__", "kind": "function", "doc": "<p>Initialize the AcceptBuyRequest behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  The warehouse-buy request message to accept.</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span>)</span>"}, {"fullname": "supplier.Supplier.AcceptBuyRequest.request_id", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.AcceptBuyRequest.quant", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest.quant", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.AcceptBuyRequest.product", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest.product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.AcceptBuyRequest.sender", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest.sender", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.AcceptBuyRequest.run", "modulename": "supplier", "qualname": "Supplier.AcceptBuyRequest.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial", "kind": "class", "doc": "<p>Behaviour that processes warehouse's award or rejection decision (FIPA result notification).</p>\n\n<p>This behaviour implements the result notification reception in the FIPA Contract Net\nProtocol where the supplier, acting as a participant, receives the warehouse's final\ndecision about whether its proposal was accepted or rejected.</p>\n\n<p>FIPA Protocol Phase: <strong>Result Notification Reception - Participant Role</strong>\n    - Role: Participant (Supplier receiving Warehouse's decision)\n    - Receives: warehouse-confirm (FIPA accept-proposal) or warehouse-deny (FIPA reject-proposal)\n    - Actions:\n        - If confirm: Add order to pending_deliveries, assign vehicle\n        - If deny: Log rejection (no rollback needed - infinite stock)\n        - If timeout: Log timeout (warehouse chose another supplier)</p>\n\n<h6 id=\"order-state-transitions\">Order State Transitions:</h6>\n\n<blockquote>\n  <p><strong>On warehouse-confirm (Award)</strong>:\n      1. Convert message to Order object\n      2. pending_deliveries[order_id] = order\n      3. Launch AssignVehicle behaviour\n      4. Print confirmation message</p>\n  \n  <p><strong>On warehouse-deny or timeout (Rejection/Timeout)</strong>:\n      1. Log rejection/timeout (if verbose)\n      2. No state changes needed (infinite stock)\n      3. No further action required</p>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>accepted_id (int):</strong>  Request ID for which we sent proposal.</li>\n<li><strong>accepted_quantity (int):</strong>  Quantity that was proposed.</li>\n<li><strong>accepted_product (str):</strong>  Product that was proposed.</li>\n<li><strong>sender_jid (str):</strong>  Warehouse JID that will send decision.</li>\n</ul>\n\n<h6 id=\"timeout-mechanism\">Timeout Mechanism:</h6>\n\n<blockquote>\n  <ul>\n  <li>Wait time: 10 seconds</li>\n  <li>Interpretation: Warehouse chose another supplier (implicit rejection)</li>\n  <li>Action: Log only (no stock to unlock)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n  <p><strong>Scenario 1: Warehouse Confirms</strong></p>\n\n<pre><code>Proposed: 100 electronics\nMessage Received: warehouse-confirm \"100 electronics\"\nActions:\n    - Create Order object\n    - pending_deliveries[301000000] = Order(...)\n    - Launch AssignVehicle(301000000)\n    - Print: \"Order 301000000 confirmed: 100 xelectronics for warehouse1\"\n</code></pre>\n  \n  <p><strong>Scenario 2: Warehouse Denies</strong></p>\n\n<pre><code>Proposed: 100 electronics\nMessage Received: warehouse-deny \"100 electronics\"\nActions:\n    - Print: \"Denial received! Warehouse chose another supplier.\"\n    - No state changes (infinite stock)\n</code></pre>\n  \n  <p><strong>Scenario 3: Timeout</strong></p>\n\n<pre><code>Proposed: 100 electronics\nMessage Received: None (10 second timeout)\nActions:\n    - Print: \"Timeout: No confirmation or denial received\"\n    - Print: \"Order not confirmed for electronics x100\"\n    - No state changes (infinite stock)\n</code></pre>\n</blockquote>\n\n<h6 id=\"difference-from-warehouse-behaviour\">Difference from Warehouse Behaviour:</h6>\n\n<blockquote>\n  <p>Unlike warehouse ReceiveConfirmationOrDenial:</p>\n  \n  <ul>\n  <li>No stock unlocking needed (infinite inventory)</li>\n  <li>No capacity adjustments required</li>\n  <li>Simpler state management</li>\n  <li>Only tracks confirmed orders in pending_deliveries</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This behaviour is automatically filtered by template to only receive\n  messages for the specific supplier, warehouse, and request_id combination.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial.__init__", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial.__init__", "kind": "function", "doc": "<p>Initialize the ReceiveConfirmationOrDenial behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>accept_msg (Message):</strong>  The supplier-accept message we sent.\nUsed to extract proposal details for logging if needed.</li>\n<li><strong>sender_jid (str):</strong>  JID of the warehouse that will send the decision.</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">accept_msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>, </span><span class=\"param\"><span class=\"n\">sender_jid</span></span>)</span>"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial.accepted_id", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial.accepted_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial.accepted_quantity", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial.accepted_quantity", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial.accepted_product", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial.accepted_product", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial.sender_jid", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial.sender_jid", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.ReceiveConfirmationOrDenial.run", "modulename": "supplier", "qualname": "Supplier.ReceiveConfirmationOrDenial.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.ReceiveVehicleArrival", "modulename": "supplier", "qualname": "Supplier.ReceiveVehicleArrival", "kind": "class", "doc": "<p>Cyclic behaviour that processes vehicle pickup notifications.</p>\n\n<p>Handles vehicle-pickup messages when vehicles arrive to collect confirmed\norders from the supplier, removes order from pending_deliveries, and sends\npickup confirmation back to vehicle.</p>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "supplier.Supplier.ReceiveVehicleArrival.add_metadata", "modulename": "supplier", "qualname": "Supplier.ReceiveVehicleArrival.add_metadata", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code multiline\">(<span class=\"param\">\t<span class=\"bp\">self</span>,</span><span class=\"param\">\t<span class=\"n\">r_msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>,</span><span class=\"param\">\t<span class=\"n\">order</span><span class=\"p\">:</span> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span></span><span class=\"return-annotation\">) -> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.ReceiveVehicleArrival.run", "modulename": "supplier", "qualname": "Supplier.ReceiveVehicleArrival.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.AssignVehicle", "modulename": "supplier", "qualname": "Supplier.AssignVehicle", "kind": "class", "doc": "<p>Behaviour that coordinates vehicle assignment for delivery to warehouse.</p>\n\n<p>This behaviour implements a vehicle coordination protocol where the supplier\nrequests delivery quotes from available vehicles to transport materials to\na warehouse. This is similar to a mini FIPA Contract Net but simplified.</p>\n\n<h6 id=\"vehicle-selection-process\">Vehicle Selection Process:</h6>\n\n<blockquote>\n  <p><strong>Phase 1: Vehicle Discovery</strong>\n      - Populate vehicles list from presence contacts\n      - Only vehicles subscribed to supplier are eligible</p>\n  \n  <p><strong>Phase 2: Presence Check</strong>\n      - Send presence-info request to each vehicle\n      - Receive presence-response with availability status\n      - Categorize: CHAT (available) vs AWAY (busy)</p>\n  \n  <p><strong>Phase 3: Proposal Requests</strong>\n      - Send order-proposal to available vehicles first\n      - If no available vehicles, send to AWAY vehicles\n      - Broadcast pickup/delivery details</p>\n  \n  <p><strong>Phase 4: Collect Proposals</strong>\n      - Launch ReceiveVehicleProposals to gather responses\n      - Wait for vehicle-proposal messages with can_fit and delivery_time</p>\n  \n  <p><strong>Phase 5: Vehicle Selection</strong>\n      - Launch ChooseBestVehicle to evaluate proposals\n      - Selection criteria: can_fit capacity, then delivery_time\n      - Send order-confirmation to winner</p>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique identifier for the order requiring delivery.</li>\n</ul>\n\n<h6 id=\"order-information-required\">Order Information Required:</h6>\n\n<blockquote>\n  <ul>\n  <li>pickup_node: Supplier's current graph node</li>\n  <li>delivery_node: Warehouse's graph node location</li>\n  <li>product: Product type to deliver</li>\n  <li>quantity: Amount to deliver</li>\n  <li>sender: Warehouse JID expecting delivery</li>\n  </ul>\n</blockquote>\n\n<p>Message Format (order-proposal):\n    Metadata:\n        - performative: \"order-proposal\"\n    Body (JSON):\n        - orderid: Order identifier\n        - product: Product type\n        - quantity: Amount to deliver\n        - sender: Warehouse JID (delivery destination)\n        - receiver: Supplier JID (pickup location)\n        - sender_location: Warehouse node\n        - receiver_location: Supplier node</p>\n\n<h6 id=\"presence-status-handling\">Presence Status Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>PresenceShow.CHAT</strong>: Vehicle available, prioritize for proposals</li>\n  <li><strong>PresenceShow.AWAY</strong>: Vehicle busy, use only if no available vehicles</li>\n  <li>Strategy: Try available first, fallback to busy if necessary</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n  <p><strong>Scenario: Normal Vehicle Assignment</strong></p>\n\n<pre><code>Order ID: 301000000\nPickup: Node 20 (Supplier location)\nDelivery: Node 10 (Warehouse location)\nProduct: electronics\nQuantity: 100\n\nStep 1: Discover vehicles\n    Found: [vehicle-1, vehicle-2, vehicle-3]\n\nStep 2: Check presence\n    vehicle-1: CHAT (available)\n    vehicle-2: AWAY (busy)\n    vehicle-3: CHAT (available)\n\nStep 3: Send proposals\n    Sent to: vehicle-1, vehicle-3 (2 available)\n\nStep 4: Collect proposals\n    vehicle-1: can_fit=True, time=120s\n    vehicle-3: can_fit=True, time=85s\n\nStep 5: Choose best\n    Winner: vehicle-3 (lower delivery time)\n    Send order-confirmation to vehicle-3\n</code></pre>\n  \n  <p><strong>Scenario: No Available Vehicles</strong></p>\n\n<pre><code>All vehicles: AWAY (busy)\nAction: Send proposals to all AWAY vehicles anyway\nResult: Best vehicle will accept when capacity available\n</code></pre>\n</blockquote>\n\n<h6 id=\"error-handling\">Error Handling:</h6>\n\n<blockquote>\n  <ul>\n  <li>If no vehicles found in contacts:\n  <ul>\n  <li>Print error message</li>\n  <li>Return without sending proposals</li>\n  <li>Order stays in pending_deliveries for retry</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This behaviour launches two child behaviours (ReceiveVehicleProposals\n  and ChooseBestVehicle) that implement the proposal collection and\n  selection logic.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "supplier.Supplier.AssignVehicle.__init__", "modulename": "supplier", "qualname": "Supplier.AssignVehicle.__init__", "kind": "function", "doc": "<p>Initialize the AssignVehicle behaviour.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique identifier for the order requiring vehicle assignment.</li>\n</ul>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">request_id</span></span>)</span>"}, {"fullname": "supplier.Supplier.AssignVehicle.request_id", "modulename": "supplier", "qualname": "Supplier.AssignVehicle.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.AssignVehicle.populate_vehicles_from_contacts", "modulename": "supplier", "qualname": "Supplier.AssignVehicle.populate_vehicles_from_contacts", "kind": "function", "doc": "<p>Populate vehicles list from presence contacts if empty</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.AssignVehicle.create_presence_info_message", "modulename": "supplier", "qualname": "Supplier.AssignVehicle.create_presence_info_message", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">to</span></span><span class=\"return-annotation\">) -> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.AssignVehicle.create_call_for_proposal_message", "modulename": "supplier", "qualname": "Supplier.AssignVehicle.create_call_for_proposal_message", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">to</span></span><span class=\"return-annotation\">) -> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.AssignVehicle.run", "modulename": "supplier", "qualname": "Supplier.AssignVehicle.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.ReceivePresenceInfo", "modulename": "supplier", "qualname": "Supplier.ReceivePresenceInfo", "kind": "class", "doc": "<p>Behaviour to receive presence information from vehicle agents.</p>\n\n<p>This behaviour requests and collects availability status from vehicle agents,\nwhich is used to determine which vehicles are available for delivery tasks\nfrom the supplier to warehouses.</p>\n\n<p>The presence information indicates whether a vehicle is busy, available, or\nin another state. This helps the supplier make intelligent vehicle assignment\ndecisions based on current vehicle availability.</p>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive Message</strong>: Wait up to 10 seconds for presence response</li>\n  <li><strong>Parse JSON</strong>: Extract presence_show status from message body</li>\n  <li><strong>Store Information</strong>: Save presence info indexed by vehicle_id</li>\n  <li><strong>Handle Timeout</strong>: Print warning if no response received</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Updates agent.presence_infos dictionary with vehicle status</li>\n  <li>Prints presence information if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes after receiving one presence message or timing out.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Message Received:\n    Metadata: vehicle_id = \"vehicle2@localhost\"\n    Body: {\"presence_show\": \"available\"}\nProcessing:\n    - presence_infos[\"vehicle2@localhost\"] = \"available\"\nOutput:\n    - Print: \"Received presence info response from vehicle2: available\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The 10-second timeout prevents indefinite blocking if a vehicle agent\n  is offline or unresponsive.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "supplier.Supplier.ReceivePresenceInfo.run", "modulename": "supplier", "qualname": "Supplier.ReceivePresenceInfo.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.ReceiveVehicleProposals", "modulename": "supplier", "qualname": "Supplier.ReceiveVehicleProposals", "kind": "class", "doc": "<p>Cyclic behaviour that collects vehicle delivery proposals for supplier orders.</p>\n\n<p>This behaviour implements the proposal collection phase of vehicle selection\nfor deliveries from supplier to warehouses. After the supplier sends delivery\nrequests to vehicles, this behaviour continuously receives and stores vehicle\nproposals containing delivery capacity and estimated delivery time information.</p>\n\n<p>The behaviour runs in an infinite loop within each execution, collecting all\navailable proposals until a timeout occurs (no more proposals arriving). Each\nproposal is indexed by order_id and vehicle_jid for later evaluation by\nChooseBestVehicle behaviour.</p>\n\n<h6 id=\"proposal-data-structure\">Proposal Data Structure:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"n\">vehicle_proposals</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">order_id</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;vehicle1@localhost&quot;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">can_fit</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"n\">delivery_time</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">),</span>\n        <span class=\"s2\">&quot;vehicle2@localhost&quot;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">can_fit</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"n\">delivery_time</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">),</span>\n        <span class=\"o\">...</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"message-format\">Message Format:</h6>\n\n<blockquote>\n  <p>Body (JSON):</p>\n  \n  <p><div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">3001000000</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;can_fit&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;delivery_time&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">180</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div></p>\n</blockquote>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Receive Message</strong>: Wait up to 5 seconds for vehicle proposal</li>\n  <li><strong>Parse Proposal</strong>: Extract orderid, can_fit, delivery_time</li>\n  <li><strong>Initialize Storage</strong>: Create order_id entry if doesn't exist</li>\n  <li><strong>Store Proposal</strong>: Add vehicle proposal to vehicle_proposals dict</li>\n  <li><strong>Continue Loop</strong>: Repeat until timeout (no more proposals)</li>\n  <li><strong>Exit</strong>: Break loop when timeout indicates all proposals received</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Updates agent.vehicle_proposals dictionary with new proposals</li>\n  <li>Prints proposal details if verbose mode enabled</li>\n  <li>Breaks loop after 5-second timeout</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Exits after collecting all available proposals.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Loop Iteration 1:\n    - Receive from vehicle1: can_fit=True, time=150\n    - Store: vehicle_proposals[3001000000][\"vehicle1\"] = (True, 150)\nLoop Iteration 2:\n    - Receive from vehicle2: can_fit=True, time=130\n    - Store: vehicle_proposals[3001000000][\"vehicle2\"] = (True, 130)\nLoop Iteration 3:\n    - Timeout after 5 seconds\n    - Break loop, all proposals collected\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>The 5-second timeout is optimized to collect multiple proposals quickly\n  while not waiting too long for vehicles that won't respond.</p>\n</blockquote>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "supplier.Supplier.ReceiveVehicleProposals.run", "modulename": "supplier", "qualname": "Supplier.ReceiveVehicleProposals.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.ChooseBestVehicle", "modulename": "supplier", "qualname": "Supplier.ChooseBestVehicle", "kind": "class", "doc": "<p>Behaviour that evaluates vehicle proposals and selects optimal vehicle for supplier delivery.</p>\n\n<p>This behaviour implements the proposal evaluation and winner selection phase of\nvehicle assignment for supplier-to-warehouse deliveries. After collecting all\nvehicle proposals via ReceiveVehicleProposals, this behaviour compares them based\non capacity and delivery time, then notifies the selected vehicle and rejects all others.</p>\n\n<h6 id=\"selection-algorithm\">Selection Algorithm:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Priority 1</strong>: Filter vehicles that can fit the order (can_fit=True)</li>\n  <li><strong>Priority 2</strong>: Among fitting vehicles, select one with minimum delivery_time</li>\n  <li><strong>Fallback</strong>: If no vehicles can fit, select vehicle with minimum delivery_time anyway</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"attributes\">Attributes:</h6>\n\n<ul>\n<li><strong>request_id (int):</strong>  Unique order identifier to find proposals.</li>\n</ul>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li><strong>Retrieve Proposals</strong>: Get all proposals for this request_id</li>\n  <li><strong>Evaluate Proposals</strong>: Call get_best_vehicle() to select winner</li>\n  <li><strong>Send Confirmation</strong>: Notify selected vehicle with order-confirmation</li>\n  <li><strong>Send Rejections</strong>: Notify all other vehicles they were not selected</li>\n  </ol>\n</blockquote>\n\n<p>Message Format (Confirmation):\n    Metadata:\n        - performative: \"order-confirmation\"\n    Body (JSON):</p>\n\n<pre><code>    <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">3001000000</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;confirmed&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">true</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div>\n</code></pre>\n\n<p>Message Format (Rejection):\n    Metadata:\n        - performative: \"order-confirmation\"\n    Body (JSON):</p>\n\n<pre><code>    <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;orderid&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">3001000000</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;confirmed&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">false</span>\n<span class=\"p\">}</span>\n</code></pre>\n</div>\n</code></pre>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Reads from agent.vehicle_proposals dictionary</li>\n  <li>Reads from agent.pending_deliveries for Order object</li>\n  <li>Sends confirmation message to selected vehicle</li>\n  <li>Sends rejection messages to non-selected vehicles</li>\n  <li>Prints selection decision if verbose mode enabled</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>None. Completes after sending all confirmation/rejection messages.</p>\n</blockquote>\n\n<h6 id=\"example-execution\">Example Execution:</h6>\n\n<blockquote>\n<pre><code>Proposals Received:\n    - vehicle1: (can_fit=True, time=150)\n    - vehicle2: (can_fit=True, time=130)\n    - vehicle3: (can_fit=False, time=120)\n\nEvaluation:\n    - Filter: vehicle1, vehicle2 (can fit)\n    - Compare times: 130 &lt; 150\n    - Winner: vehicle2\n\nActions:\n    - Send confirmation to vehicle2 (confirmed=true)\n    - Send rejection to vehicle1 (confirmed=false)\n    - Send rejection to vehicle3 (confirmed=false)\n\nOutput:\n    - Print: \"Best vehicle selected: vehicle2@localhost\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Unlike warehouse's version, this behaviour doesn't wait for proposals\n  as they are already collected by ReceiveVehicleProposals before this\n  behaviour is invoked.</p>\n</blockquote>\n", "bases": "spade.behaviour.OneShotBehaviour"}, {"fullname": "supplier.Supplier.ChooseBestVehicle.__init__", "modulename": "supplier", "qualname": "Supplier.ChooseBestVehicle.__init__", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">request_id</span></span>)</span>"}, {"fullname": "supplier.Supplier.ChooseBestVehicle.request_id", "modulename": "supplier", "qualname": "Supplier.ChooseBestVehicle.request_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.ChooseBestVehicle.get_best_vehicle", "modulename": "supplier", "qualname": "Supplier.ChooseBestVehicle.get_best_vehicle", "kind": "function", "doc": "<p></p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">proposals</span><span class=\"p\">:</span> <span class=\"nb\">dict</span></span><span class=\"return-annotation\">) -> <span class=\"nb\">str</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.ChooseBestVehicle.run", "modulename": "supplier", "qualname": "Supplier.ChooseBestVehicle.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.ReceiveTimeDelta", "modulename": "supplier", "qualname": "Supplier.ReceiveTimeDelta", "kind": "class", "doc": "<p>Cyclic behaviour that synchronizes simulation time and applies traffic updates.</p>\n\n<p>Receives time delta messages from world agent, updates current_tick, and\napplies dynamic graph edge weight changes for traffic simulation.</p>\n", "bases": "spade.behaviour.CyclicBehaviour"}, {"fullname": "supplier.Supplier.ReceiveTimeDelta.run", "modulename": "supplier", "qualname": "Supplier.ReceiveTimeDelta.run", "kind": "function", "doc": "<p>Body of the behaviour.\nTo be implemented by user.</p>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}, {"fullname": "supplier.Supplier.print_stats", "modulename": "supplier", "qualname": "Supplier.print_stats", "kind": "function", "doc": "<p>Print comprehensive supplier statistics (debugging utility).</p>\n\n<p>Displays two key metrics:</p>\n\n<ol>\n<li><strong>Total Products Supplied</strong>: Cumulative quantities per product type</li>\n<li><strong>Pending Deliveries</strong>: Orders confirmed but not yet picked up by vehicles</li>\n</ol>\n\n<h6 id=\"output-format\">Output Format:</h6>\n\n<blockquote>\n  <p>========================================\n  supplier1@localhost Statistics:\n  Total Products Supplied:\n    electronics: 1500\n    textiles: 800\n    food: 1200</p>\n  \n  <p>Pending Deliveries:\n    Total: 2 order(s)\n      Order 301000000: 100xelectronics for warehouse1@localhost</p>\n  \n  <h1 id=\"order-301000001-50xtextiles-for-warehouse2localhost\">    Order 301000001: 50xtextiles for warehouse2@localhost</h1>\n</blockquote>\n\n<h6 id=\"metrics-interpretation\">Metrics Interpretation:</h6>\n\n<blockquote>\n  <ul>\n  <li><strong>Total Products Supplied</strong>: Historical record of all materials provided</li>\n  <li><strong>Pending Deliveries</strong>: Orders awaiting vehicle pickup\n  <ul>\n  <li>Added when warehouse sends warehouse-confirm</li>\n  <li>Removed when vehicle sends vehicle-pickup</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<h6 id=\"use-cases\">Use Cases:</h6>\n\n<blockquote>\n  <ul>\n  <li>Monitoring supplier throughput</li>\n  <li>Tracking pending logistics operations</li>\n  <li>Debugging vehicle coordination issues</li>\n  <li>Performance analysis and reporting</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example-usage\">Example Usage:</h6>\n\n<blockquote>\n  <div class=\"pdoc-code codehilite\">\n<pre><span></span><code><span class=\"c1\"># After warehouse confirms order</span>\n<span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">pending_deliveries</span><span class=\"p\">[</span><span class=\"n\">order_id</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">order</span>\n<span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">print_stats</span><span class=\"p\">()</span>  <span class=\"c1\"># Shows new pending order</span>\n\n<span class=\"c1\"># After vehicle pickup</span>\n<span class=\"k\">del</span> <span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">pending_deliveries</span><span class=\"p\">[</span><span class=\"n\">order_id</span><span class=\"p\">]</span>\n<span class=\"n\">supplier</span><span class=\"o\">.</span><span class=\"n\">print_stats</span><span class=\"p\">()</span>  <span class=\"c1\"># Shows order removed</span>\n</code></pre>\n  </div>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Unlike warehouse and store, supplier statistics are simpler because\n  there's no stock tracking (infinite inventory model).</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.update_graph", "modulename": "supplier", "qualname": "Supplier.update_graph", "kind": "function", "doc": "<p>Update world graph edge weights based on traffic conditions.</p>\n\n<p>This function applies dynamic traffic updates received from the world agent\nto the supplier's local copy of the world graph. Edge weights represent\ntravel costs/times and are updated to reflect current traffic conditions.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>traffic_data (dict):</strong>  Traffic update data with structure:\n{\n    \"edges\": [\n        {\n            \"node1\": int,  # First node ID\n            \"node2\": int,  # Second node ID\n            \"weight\": float  # New edge weight (time/cost)\n        },\n        ...\n    ]\n}</li>\n</ul>\n\n<h6 id=\"workflow\">Workflow:</h6>\n\n<blockquote>\n  <ol>\n  <li>Iterate through all edge updates in traffic_data</li>\n  <li>Extract node1_id, node2_id, and new_weight</li>\n  <li>Retrieve edge from graph using get_edge()</li>\n  <li>Update edge.weight if edge exists</li>\n  </ol>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Traffic Data:\n{\n    \"edges\": [\n        {\"node1\": 10, \"node2\": 15, \"weight\": 120.5},\n        {\"node1\": 15, \"node2\": 20, \"weight\": 95.3}\n    ]\n}\n\nActions:\n    - Edge (10, 15): weight updated to 120.5\n    - Edge (15, 20): weight updated to 95.3\n\nImpact:\n    - Vehicle routing recalculated with new weights\n    - Delivery time estimates adjusted\n    - Pathfinding uses updated costs\n</code></pre>\n</blockquote>\n\n<h6 id=\"integration\">Integration:</h6>\n\n<blockquote>\n  <ul>\n  <li>Called by: ReceiveTimeDelta behaviour</li>\n  <li>Triggered by: time-delta messages from world agent</li>\n  <li>Frequency: Every simulation tick with traffic updates</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Only updates existing edges. If an edge doesn't exist in the graph,\n  it's silently skipped (safe behavior for malformed data).</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">traffic_data</span></span><span class=\"return-annotation\">) -> <span class=\"kc\">None</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.message_to_order", "modulename": "supplier", "qualname": "Supplier.message_to_order", "kind": "function", "doc": "<p>Convert warehouse-confirm message to Order object for delivery tracking.</p>\n\n<p>This helper function transforms a FIPA accept-proposal message from a warehouse\ninto a structured Order object that can be stored in pending_deliveries\nand assigned to vehicles for transportation.</p>\n\n<h6 id=\"fipa-protocol-context\">FIPA Protocol Context:</h6>\n\n<blockquote>\n  <ul>\n  <li>Triggered by: warehouse-confirm message (FIPA accept-proposal)</li>\n  <li>Used by: ReceiveConfirmationOrDenial behaviour</li>\n  <li>Purpose: Create deliverable order from confirmed proposal</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"message-parsing\">Message Parsing:</h6>\n\n<blockquote>\n  <p>Body Format: \"{quantity} {product}\"\n  Example: \"100 electronics\"</p>\n  \n  <p>Metadata Extracted:\n      - request_id: Unique order identifier\n      - node_id: Warehouse's graph location (delivery destination)</p>\n</blockquote>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>msg (Message):</strong>  warehouse-confirm message with:\n<ul>\n<li>Body: \"{quantity} {product}\"</li>\n<li>Metadata: request_id, node_id</li>\n<li>Sender: Warehouse JID</li>\n</ul></li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Order: Structured order object with:\n      - product: Product type\n      - quantity: Amount to deliver\n      - orderid: Unique identifier\n      - sender: Warehouse JID (delivery destination)\n      - receiver: Supplier JID (pickup location)\n      - sender_location: Warehouse's graph node\n      - receiver_location: Supplier's graph node</p>\n</blockquote>\n\n<h6 id=\"order-object-structure\">Order Object Structure:</h6>\n\n<blockquote>\n  <p>The Order uses inverted semantics for delivery context:</p>\n  \n  <ul>\n  <li>sender = Warehouse (WHERE to deliver)</li>\n  <li>receiver = Supplier (WHERE to pickup)</li>\n  <li>sender_location = Warehouse node (delivery destination)</li>\n  <li>receiver_location = Supplier node (pickup origin)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input Message (warehouse-confirm):\n    Body: \"100 electronics\"\n    Metadata:\n        - request_id: \"301000000\"\n        - node_id: \"10\"\n    Sender: \"warehouse1@localhost\"\n\nSupplier: \"supplier1@localhost\" at node 20\n\nOutput Order:\n    product: \"electronics\"\n    quantity: 100\n    orderid: \"301000000\"\n    sender: \"warehouse1@localhost\"\n    receiver: \"supplier1@localhost\"\n    sender_location: 10 (warehouse node)\n    receiver_location: 20 (supplier node)\n</code></pre>\n</blockquote>\n\n<h6 id=\"integration\">Integration:</h6>\n\n<blockquote>\n  <p>Created Order is added to self.pending_deliveries[order_id]\n  and passed to AssignVehicle behaviour for transportation.</p>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This mirrors the message_to_order function in warehouse.py but\n  processes warehouse-confirm instead of store-confirm messages.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">msg</span><span class=\"p\">:</span> <span class=\"n\">spade</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">Message</span></span><span class=\"return-annotation\">) -> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.dict_to_order", "modulename": "supplier", "qualname": "Supplier.dict_to_order", "kind": "function", "doc": "<p>Convert dictionary data to Order object (for vehicle communication).</p>\n\n<p>This helper function reconstructs an Order object from dictionary data,\ntypically received from vehicle messages (vehicle-pickup). It's the\ninverse operation of serializing an order to JSON.</p>\n\n<h6 id=\"arguments\">Arguments:</h6>\n\n<ul>\n<li><strong>data (dict):</strong>  Dictionary containing order information with keys:\n<ul>\n<li>product (str): Product type</li>\n<li>quantity (int): Amount to deliver</li>\n<li>orderid (int): Unique order identifier</li>\n<li>sender (str): Warehouse JID (delivery destination)</li>\n<li>receiver (str): Supplier JID (pickup location)</li>\n<li>sender_location (int, optional): Warehouse graph node</li>\n<li>receiver_location (int, optional): Supplier graph node</li>\n</ul></li>\n</ul>\n\n<h6 id=\"returns\">Returns:</h6>\n\n<blockquote>\n  <p>Order: Reconstructed Order object with all attributes populated.</p>\n</blockquote>\n\n<h6 id=\"example\">Example:</h6>\n\n<blockquote>\n<pre><code>Input Dictionary:\n{\n    \"product\": \"electronics\",\n    \"quantity\": 100,\n    \"orderid\": 301000000,\n    \"sender\": \"warehouse1@localhost\",\n    \"receiver\": \"supplier1@localhost\",\n    \"sender_location\": 10,\n    \"receiver_location\": 20\n}\n\nOutput Order:\n    order.product = \"electronics\"\n    order.quantity = 100\n    order.orderid = 301000000\n    order.sender = \"warehouse1@localhost\"\n    order.receiver = \"supplier1@localhost\"\n    order.sender_location = 10\n    order.receiver_location = 20\n</code></pre>\n</blockquote>\n\n<h6 id=\"use-cases\">Use Cases:</h6>\n\n<blockquote>\n  <ul>\n  <li>Parsing vehicle-pickup messages</li>\n  <li>Reconstructing orders from JSON body</li>\n  <li>Vehicle coordination communication</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>Uses safe dictionary access (.get()) for location fields to handle\n  cases where location data might not be present.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span>, </span><span class=\"param\"><span class=\"n\">data</span><span class=\"p\">:</span> <span class=\"nb\">dict</span></span><span class=\"return-annotation\">) -> <span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">veiculos</span><span class=\"o\">.</span><span class=\"n\">Order</span>:</span></span>", "funcdef": "def"}, {"fullname": "supplier.Supplier.node_id", "modulename": "supplier", "qualname": "Supplier.node_id", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.map", "modulename": "supplier", "qualname": "Supplier.map", "kind": "variable", "doc": "<p></p>\n", "annotation": ": world.graph.Graph"}, {"fullname": "supplier.Supplier.pos_x", "modulename": "supplier", "qualname": "Supplier.pos_x", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.pos_y", "modulename": "supplier", "qualname": "Supplier.pos_y", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.contact_list", "modulename": "supplier", "qualname": "Supplier.contact_list", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.verbose", "modulename": "supplier", "qualname": "Supplier.verbose", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.id_base", "modulename": "supplier", "qualname": "Supplier.id_base", "kind": "variable", "doc": "<p></p>\n"}, {"fullname": "supplier.Supplier.setup", "modulename": "supplier", "qualname": "Supplier.setup", "kind": "function", "doc": "<p>Configure supplier state and register all FIPA protocol behaviours.</p>\n\n<p>This method is automatically called by SPADE after the agent successfully\nconnects to the XMPP server. It initializes the supplier's operational\nstate and registers all cyclic behaviours needed for the FIPA Contract Net\nProtocol implementation as a participant.</p>\n\n<h6 id=\"setup-process\">Setup Process:</h6>\n\n<blockquote>\n  <p><strong>Phase 1: Presence Management</strong>\n      - Enable auto-approval of presence subscriptions\n      - Subscribe to all contacts (warehouses and vehicles)\n      - Enables presence-based availability checking</p>\n  \n  <p><strong>Phase 2: State Initialization</strong>\n      - total_supplied: Dictionary tracking cumulative supply per product\n      - current_tick: Simulation time (starts at 0)\n      - pending_deliveries: Orders confirmed but not picked up\n      - vehicle_proposals: Vehicle delivery quotes per order\n      - vehicles: List of vehicle JIDs (populated dynamically)\n      - presence_infos: Vehicle availability cache</p>\n  \n  <p><strong>Phase 3: Behaviour Registration</strong>\n      1. ReceiveBuyRequest (Warehouse Interaction - FIPA Participant)\n      2. ReceiveVehicleProposals (Vehicle Coordination - Proposal Collection)\n      3. ReceiveVehicleArrival (Vehicle Coordination - Pickup Handling)</p>\n</blockquote>\n\n<h6 id=\"behaviour-registration-details\">Behaviour Registration Details:</h6>\n\n<blockquote>\n  <p><strong>ReceiveBuyRequest</strong> (CyclicBehaviour):\n      - Template: performative = \"warehouse-buy\"\n      - Purpose: Listen for warehouse purchase requests (FIPA CFP)\n      - Role: FIPA Participant (responds to warehouses)\n      - Action: Always accepts (infinite stock)</p>\n  \n  <p><strong>ReceiveVehicleProposals</strong> (CyclicBehaviour):\n      - Template: performative = \"vehicle-proposal\"\n      - Purpose: Collect vehicle delivery quotes\n      - Role: Coordinator for vehicle selection\n      - Action: Store proposals in vehicle_proposals dictionary</p>\n  \n  <p><strong>ReceiveVehicleArrival</strong> (CyclicBehaviour):\n      - Template: performative = \"vehicle-pickup\"\n      - Purpose: Handle vehicle pickup notifications\n      - Action: Remove order from pending_deliveries, confirm pickup</p>\n</blockquote>\n\n<h6 id=\"infinite-stock-model\">Infinite Stock Model:</h6>\n\n<blockquote>\n  <p>Unlike warehouse agents:</p>\n  \n  <ul>\n  <li>No stock initialization required</li>\n  <li>No capacity constraints</li>\n  <li>No resupply mechanism needed</li>\n  <li>Only tracks what's been supplied (statistics)</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"state-initialization-example\">State Initialization Example:</h6>\n\n<blockquote>\n<pre><code>After setup():\n    total_supplied: {} (empty, will populate as orders fulfilled)\n    current_tick: 0\n    pending_deliveries: {} (empty, will populate as orders confirmed)\n    vehicle_proposals: {} (empty, will populate per order)\n    vehicles: [] (will populate from presence contacts)\n    presence_infos: {} (will populate during vehicle coordination)\n\nPrint Output:\n    \"supplier1@localhost&gt; Supplier initialized with INFINITE stock\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"presence-subscription-example\">Presence Subscription Example:</h6>\n\n<blockquote>\n<pre><code>contact_list: [\n    \"warehouse1@localhost\",\n    \"warehouse2@localhost\",\n    \"vehicle1@localhost\",\n    \"vehicle2@localhost\"\n]\n\nActions:\n    1. Subscribe to all 4 contacts\n    2. Enable auto-approval for incoming subscriptions\n    3. Print: \"Sent subscription request to warehouse1@localhost\"\n    4. Print: \"Sent subscription request to warehouse2@localhost\"\n    5. Print: \"Sent subscription request to vehicle1@localhost\"\n    6. Print: \"Sent subscription request to vehicle2@localhost\"\n    7. Print: \"Supplier setup complete. Will auto-accept all presence subscriptions.\"\n</code></pre>\n</blockquote>\n\n<h6 id=\"template-configuration\">Template Configuration:</h6>\n\n<blockquote>\n  <p>Templates use metadata filtering to route messages to correct behaviours:</p>\n  \n  <ul>\n  <li>ReceiveBuyRequest: performative=\"warehouse-buy\"</li>\n  <li>ReceiveVehicleProposals: performative=\"vehicle-proposal\"</li>\n  <li>ReceiveVehicleArrival: performative=\"vehicle-pickup\"</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"side-effects\">Side Effects:</h6>\n\n<blockquote>\n  <ul>\n  <li>Prints initialization message with INFINITE stock notice</li>\n  <li>Prints statistics if verbose=True</li>\n  <li>Begins listening for warehouse requests immediately</li>\n  <li>Begins listening for vehicle messages immediately</li>\n  </ul>\n</blockquote>\n\n<h6 id=\"note\">Note:</h6>\n\n<blockquote>\n  <p>This method must complete before the supplier can participate in any\n  FIPA protocol interactions. All behaviours are registered but don't\n  execute until the main agent event loop processes them.</p>\n</blockquote>\n", "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"bp\">self</span></span><span class=\"return-annotation\">):</span></span>", "funcdef": "async def"}];

    // mirrored in build-search-index.js (part 1)
    // Also split on html tags. this is a cheap heuristic, but good enough.
    elasticlunr.tokenizer.setSeperator(/[\s\-.;&_'"=,()]+|<[^>]*>/);

    let searchIndex;
    if (docs._isPrebuiltIndex) {
        console.info("using precompiled search index");
        searchIndex = elasticlunr.Index.load(docs);
    } else {
        console.time("building search index");
        // mirrored in build-search-index.js (part 2)
        searchIndex = elasticlunr(function () {
            this.pipeline.remove(elasticlunr.stemmer);
            this.pipeline.remove(elasticlunr.stopWordFilter);
            this.addField("qualname");
            this.addField("fullname");
            this.addField("annotation");
            this.addField("default_value");
            this.addField("signature");
            this.addField("bases");
            this.addField("doc");
            this.setRef("fullname");
        });
        for (let doc of docs) {
            searchIndex.addDoc(doc);
        }
        console.timeEnd("building search index");
    }

    return (term) => searchIndex.search(term, {
        fields: {
            qualname: {boost: 4},
            fullname: {boost: 2},
            annotation: {boost: 2},
            default_value: {boost: 2},
            signature: {boost: 2},
            bases: {boost: 2},
            doc: {boost: 1},
        },
        expand: true
    });
})();